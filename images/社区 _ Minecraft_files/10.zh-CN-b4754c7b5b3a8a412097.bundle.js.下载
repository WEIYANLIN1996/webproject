(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.User="User",e.Device="Device"}(t.ClientType||(t.ClientType={})),function(e){e.Desktop="Desktop",e.Laptop="Laptop",e.Xbox="Xbox",e.Phone="Phone",e.Tablet="Tablet"}(t.DeviceType||(t.DeviceType={})),function(e){e.Windows="Windows",e.Android="Android",e.iOS="iOS"}(t.Platform||(t.Platform={})),function(e){e.Current="Current",e.Session="Session"}(t.CacheType||(t.CacheType={})),function(e){e[e.Normal=1]="Normal",e[e.CostDeferred=2]="CostDeferred",e[e.Realtime=3]="Realtime"}(t.EventLatency||(t.EventLatency={}))},2211:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}c((i=i.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(2212)),c=a(n(2213)),u=a(n(2214)),l=n(1944),p=a(n(2218)),f=function(){function e(e){if(this.filters={},!e)throw new TypeError("Invalid argument experimentationFilters.");this.httpHelper=new u.default(e),this.cacheHelper=new c.default,this.filters.platform=l.Platform[e.platform],this.filters.appId=e.appId,this.filters.appVersion=e.appVersion,this.filters.region=e.region,this.filters.language=e.language,this.filters.locale=e.locale,this.filters.osVersion=e.osVersion,this.filters.flightingRing=e.flightingRing,this.filters.deviceType=e.deviceType;var t={platform:e.platform,osVersion:e.osVersion,appId:e.appId,appVersion:e.appVersion,libraryType:"JavaScript",libraryVersion:s.version};this.telemetryHelper=new p.default(t)}return e.prototype.updateRegionFilter=function(e){this._updateDefaultFilter("region",e)},e.prototype.updateLanguageFilter=function(e){this._updateDefaultFilter("language",e)},e.prototype.updateLocaleFilter=function(e){this._updateDefaultFilter("locale",e)},e.prototype.setOverrides=function(t,n,i){if(!t)throw new TypeError("Invalid argument clientId.");var r={flights:n,treatmentVariables:i,timeFetched:Date.now()-e.cacheExpiration};this.cacheHelper.set(t,r,l.CacheType.Session),this.cacheHelper.set(t,r,l.CacheType.Current)},e.prototype.updateCacheAsync=function(t,n,o){return i(this,void 0,void 0,function(){var i,a,s,c=this;return r(this,function(r){if(!t)throw new TypeError("Invalid argument clientId.");return i=!0,this.cacheHelper.containsKey(t,l.CacheType.Current)&&(a=Date.now(),s=this.cacheHelper.get(t,l.CacheType.Current).timeFetched,i=a>s+e.cacheExpiration),i?[2,this.httpHelper.getExperimentationDataFromTAS(t,n,o).then(function(e){var i=[],r={};if(e.features&&(i=e.features),e.configs)for(var a=e.configs,s=function(e,t){var n=a[e];if(n.Parameters){var i=n.Parameters;Object.keys(i).forEach(function(e){r[e]=i[e]})}},u=0,p=a.length;u<p;u++)s(u);var f={flights:i,treatmentVariables:r,timeFetched:Date.now()};c.cacheHelper.containsKey(t,l.CacheType.Session)||c.cacheHelper.set(t,f,l.CacheType.Session),c.cacheHelper.set(t,f,l.CacheType.Current);var h=c.filters;o&&Object.keys(o).forEach(function(e){h[e]=o[e]}),c.telemetryHelper.logExperimentationSnapshot(t,n,h,e)}).catch(function(t){throw c.telemetryHelper.logError(t,e.name),t})]:[2]})})},e.prototype.getFlights=function(e,t){return void 0===t&&(t=l.CacheType.Session),this._getAssignmentData(e,t).flights},e.prototype.getVariables=function(e,t){return void 0===t&&(t=l.CacheType.Session),this._getAssignmentData(e,t).treatmentVariables},e.prototype.getBoolean=function(e,t,n){void 0===n&&(n=l.CacheType.Session);var i=this._getTreatmentVariableValue(e,t,n);return"boolean"==typeof i?i:null},e.prototype.getNumber=function(e,t,n){void 0===n&&(n=l.CacheType.Session);var i=this._getTreatmentVariableValue(e,t,n);return"number"==typeof i&&isFinite(i)?i:null},e.prototype.getString=function(e,t,n){void 0===n&&(n=l.CacheType.Session);var i=this._getTreatmentVariableValue(e,t,n);return"string"==typeof i?i:null},e.prototype._getTreatmentVariableValue=function(e,t,n){var i=this._getAssignmentData(e,n);return i?i.treatmentVariables[t]:null},e.prototype._getAssignmentData=function(e,t){if(!e)throw new TypeError("Invalid argument clientId.");return this.cacheHelper.containsKey(e,t)?this.cacheHelper.get(e,t):null},e.prototype._updateDefaultFilter=function(e,t){this.httpHelper.updateDefaultFilter(e,t),this.filters[e]=t,this.cacheHelper.clear()},e.cacheExpiration=144e5,e}();t.default=f},2212:function(e){e.exports={name:"@gaming/experimentation-js",version:"1.0.5",description:"JS library to get flight assignments from TAS and log experimentation data",module:"dist/index.js",browser:"dist/index.js",typings:"dist/declarations/index",scripts:{build:"tsc",test:'echo "Error: no test specified" && exit 1'},author:"Microsoft",license:"ISC",dependencies:{"@ms/1ds-analytics-js":"^2.0.0-rc2","@ms/1ds-core-js":"^2.0.0-rc2",axios:"^0.18.0","axios-retry":"^3.1.1"},devDependencies:{typescript:"^2.8.3"},_resolved:"https://microsoft.pkgs.visualstudio.com/_packaging/Experimentation/npm/registry/@gaming/experimentation-js/-/experimentation-js-1.0.5.tgz",_integrity:"sha1-CcH0fPwXwOgIzMvCeQN8Oo5+q14=",_from:"@gaming/experimentation-js@1.0.5"}},2213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1944),r=function(){function e(){this.sessionExperimentationCache={},this.currentExperimentationCache={}}return e.prototype.set=function(e,t,n){(n===i.CacheType.Session?this.sessionExperimentationCache:this.currentExperimentationCache)[e]=t},e.prototype.get=function(e,t){return(t===i.CacheType.Session?this.sessionExperimentationCache:this.currentExperimentationCache)[e]},e.prototype.containsKey=function(e,t){return void 0!==(t===i.CacheType.Session?this.sessionExperimentationCache:this.currentExperimentationCache)[e]},e.prototype.clear=function(){this.sessionExperimentationCache={},this.currentExperimentationCache={}},e}();t.default=r},2214:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(844)),o=i(n(2215)),a=function(){function e(t){this.axiosInstance=r.default.create(),t.platform&&(this.axiosInstance.defaults.headers.common["X-XBOX-PLATFORM"]=t.platform),t.flightingRing&&(this.axiosInstance.defaults.headers.common["X-XBOX-RING"]=t.flightingRing),t.deviceType&&(this.axiosInstance.defaults.headers.common["X-XBOX-DEVICETYPE"]=t.deviceType),t.region&&(this.axiosInstance.defaults.headers.common["X-XBOX-REGION"]=t.region),t.language&&(this.axiosInstance.defaults.headers.common["X-XBOX-LANGUAGE"]=t.language),t.locale&&(this.axiosInstance.defaults.headers.common["X-XBOX-LOCALE"]=t.locale),t.osVersion&&(this.axiosInstance.defaults.headers.common["X-XBOX-SHELLVERSION"]=t.osVersion),t.appId&&(this.axiosInstance.defaults.headers.common["X-XBOX-APPID"]=t.appId),t.appVersion&&(this.axiosInstance.defaults.headers.common["X-XBOX-APPVERSION"]=t.appVersion),this.axiosInstance.defaults.headers.get["Content-Type"]="application/json; charset=utf-8",this.axiosInstance.defaults.headers.get.Accept="application/json",o.default(this.axiosInstance,{retries:e.MAX_RETRIES,retryDelay:function(e){return 1e3*e}})}return e.prototype.updateDefaultFilter=function(e,t){switch(e){case"region":this.axiosInstance.defaults.headers.common["X-XBOX-REGION"]=t;break;case"language":this.axiosInstance.defaults.headers.common["X-XBOX-LANGUAGE"]=t;break;case"locale":this.axiosInstance.defaults.headers.common["X-XBOX-LOCALE"]=t}},e.prototype.getExperimentationDataFromTAS=function(t,n,i){var r={"X-MSEDGE-CLIENTID":t,"X-XBOX-CLIENTTYPE":n};return i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),this.axiosInstance.get(e.xboxExperimentationEndPoint,{headers:r}).then(function(e){var t=[],n={},i=0,r="";return e.data&&(t=e.data.Features,n=e.data.Configs,i=e.data.FlightingVersion,r=e.data.ImpressionId),{features:t,configs:n,flightingVersion:i,impressionId:r}}).catch(function(e){throw{code:e.code,message:e.message,details:e.request.responseText,response:void 0!==e.response?{headers:e.response.headers,status:e.response.status,statusText:e.response.statusText}:void 0}})},e.xboxExperimentationEndPoint="https://www.xboxab.com/ab?gameid=AC70E74F8D1044C5894D0DC261838A8D",e.MAX_RETRIES=3,e}();t.default=a},2215:function(e,t,n){e.exports=n(2216).default},2216:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNetworkError=s,t.isRetryableError=l,t.isSafeRequestError=p,t.isIdempotentRequestError=f,t.isNetworkOrIdempotentRequestError=h,t.exponentialDelay=E,t.default=m;var i,r=n(2217),o=(i=r)&&i.__esModule?i:{default:i};var a="axios-retry";function s(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,o.default)(e)}var c=["get","head","options"],u=c.concat(["put","delete"]);function l(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function p(e){return!!e.config&&(l(e)&&-1!==c.indexOf(e.config.method))}function f(e){return!!e.config&&(l(e)&&-1!==u.indexOf(e.config.method))}function h(e){return s(e)||f(e)}function d(){return 0}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=100*Math.pow(2,e);return t+.2*t*Math.random()}function g(e){var t=e[a]||{};return t.retryCount=t.retryCount||0,e[a]=t,t}function m(e,t){e.interceptors.request.use(function(e){return g(e).lastRequestTime=Date.now(),e}),e.interceptors.response.use(null,function(n){var i=n.config;if(!i)return Promise.reject(n);var r=function(e,t){return Object.assign({},t,e[a])}(i,t),o=r.retries,s=void 0===o?3:o,c=r.retryCondition,u=void 0===c?h:c,l=r.retryDelay,p=void 0===l?d:l,f=r.shouldResetTimeout,E=void 0!==f&&f,m=g(i);if(u(n)&&m.retryCount<s){m.retryCount+=1;var _=p(m.retryCount,n);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,i),!E&&i.timeout&&m.lastRequestTime){var y=Date.now()-m.lastRequestTime;i.timeout=Math.max(i.timeout-y-_,1)}return i.transformRequest=[function(e){return e}],new Promise(function(t){return setTimeout(function(){return t(e(i))},_)})}return Promise.reject(n)})}m.isNetworkError=s,m.isSafeRequestError=p,m.isIdempotentRequestError=f,m.isNetworkOrIdempotentRequestError=h,m.exponentialDelay=E,m.isRetryableError=l},2217:function(e,t,n){"use strict";var i=["ETIMEDOUT","ECONNRESET","EADDRINUSE","ESOCKETTIMEDOUT","ECONNREFUSED","EPIPE"],r=["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED"];e.exports=function(e){return!e||!e.code||(-1!==i.indexOf(e.code)||-1===r.indexOf(e.code))}},2218:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(194),o=n(1944),a=function(){function e(t){this.lastLoggedFlightingVersion={},this.applicationContextString=JSON.stringify(t),this.applicationInsights=new r.ApplicationInsights,this.applicationInsights.initialize({instrumentationKey:e.apiKey,endpointUrl:e.oneSdkCollectorUri})}return e.prototype.logExperimentationSnapshot=function(t,n,r,a){if(this.lastLoggedFlightingVersion[t]!==a.flightingVersion){var s=a.features||[],c=a.configs||[],u=a.flightingVersion||"",l=a.impressionId||"",p={name:e.providerName+".ExperimentationSnapshot",latency:o.EventLatency.Normal};r.clientType=n,p.data=i({},p.data,{clientId:t,activeFlights:s.toString(),treatmentVariables:JSON.stringify(c),flightingVersion:u,impressionId:l,filtersData:JSON.stringify(r)}),this.applicationInsights.track(p),this.lastLoggedFlightingVersion[t]=a.flightingVersion}},e.prototype.logError=function(t,n){var r={name:e.providerName+".Error",latency:o.EventLatency.Normal};r.data=i({},r.data,{className:n,errorCode:t.code||"",errorMessage:t.message||"",errorDetails:t.details||"",applicationContext:this.applicationContextString}),this.applicationInsights.track(r)},e.apiKey="c2d43e9eb3fb4f3b8f0ece1d1561cc84-edffdb35-ddd3-4a4e-91c0-5b55af47672f-7340",e.providerName="Microsoft.Gaming.Experimentation",e.oneSdkCollectorUri="https://browser.events.data.microsoft.com/OneCollector/1.0/",e}();t.default=a},2242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2211);t.default=i.default;var r=n(1944);t.CacheType=r.CacheType,t.ClientType=r.ClientType,t.DeviceType=r.DeviceType,t.Platform=r.Platform}}]);
//# sourceMappingURL=10.zh-CN-b4754c7b5b3a8a412097.bundle.js.map