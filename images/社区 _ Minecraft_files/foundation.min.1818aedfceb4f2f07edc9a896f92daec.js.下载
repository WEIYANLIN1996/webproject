(function(f,d){if(navigator.userAgent.match(/.*?(Trident|Edge)/))d(f).on("click","button[type\x3dsubmit]",function(a){var e=this.getAttribute("form");e&&(a.preventDefault(),a=f.getElementById(e))&&(e=f.createEvent("Event"),e.initEvent("submit",!0,!0),a.dispatchEvent(e))});d(f).on("click","button[type\x3dreset]",function(a){var e=this.getAttribute("form");e&&(a.preventDefault(),(a=f.getElementById(e))&&a.reset())});Array.prototype.find||(Array.prototype.find=function(a,e){var c;Array.prototype.some.call(this,
function(b){return a.apply(e,arguments)?(c=b,!0):!1});return c});String.prototype.startsWith||(String.prototype.startsWith=function(a,e){return this.substr(e||0,a.length)===a});String.prototype.endsWith||(String.prototype.endsWith=function(a,e){e=e<this.length?e|0:this.length;return this.substr(e-a.length,a.length)===a});f.contains||(d=function(a){if(1>arguments.length)throw new TypeError("1 argument is required");do{if(this===a)return!0;a&&(a=a.parentNode)}while(a);return!1},f.contains=d,Element.prototype.contains=
d)})(document,Granite.$);Granite=window.Granite||{};Granite.UI=Granite.UI||{};Granite.UI.Foundation=Granite.UI.Foundation||{};(function(f,d,a){a.options.transformHash=!1})(document,Granite.$,History);
(function(f,d,a,e){a.UI.Foundation.Utils=a.UI.Foundation.Utils||function(){var a=[],b=function(b,a,g,c){c=c||e(a);var h=[];b.find(a).each(function(){var b=this;c.is(function(){return g(this,b)})?e(b).remove():h.push(e(b).detach()[0])});return e(h)},h=function(b,a){if(0===b.length)return Array.prototype.push.apply(b,a),b;e.each(a,function(){var a=this;b.some(function(b){return b.src===a.src})||b.push(a)});return b},g=function(b,a){var g=[];e.each(b,function(){var b=d.createElement("script"),c=e.Deferred();
g.push(c);e(b).one("load error",function(){c.resolve()});b.async=!1;b.src=this.src;a.appendChild(b)});return e.when.apply(null,g)};return{everyReverse:function(b,a,g){for(var c=b.length-1;0<=c;c--)if(!a.call(g,b[c],c,b))return!1;return!0},debounce:function(b,a,g){var c;return function(){var h=this,e=arguments,d=g&&!c;clearTimeout(c);c=setTimeout(function(){c=null;g||b.apply(h,e)},a);d&&b.apply(h,e)}},processHtml:function(c,f,m,p){if(c.jquery)var n=c;else n=d.createElement("div"),n.innerHTML=c,n=e(n);
var k=b(n,"script[src]",function(b,a){return b.src===a.src},e(h(a,e("script[src]")))),l=b(n,"link[rel\x3dstylesheet]",function(b,a){return b.href===a.href}),u=e("head");p||(u.append(e("link[rel\x3dstylesheet]",d.body)),e("script[src]",d.body).remove());var y=g(k,u[0]);u.append(l);m&&setTimeout(function(){y.done(m)},0);p=n.find(f);return c.jquery?f?p.length?p:n:n:f?p.length?p[0].outerHTML:n[0].innerHTML:n[0].innerHTML}}}()})(window,document,Granite,Granite.$);
(function(f,d){Granite.UI.Foundation.Registry=Granite.UI.Foundation.Registry||function(){var a=new Map;return{register:function(e,c){a.has(e)?a.get(e).push(c):a.set(e,[c])},get:function(e){return a.has(e)?a.get(e):[]}}}();Granite.UI.Foundation.Registry.register("foundation.adapters",{type:"foundation-registry",selector:d(f),adapter:function(){return Granite.UI.Foundation.Registry}})})(window,Granite.$);
(function(f,d){f.UI.Foundation.Adapters=f.UI.Foundation.Adapters||function(){var a=f.UI.Foundation.Registry,e=function(){return a.get("foundation.adapters")};return{register:function(c,b,h){a.register("foundation.adapters",{type:c,selector:b,adapter:h})},has:function(a){return e().some(function(b){return b.type===a})},get:function(a){var b=[];e().forEach(function(c){c.type===a&&b.push(c)});return b},adapt:function(a,b){if(a&&b){var c=d(a),g;f.UI.Foundation.Utils.everyReverse(e(),function(a){return a.type===
b&&c.is(a.selector)?(g=a,!1):!0});if(g){var k="foundation.adapters.internal.adapters."+g.type,l=c.data(k);if(l&&l.config===g)return l.instance;a=g.adapter(a);c.data(k,{config:g,instance:a});return a}}}}}();d.fn.adaptTo=d.fn.adaptTo||function(a){return f.UI.Foundation.Adapters.adapt(this[0],a)}})(Granite,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracker",selector:d(f),adapter:function(){var a=!1;return{setDebugMode:function(e){a=!!e},trackPage:function(e){a&&console.dir({type:"page",data:e});try{f.Granite.Tracking.Tracker.trackPage(e)}catch(c){}},trackEvent:function(e){a&&console.dir({type:"event",data:e});try{f.Granite.Tracking.Tracker.trackEvent(e)}catch(c){}}}}})})(window,Granite.$);
(function(f,d,a){a(function(){var e=a("meta[name\x3d'foundation.tracking.page']",d.head).attr("content");e&&(e=JSON.parse(e),a(f).adaptTo("foundation-tracker").trackPage(e))})})(window,document,Granite.$);
(function(f,d,a){a(d).on("click","[data-foundation-tracking-event]",function(e){a(this).adaptTo("foundation-tracking-event").track(e)});a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:"[data-foundation-tracking-event]",adapter:function(e){return{track:function(c){if(c=e.getAttribute("data-foundation-tracking-event"))c=JSON.parse(c),c.feature=c.feature||"",c.action="click",c.widget&&(c.widget.name=c.widget.name||c.element),a(f).adaptTo("foundation-tracker").trackEvent(c)}}}})})(window,
document,Granite.$);(function(f,d){function a(a){return"string"!==typeof a?"":a.toLowerCase()}"undefined"!==typeof Coral&&Coral.tracking&&Coral.tracking.addListener(function(e,c,b,h){e={element:a(e.targetElement),type:a(e.targetType),action:a(e.eventType),widget:{name:a(e.rootElement),type:a(e.rootType)},feature:a(e.rootFeature)};d(f).adaptTo("foundation-tracker").trackEvent(e)})})(window,Granite.$);
(function(f,d,a,e){function c(){g||(g=(new e.Dialog).set({closable:"on"}).on("coral-overlay:close",function(b){b.target.remove()}));return g}function b(){k||(k=(new e.Dialog).set({backdrop:e.Dialog.backdrop.STATIC,interaction:"off"}).on("coral-overlay:close",function(b){b.target.remove()}));return k}function h(){l||(l=d(f.createElement("div")).addClass("foundation-ui-mask"),l.append((new e.Wait).set({centered:!0,size:"L"})));return l}var g,k,l,m=d(window).adaptTo("foundation-registry");m.register("foundation.adapters",
{type:"foundation-ui",selector:d(window),adapter:function(){return{alert:function(b,a,g){var h=c();h.variant=g||"default";h.header.textContent=b||"";h.content.innerHTML=a||"";f.body.appendChild(h);h.show()},notify:function(b,g,c){var h=new e.Alert;h.classList.add("foundation-ui-notification");h.variant=c||"info";h.header.textContent=b||function(){switch(c){case "error":return a.I18n.get("Error");case "notice":return a.I18n.get("Notice");case "success":return a.I18n.get("Success");case "help":return a.I18n.get("Help");
default:return a.I18n.get("Info")}}();h.content.innerHTML=g||"";a.UI.Foundation.Utils.everyReverse(m.get("foundation.ui.notify.positionhandler"),function(b){return!1===b.call(h,h)})&&f.body.appendChild(h);setTimeout(function(){h.remove()},5E3)},waitTicker:function(b,a){var g=new e.Dialog;g.backdrop=e.Dialog.backdrop.STATIC;g.header.textContent=b;g.header.insertBefore(new e.Wait,g.header.firstChild);g.content.innerHTML=a||"";f.body.appendChild(g);g.show();return{updateMessage:function(b){g.content.innerHTML=
b},clear:function(){g.hide();requestAnimationFrame(function(){g.remove()})}}},prompt:function(a,g,c,h,d){var n=b();n.variant=c||"default";n.header.textContent=a||"";n.content.innerHTML=g||"";n.footer.innerHTML="";h.forEach(function(b){var a=new e.Button;a.label.textContent=b.text;b.primary?a.variant="primary":b.warning&&(a.variant="warning");a.on("click",function(a){n.hide();b.handler&&b.handler(b);d&&d(b.id,b)});n.footer.appendChild(a)});f.body.appendChild(n);n.show()},wait:function(b){h().appendTo(b||
f.body)},clearWait:function(){h().detach()}}}})})(document,Granite.$,Granite,Coral);
(function(f,d,a){var e=[],c=function(b,g,c,h){h=h||a(g);var e=[];Array.prototype.forEach.call(b.querySelectorAll(g),function(b){h.is(function(){return c(this,b)})?a(b).remove():e.push(a(b).detach()[0])});return e},b=function(b,g){if(0===b.length)return Array.prototype.push.apply(b,g),b;a.each(g,function(){var a=this;b.some(function(b){return b.src===a.src})||b.push(a)});return b},h=function(b,g){b=b.map(function(b){var c=a.Deferred(),h=d.createElement("script");a(h).one("load error",function(){c.resolve()});
h.async=!1;h.src=b.src;g.appendChild(h);return c});return a.when.apply(null,b)},g=function(g,f){var k=c(g,"script[src]",function(b,a){return b.src===a.src},a(b(e,a("script[src]"))));g=c(g,"link[rel\x3dstylesheet]",function(b,a){return b.href===a.href});var p=a("head");f||(p.append(a("link[rel\x3dstylesheet]",d.body)),a("script[src]",d.body).remove());f=h(k,p[0]);p.append(g);return f};a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-htmlparser",selector:a(f),
adapter:function(){return{parse:function(b,a){var c=b instanceof Element||b instanceof DocumentFragment?b:this.createFragment(b);return g(c,a).then(function(){return c})},createFragment:function(b){var a=d.createElement("template");return"content"in a?(a.innerHTML=b,d.importNode(a.content,!0)):d.createRange().createContextualFragment(b)}}}})})(window,document,Granite.$);
(function(f,d,a){var e=0<=d.platform.toUpperCase().indexOf("MAC");a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-keyboard",selector:a(f),adapter:function(){return{normalize:function(a){a=a.replace(/meta|command|cmd|control/,"ctrl");return e?a.replace(/control|ctrl/,"\u2318"):a}}}})})(window,navigator,Granite.$);
(function(f,d,a){a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-messenger",selector:a(f),adapter:function(){return{put:function(a,c,b){try{var h=JSON.parse(f.sessionStorage.getItem("foundation-util-messenger.internal.messages"))||[];h.push({title:a,message:c,type:b});f.sessionStorage.setItem("foundation-util-messenger.internal.messages",JSON.stringify(h))}catch(g){f.console&&console.warn("Error occur saving message",g)}},promptAll:function(){var e=a(f).adaptTo("foundation-ui"),
c=JSON.parse(f.sessionStorage.getItem("foundation-util-messenger.internal.messages"));c&&(c.forEach(function(b){e.notify(b.title,b.message,b.type)}),f.sessionStorage.removeItem("foundation-util-messenger.internal.messages"))}}}});a(function(){a(f).adaptTo("foundation-util-messenger").promptAll()})})(window,document,Granite.$);
(function(f,d,a){function e(b){var a="GET",g=b,c=void 0;if(2E3<b.length){var e=b.lastIndexOf("?");0<=e&&(a="POST",g=b.substring(0,e),c=b.substring(e+1))}return{method:a,url:g,data:c}}function c(b){this.el=b.el;this.isLoading=!1;this.hasNext=!0;this.offset=0;this.limit=b.limit||20;this._resolveURL=b.resolveURL;this._processResponse=b.processResponse;this._onNewPage=b.onNewPage||a.noop;this._wait=b.wait||function(){return{clear:a.noop}};this._tolerance=20;this._started=this._destroyed=!1;this._scrollHandler=
this._performTimeoutId=null}c.prototype.start=function(b,a,g,c){if(this._destroyed)throw Error("Illegal state: paginator is already destroyed");if(this._started)throw Error("Illegal state: paginator is already started");var h=this,e=this.el;this._started=!0;this.offset=0<=b?b:0;this.hasNext="boolean"===typeof a?a:!0;var f=function(){h._scrollHandler=d.UI.Foundation.Utils.debounce(function(){h._destroyed||e.clientHeight+e.scrollTop+h._tolerance>=e.scrollHeight&&h._loadNextPage()},100);e.addEventListener("scroll",
h._scrollHandler);h.restart(h.offset,h.hasNext,g)};c?this._performTimeoutId=setTimeout(function(){f()},c):f()};c.prototype.restart=function(b,a,g){if(this._destroyed)throw Error("Illegal state: paginator is already destroyed");if(!this._started)throw Error("Illegal state: paginator is not yet started");this.offset=0<=b?b:0;this.hasNext="boolean"===typeof a?a:!0;g&&this.isLoading&&this._lastRequest.abort();this._doFirstLoad(g)};c.prototype.destroy=function(){this._scrollHandler&&(this.el.removeEventListener("scroll",
this._scrollHandler),this._scrollHandler=null);clearTimeout(this._performTimeoutId);this.isLoading&&this._lastRequest.abort();this._destroyed=!0};c.prototype._doFirstLoad=function(b){var a=this;if(!b){b=this.el.clientHeight;var g=this.el.scrollHeight;b=0<b&&g-b<=this._tolerance}b&&this._loadNextPage().then(function(){a._doFirstLoad()});return b};c.prototype._loadNextPage=function(){var b=this;if(this.isLoading||!this.hasNext)return a.Deferred().reject().promise();this.isLoading=!0;var c=this._wait(this),
g=this._resolveURL(this);g=e(g);this._lastRequest=a.ajax({method:g.method,url:g.url,data:g.data,cache:!1});return this._lastRequest.then(function(a){c.clear();return b._processResponse(b,a)},function(g,h){b.isLoading=!1;c.clear();"abort"!==h&&(g=d.I18n.get("Error"),h=d.I18n.get("Fail to load next page."),a(f).adaptTo("foundation-ui").alert(g,h,"error"))}).then(function(a){b.offset+=a.length;b.hasNext=a.hasNext;b.isLoading=!1;b._onNewPage(b)})};a(f).adaptTo("foundation-registry").register("foundation.adapters",
{type:"foundation-util-paginator",selector:a(f),adapter:function(){return c}})})(window,Granite,Granite.$);
(function(f,d){function a(a){this._descriptor=a;this._mixins=[]}a.prototype.mix=function(a){this._mixins.push(a);return this};a.prototype.build=function(){var a=this._descriptor,c=this._mixins.reduce(function(b,a){return a(b)},a),b=this._mixins.reduceRight(function(b,a){return a(b)},a);return{configurable:a.configurable,enumerable:a.enumerable,get:c.get,set:b.set}};a.createAttrBasedProperty=function(a,c){return{get:function(){var b=this.getAttribute(a);return void 0===c?b:null===b?c:b},set:function(b){this.setAttribute(a,
b)}}};a.createBooleanAttrBasedProperty=function(a,c){return{get:function(){return this.hasAttribute(a)?!0:void 0===c?!1:c},set:function(b){b?this.setAttribute(a,""):this.removeAttribute(a)}}};a.integerType=function(a){return function(c){return{get:function(){var b=parseInt(c.get.call(this),10);return isNaN(b)?a:b},set:function(a){a=parseInt(a,10);isNaN(a)&&(a=0);c.set.call(this,a)}}}};a.positiveNumber=function(a){return function(c){return{get:function(){var b=c.get.call(this);return 0>b?a:b},set:function(a){if(0>
a)throw new RangeError("Value is negative number");c.set.call(this,a)}}}};d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-propertybuilder",selector:d(f),adapter:function(){return a}})})(window,Granite.$);
(function(f,d,a){function e(c){this.el=c.el;this._$el=a(this.el);this._selector=c.selector;this._validate=c.validate||function(){return!0};this._perform=c.perform||a.noop;b++;this._ns=".foundation-util-gesture-longpress-pointer-"+b;this._destroyed=!1}var c=a(d),b=0;e.prototype.start=function(){if(this._destroyed)throw Error("Illegal state: this class is already destroyed");if(navigator.pointerEnabled)this._$el.on("pointerdown"+this._ns,this._selector,this._handlePointerEvent.bind(this));else this._$el.on("touchstart"+
this._ns,this._selector,this._handleTouchEvent.bind(this))};e.prototype._handlePointerEvent=function(a){if(0===a.originalEvent.button&&a.originalEvent.isPrimary&&this._validate()){var b=a.originalEvent.clientX,h=a.originalEvent.clientY,e=a.currentTarget,d=this,f=setTimeout(function(){c.off(d._ns);d._perform(e)},500),n=function(){clearTimeout(f);c.off(d._ns)};c.on("pointermove"+this._ns,function(a){(10<Math.abs(a.originalEvent.clientX-b)||10<Math.abs(a.originalEvent.clientY-h))&&n()}).on("pointerup"+
this._ns,n).on("pointercancel"+this._ns,n)}};e.prototype._handleTouchEvent=function(a){if(!(1<a.originalEvent.touches.length)&&this._validate()){var b=a.originalEvent.touches[0];b={x:b.clientX,y:b.clientY};var h=a.currentTarget,d=this,e=setTimeout(function(){c.off(d._ns);d._perform(h)},500),f=function(){clearTimeout(e);c.off(d._ns)};c.on("touchmove"+this._ns,function(a){a=a.originalEvent.touches[0];(10<Math.abs(a.clientX-b.x)||10<Math.abs(a.clientY-b.y))&&f()}).on("touchend"+this._ns,f).on("touchcancel"+
this._ns,f)}};e.prototype.destroy=function(){this._destroyed=!0;this._$el.off(this._ns)};a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-gesture-longpress",selector:a(f),adapter:function(){return e}})})(window,document,Granite.$);
(function(f,d){function a(a,c,b){if(!b)throw Error("Error saving user preferences: action param is missing");c.forEach(function(b){a[b+"@Delete"]=""});d.post({url:b,data:a}).fail(function(a,b,c){console.error("Error saving user preferences:",b,c)})}d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-preference",selector:d(f),adapter:function(){var e=d("meta[name\x3d'user.preferences']",document.head),c=e.attr("data-foundation-preference-action"),b={};try{b=JSON.parse(e.prop("content"))}catch(h){}return{_setAction:function(a){c=
a},names:function(){return Object.keys(b)},get:function(a){return b[a]},getBoolean:function(a,b){a=this.get(a);return void 0!==b&&void 0===a?b:"boolean"===typeof a?a:"true"===a?!0:"false"===a?!1:!!a},getNumber:function(a,b){a=this.get(a);if("number"===typeof a)return a;b=void 0===b?0:b;a=Number(a).valueOf();return isNaN(a)?b:a},set:function(a,b){var c=new Map;c.set(a,b);this.setAll(c)},setAll:function(e){var g={},h=[];e.forEach(function(a,c){void 0===a?(delete b[c],h.push(c)):(b[c]=a,g[c]=a)});d(document).trigger("foundation-preference-change");
a(g,h,c)}}}})})(window,Granite.$);(function(f,d){var a=Granite.UI.Foundation.Utils.everyReverse,e=d(f).adaptTo("foundation-registry");e.register("foundation.adapters",{type:"foundation-response-parser",selector:d(f),adapter:function(){return{parse:function(c){var b,d=c.getResponseHeader("content-type");if(!d)return c.responseText;a(e.get("foundation.response.parser"),function(a){if(!d.match(a.contentType))return!0;a=a.handler(c);if(!1===a)return!0;b=a;return!1});return b}}}})})(window,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.json",contentType:/application\/json/,handler:function(a){return JSON.parse(a.responseText)}})})(window,Granite.$);(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.html",contentType:/text\/html/,handler:function(a){return d(f).adaptTo("foundation-util-htmlparser").createFragment(a.responseText)}})})(window,Granite.$);
(function(f,d,a,e){function c(a,b){for(var c=a.length-1;0<=c;c--){var g=a[c];if(g.submittable&&b.is(g.submittable))return g}}function b(b,c){this.el=b;this.selectorConfig=c;this.$el=a(b);this.customMessage=this.message=null;this.isValidated=!1;this.state=function(a){return{getCustomError:function(){return!!a.customMessage},isValid:function(){return!a.customMessage&&!a.message},isValidated:function(){return a.isValidated}}}(this)}function h(a){return a.reduceRight(function(a,b){b.submittable&&a.push(b.submittable);
return a},[]).join(",")}function g(a,b){return a.some(function(a){return a.exclusion?b.is(a.exclusion):!1})}function k(b){return a(b.adaptTo("foundation-validation-helper").getSubmittables()).map(function(){var b=a(this).adaptTo("foundation-validation");if(!b.checkValidity({suppressEvent:!0}))return{el:this,api:b}}).map(function(){var b=a.Event("foundation-validation-invalid");a(this.el).trigger(b);if(!b.isDefaultPrevented())return this})}function l(a){a=k(a);return 0<a.length?(a.each(function(){this.api.updateUI()}),
!1):!0}var m=e.UI.Foundation.Utils.everyReverse,p=a(f).adaptTo("foundation-registry");b.prototype={willValidate:function(){if(!this.selectorConfig){var a=p.get("foundation.validation.selector");this.selectorConfig=c(a,this.$el)}return(a=this.selectorConfig.candidate)&&this.$el.is(a)},setCustomValidity:function(a){this.customMessage=a},getValidity:function(){return this.state},checkValidity:function(a){a=a||{};if(!this.willValidate())return this.customMessage=this.message=null,this.isValidated=!0,
a.suppressEvent||this.$el.trigger("foundation-validation-valid"),!0;this.isValidated=!0;if(this.customMessage)return a.suppressEvent||this.$el.trigger("foundation-validation-invalid"),!1;this.message=null;m(p.get("foundation.validation.validator"),function(a){return a.validate&&this.$el.is(a.selector)?(a=a.validate(this.el))?(this.message=a,!1):!0:!0},this);if(this.message)return a.suppressEvent||this.$el.trigger("foundation-validation-invalid"),!1;a.suppressEvent||this.$el.trigger("foundation-validation-valid");
return!0},getValidationMessage:function(){return this.willValidate()?this.customMessage||this.message||"":""},updateUI:function(){if("none"!==this.el.dataset.foundationValidationUi){var a=this.getValidity().isValid()?function(a){if(!a.clear||!this.$el.is(a.selector))return!0;var b=!1;a.clear(this.el,{next:function(){b=!0}});return b}:function(a){if(!a.show||!this.$el.is(a.selector))return!0;var b=!1;a.show(this.el,this.getValidationMessage(),{next:function(){b=!0}});return b};m(p.get("foundation.validation.validator"),
a,this)}}};var n=new WeakMap;a.extend(a.expr[":"],{"-foundation-submittable":function(b){if(n.has(b))return n.get(b).isSubmittable;var d=a(b),e=p.get("foundation.validation.selector"),h=c(e,d),f=!1;h&&(f=!g(e,d));n.set(b,{isSubmittable:f,selectorConfig:h});return f}});p.register("foundation.adapters",{type:"foundation-validation",selector:":-foundation-submittable",adapter:function(a){return new b(a,n.get(a).selectorConfig)}});p.register("foundation.adapters",{type:"foundation-validation-helper",
selector:"*",adapter:function(b){return{getSubmittables:function(){var c=p.get("foundation.validation.selector");return a(b).find(h(c)).filter(function(){var b=!g(c,a(this));n.set(this,{isSubmittable:b});return b}).toArray()},isValid:function(){return this.getSubmittables().every(function(b){b=a(b).adaptTo("foundation-validation");var c=b.getValidity();return c.isValidated()?c.isValid():b.checkValidity({suppressEvent:!0})})}}}});d.addEventListener("submit",function(b){var c=a(b.target);if(c.is("form")&&
!0!==c.prop("noValidate")&&(void 0!==c.prop("noValidate")||void 0===c.attr("novalidate"))){var g=c.data("foundation-validation-bind.internal.valid");(void 0!==g?g:l(c))||(b.stopPropagation(),b.preventDefault())}},!0)})(window,document,Granite.$,Granite);
(function(f,d,a,e){function c(a){f.console&&1>h&&(h++,console.warn("@deprecated ",a,"; use foundation-validation"))}function b(b){var c=b.validate;c&&(b.validate=function(b){return c(a(b))});var g=b.show;g&&(b.show=function(b,c,d){g(a(b),c)===a.validator.CONTINUE&&d.next()});var d=b.clear;d&&(b.clear=function(b,c){d(a(b))===a.validator.CONTINUE&&c.next()});return b}var h=0;a.extend(a.expr[":"],{submittable:function(b){c(":submittable");return a(b).is(":-foundation-submittable")}});a.fn.willValidate=
function(){c("$.fn.willValidate");var a=this.adaptTo("foundation-validation");return a?a.willValidate():!1};a.fn.validationMessage=function(){c("$.fn.validationMessage");var a=this.adaptTo("foundation-validation");return a?a.getValidationMessage():""};a.fn.checkValidity=function(){c("$.fn.checkValidity");var a=this.adaptTo("foundation-validation");return a?a.checkValidity():!0};a.fn.setCustomValidity=function(b){c("$.fn.setCustomValidity");return this.each(function(){var c=a(this).adaptTo("foundation-validation");
c&&c.setCustomValidity(b)})};a.fn.updateErrorUI=function(){c("$.fn.updateErrorUI");return this.each(function(){var b=a(this).adaptTo("foundation-validation");b&&b.updateUI()})};var g=a(f).adaptTo("foundation-registry");a.validator={CONTINUE:1,STOP:2,register:function(){c("$.validator");a.each(arguments,function(){g.register("foundation.validation.validator",b(this))})},isValid:function(b,g){c("$.validator");return b.adaptTo("foundation-validation-helper").getSubmittables().every(function(b){b=a(b).adaptTo("foundation-validation");
var c=b.getValidity();return c.isValidated()?c.isValid():b.checkValidity({suppressEvent:g})})}};a(d).on("foundation-validation-valid",function(b){a(b.target).trigger("valid")});a(d).on("foundation-validation-invalid",function(b){var c=a.Event("invalid",{isJqueryValidator:!0});a(b.target).trigger(c);c.isDefaultPrevented()&&b.preventDefault()})})(window,document,Granite.$,Granite);
(function(f,d){function a(a){var b=a.find(".foundation-validation-bind"),c=a.prop("id");c&&(b=b.add(d(".foundation-validation-bind[form]").filter(function(){return d(this).attr("form")===c})));return b}function e(c){var b=a(c);if(b.length){var d=c.adaptTo("foundation-validation-helper").isValid();c.data("foundation-validation-bind.internal.valid",d);b.prop("disabled",!d)}}d(f).on("foundation-validation-invalid","form",function(c){var b=d(this);a(b).prop("disabled",!0);c=c.target;var e=b.data("foundation-validation-bind.internal.invalids");
void 0===e&&(e=[],b.data("foundation-validation-bind.internal.invalids",e));0>e.indexOf(c)&&e.push(c)});d(f).on("foundation-validation-valid","form",function(a){var b=d(this),c=b.data("foundation-validation-bind.internal.invalids");if(c)if(a=c.indexOf(a.target),0<=a&&c.splice(a,1),0===c.length)e(b);else{a=!1;for(var g=c.length;g--;){if(b.has(c[g]).length){a=!0;break}c.splice(g,1)}a||e(b)}else e(b)})})(document,Granite.$);
(function(f,d,a,e){function c(a){if(a&&a.getLabelledBy)return a.getLabelledBy()}f=a(f).adaptTo("foundation-registry");f.register("foundation.validation.validator",{selector:"*",show:function(b,d){var g=a(b),h=g.adaptTo("foundation-field");h&&h.setInvalid&&h.setInvalid(!0);var f=g.data("foundation-validation.internal.error");f?(f.content.innerHTML=d,f.parentNode||(g.after(f),f.show(),b=c(h),f=f.id,h&&h.setLabelledBy&&h.setLabelledBy(b?b+" "+f:f))):(f=new e.Tooltip,f.variant="error",f.interaction="off",
f.placement="top",f.target=b,f.content.innerHTML=d,f.open=!0,f.id=e.commons.getUID(),g.data("foundation-validation.internal.error",f),g.after(f),b=c(h),f=f.id,h&&h.setLabelledBy&&h.setLabelledBy(b?b+" "+f:f))},clear:function(b){var d=a(b);(b=d.adaptTo("foundation-field"))&&b.setInvalid&&b.setInvalid(!1);var g=d.data("foundation-validation.internal.error");g&&(g.hide(),g.remove(),(d=c(b))&&-1!==d.indexOf(g.id)&&(d=d.split(" ").filter(function(a){return a!==g.id}).join(" "),b&&b.setLabelledBy&&b.setLabelledBy(d)))}});
f.register("foundation.validation.selector",{exclusion:".foundation-field-mixed"});f.register("foundation.validation.selector",{exclusion:".foundation-field-related"})})(window,document,Granite.$,Coral);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:"[data-foundation-validation~\x3d'foundation.jcr.name'],[data-validation~\x3d'foundation.jcr.name']",validate:function(d){d=d.value;for(var c=0,b=d.length;c<b;c++)if(0<='%/\\:*?"[]|\n\t\r. '.indexOf(d[c])||127<d.charCodeAt(c))return a.I18n.get("Invalid character '{0}'. It must be a valid JCR name.",[d[c]])}})})(window,Granite.$,Granite);
(function(f,d,a){var e=Granite.UI.Foundation.Time;e?(e.relative=a(f).adaptTo("foundation-preference").get("relativeDateCutoff"),e.locale=d.documentElement.lang||f.navigator.userLanguage||f.navigator.language):console.warn("Granite.UI.Foundation.Time is not available; no setting is set")})(window,document,Granite.$);
(function(f,d,a,e,c,b){function h(b){return b?"#"===b[0]?a.when(d.querySelector(b)):a.ajax({url:b,cache:!1}).then(function(b){return a(f).adaptTo("foundation-util-htmlparser").parse(b)}).then(function(b){return a(b).children()[0]}):a.Deferred().reject().promise()}function g(a){return{setName:function(b){a.setAttribute("name",b)},setDisabled:function(b){a.disabled=b},setReadOnly:function(b){a.readOnly=b},getValues:function(){return a.items.getAll().map(function(a){return{value:a.value,text:a.label.textContent,
isUserDefined:a.hasAttribute("data-foundation-autocomplete-value-userdefined")}})},setValues:function(b){a.items.clear();this.appendValues(b)},appendValues:function(b){b.forEach(function(b){var c=(new e.Tag).set({closable:!0,value:b.value,label:{textContent:b.text}});b.isUserDefined&&c.setAttribute("data-foundation-autocomplete-value-userdefined","");if(b.data)for(var g in b.data)if(b.data.hasOwnProperty(g)){var d=g,h=g.charAt(0);h!==h.toUpperCase()&&(d=h.toUpperCase(),1<g.length&&(d+=g.substr(1)));
c.dataset["foundationAutocompleteCustom"+d]=b.data[g]}a.items.add(c)})}}}var k=a(f).adaptTo("foundation-util-propertybuilder"),l=0<=f.navigator.userAgent.indexOf("Trident/7.0"),m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var b=this;this._render();var c;l?this._input.addEventListener("keydown",function(a){clearTimeout(c);c=setTimeout(b._onUserInput.bind(b),b.delay)}):this._input.addEventListener("input",function(a){clearTimeout(c);c=setTimeout(b._onUserInput.bind(b),b.delay)});
this._input.addEventListener("keydown",function(a){switch(a.keyCode){case 38:case 40:a.preventDefault();clearTimeout(c);b._suggestion.open?b._focus(b._suggestion,38===a.keyCode):b._onUserInput();break;case 27:a.preventDefault();clearTimeout(c);b._cancelSuggestion();break;case 9:clearTimeout(c);b._cancelSuggestion();break;case 13:(b._suggestion.open||"inline"!==b.valueDisplayMode&&""!==b._input.value)&&a.preventDefault(),clearTimeout(c),a=b._input.value.trim(),a.length&&b._appendValue(a).then(function(){b._cancelSuggestion();
b._input.value=""})}});this._input.addEventListener("blur",function(a){!b.multiple&&b.forceSelection&&b._getValueAPI(function(a){a=a.getValues();b._input.value=a.length?a[0].text:""})});a(this).on("change","coral-taglist[foundation-autocomplete-value]",function(a){b._onValueChangeByUser()});a(this).on("coral-collection:remove","coral-taglist[foundation-autocomplete-value]",function(a){b.classList.contains("foundation-field-mixed")&&(a=a.originalEvent.detail.item,a.value.startsWith("+")||b._removedValuesWhenMixed.push(a.value))});
a(this).on("change foundation-field-change",function(a){a.target!==b&&a.stopImmediatePropagation()});this._button.addEventListener("click",function(a){a.preventDefault();b._togglePicker()});this._suggestion={el:null,open:!1,api:null};this._value={el:null,api:null};this._picker={el:null,open:!1,loading:!1,api:null};this._removedValuesWhenMixed=[];this._setupValueObserver();for(var g=this.attributes,d=0;d<g.length;d++)this.attributeChangedCallback(g[d].name,void 0,g[d].value)};m.attributeChangedCallback=
function(a,b,c){if("pickersrc"===a)this._picker.el=null;else if("variant"===a)this._onVariantChange();else if("name"===a)this._getValueAPI(function(a){a.setName(c)});else if("placeholder"===a)this._input.setAttribute("placeholder",c);else if("labelledby"===a)this._input.setAttribute("labelledby",c);else if("disabled"===a){var g=null!==c;this._input.disabled=g;this._button.disabled=g;this._getValueAPI(function(a){a.setDisabled(g)})}else if("readonly"===a){var d=null!==c;this._input.readOnly=d;this._button.disabled=
d;this._getValueAPI(function(a){a.setReadOnly(d)})}else"invalid"===a?this._input.invalid=null!==c:"required"===a&&this._input.setAttribute("aria-required",null!==c)};Object.defineProperties(m,{field:{get:function(){return this._input}},delay:(new k(k.createAttrBasedProperty("delay"))).mix(k.integerType(500)).mix(k.positiveNumber(500)).build(),pickerSrc:k.createAttrBasedProperty("pickersrc"),valueDisplayMode:k.createAttrBasedProperty("valuedisplaymode","inline"),variant:k.createAttrBasedProperty("variant"),
name:k.createAttrBasedProperty("name",""),placeholder:k.createAttrBasedProperty("placeholder",""),labelledBy:k.createAttrBasedProperty("labelledby",""),disabled:k.createBooleanAttrBasedProperty("disabled"),readOnly:k.createBooleanAttrBasedProperty("readonly"),invalid:k.createBooleanAttrBasedProperty("invalid"),required:k.createBooleanAttrBasedProperty("required"),multiple:k.createBooleanAttrBasedProperty("multiple"),forceSelection:k.createBooleanAttrBasedProperty("forceselection"),value:{get:function(){return this.multiple?
this.values[0]:this.values[0]||""},set:function(a){this.values=[a]}},values:{get:function(){return this._getValueAPI(function(a){return a.getValues().map(function(a){return a.value})})},set:function(a){var b=this;this._getValueAPI(function(c){var g=a.map(function(a){return{value:a,text:a}});b.multiple?c.setValues(g):c.setValues(0<g.length?[g[0]]:[]);b._validate()})}}});m.focus=function(){requestAnimationFrame(function(){this._input.focus()}.bind(this))};m.clear=function(){this.values=[];this._input&&
requestAnimationFrame(function(){this._input.value=""}.bind(this))};m._render=function(){for(var a=0;a<this.children.length;a++){var b=this.children[a];b.classList.contains("foundation-autocomplete-inputgroupwrapper")&&this.removeChild(b)}this._inputGroup=d.createElement("div");this._inputGroup.classList.add("coral-InputGroup");this._input=new e.Textfield;this._input.classList.add("coral-InputGroup-input");this._input.autocomplete="off";this._input.placeholder=this.placeholder;this._input.labelledBy=
this.labelledBy;a=d.createElement("span");a.classList.add("coral-InputGroup-button");b=c.I18n.get("Open Selection Dialog");this._button=(new e.Button).set({icon:"select",title:b,type:"button"});this._button.setAttribute("aria-label",b);a.appendChild(this._button);this._inputGroup.appendChild(this._input);this._inputGroup.appendChild(a);this._inputGroupWrapper=d.createElement("div");this._inputGroupWrapper.classList.add("foundation-autocomplete-inputgroupwrapper");this._inputGroupWrapper.appendChild(this._inputGroup);
this.insertBefore(this._inputGroupWrapper,this.firstChild);this._onVariantChange();this.setAttribute("role","combobox")};m._setupValueObserver=function(){var b=this,c=[this._handleInputSize(),this._handleSingleSelectionMode()],g=function(){b._getValueAPI(function(){c.forEach(function(a){a.perform.call(b)})})};g();(new MutationObserver(function(b){b.forEach(function(b){a(b.addedNodes).filter("[foundation-autocomplete-value]").each(function(){g()})})})).observe(this,{childList:!0})};m._handleInputSize=
function(){var b=function(b){var c=a(this._input);this.multiple&&"inline"===this.valueDisplayMode?b?(b=a(b).outerWidth(!0),c.css("padding-left",b)):c.css("padding-left",""):c.css("padding-left","")}.bind(this),c=function(a){b(this)};return{perform:function(){e.commons.addResizeListener(this._value.el,c)},destroy:function(){b();e.commons.removeResizeListener(this._value.el,c)}}};m._handleSingleSelectionMode=function(){var b=function(){var a=this._value.el.items.getAll()[0];a&&(this._input.value=a.value)}.bind(this),
c;return{perform:function(){this.multiple||requestAnimationFrame(function(){b()});c=new MutationObserver(function(c){this.multiple||c.forEach(function(c){a(c.addedNodes).filter("coral-tag").length&&b()})}.bind(this));c.observe(this._value.el,{childList:!0})},destroy:function(){c.disconnect()}}};m._onVariantChange=function(){"omnisearch"===this.variant?(this._input.variant="quiet",this._button.variant="quiet",this._inputGroup.classList.add("coral-InputGroup--quiet")):(this._input.variant=e.Textfield.variant.DEFAULT,
this._button.variant=e.Button.variant.DEFAULT,this._inputGroup.classList.remove("coral-InputGroup--quiet"))};m._onUserInput=function(){var a=this;this.multiple||this._appendValue(this._input.value.trim(),!0);var b=function(b){a._input.value=b};this._getSuggestionAPI(function(c){var g=this._getValueAPI(function(a){return a.getValues()},function(){return[]});c.pick(a,g,a._input.value,b).then(function(b){a._suggestion.open=!1;a._input.value="";a._input.focus();a._setSelections(b)},function(){a._suggestion.open=
!1;a._input.focus()});a._suggestion.open=!0})};m._onValueChangeByUser=function(b){var c=this;b?this._deferChangeEvent||(this._deferChangeEvent=!0,a(this._input).on("focusout",function u(b){c.contains(b.relatedTarget)||(a(c._input).off("focusout",u),c._triggerChangeEvent(),c._deferChangeEvent=null)}),this._validate()):(this._triggerChangeEvent(),this._validate())};m._triggerChangeEvent=function(){var b=d.createEvent("HTMLEvents");b.initEvent("change",!0,!1);this.dispatchEvent(b);a(this).trigger("foundation-field-change")};
m._getSuggestionAPI=function(b,c){if(!this._suggestion.api){var g=a(this).children("[foundation-autocomplete-suggestion]").first();if(!g.length){if(c)return c.call(this);return}this._suggestion.el=g[0];this._suggestion.api=g.adaptTo("foundation-picker")}return b.call(this,this._suggestion.api)};m._getValueAPI=function(b,c){if(!this._value.api){var d=a(this).children("[foundation-autocomplete-value]").first();if(!d.length){if(c)return c.call(this);return}this._value.el=d[0];this._value.api=g(d[0])}return b.call(this,
this._value.api)};m._focus=function(a,b){"focus"in a.api?a.api.focus(b):a.el.focus()};m._validate=function(){var b=a(this).adaptTo("foundation-validation");b&&(b.checkValidity(),b.updateUI())};m._setSelections=function(a,b){var c=this;c._getValueAPI(function(g){c.multiple?c.classList.contains("foundation-field-mixed")?g.appendValues(a.map(function(a){var b=c._removedValuesWhenMixed.indexOf(a.value);0<=b?c._removedValuesWhenMixed.splice(b,1):a.value="+"+a.value;return a})):g.appendValues(a):a.length?
g.setValues([a[0]]):g.setValues([]);c._onValueChangeByUser(b)})};m._cancelSuggestion=function(){var a=this;a._suggestion.open&&this._getSuggestionAPI(function(b){b.cancel();a._suggestion.open=!1})};m._appendValue=function(b,c){var g=this;if(!this.multiple&&0===b.length)return this._setSelections([],c),a.when();var d=a.Deferred();this._getSuggestionAPI(function(a){a.resolve([b]).then(function(a){null!==a[0]?(g._setSelections(a,c),d.resolve()):g.forceSelection||(g._setSelections([{value:b,text:b,isUserDefined:!0}],
c),d.resolve())})},function(){if(g.forceSelection)return d.reject();g._setSelections([{value:b,text:b,isUserDefined:!0}],c);d.resolve()});return d.promise()};m._resolvePickerSrc=function(){var a=this._getValueAPI(function(a){return a.getValues()},function(){return[]}),c={value:""};0<a.length&&(c.value=a[a.length-1].value);this._resolvedPickerSrc=b.expand(this.pickerSrc,c)};m._loadAndShowPicker=function(){var b=this;this._picker.loading=!0;this._resolvePickerSrc();h(this._resolvedPickerSrc).then(function(c){b._picker.loading=
!1;b._picker.el=c;b._picker.api=a(c).adaptTo("foundation-picker");b._showPicker()},function(){b._picker.loading=!1})};m._togglePicker=function(){this._picker.loading||(this._picker.el?this._picker.open?(this._picker.api.cancel(),this._onCancelPicker()):this._loadAndShowPicker():this._loadAndShowPicker())};m._showPicker=function(){var a=this,b=this._picker.api;b.attach(this);var c=this._getValueAPI(function(a){return a.getValues()},function(){return[]});b.pick(this,c,this._input.value).then(function(b){a._picker.api.detach();
a._picker.open=!1;a._input.focus();a._setSelections(b)},function(){a._onCancelPicker()});this._focus(this._picker);this._picker.open=!0};m._onCancelPicker=function(){this._picker.api.detach();this._picker.open=!1;this._input.focus()};d.registerElement("foundation-autocomplete",{prototype:m});k=a(f).adaptTo("foundation-registry");k.register("foundation.adapters",{type:"foundation-overlay-anchor",selector:"foundation-autocomplete",adapter:function(a){return{getElement:function(){return a._inputGroupWrapper}}}});
k.register("foundation.validation.selector",{submittable:"foundation-autocomplete",candidate:"foundation-autocomplete:not([readonly]):not([disabled])",exclusion:"foundation-autocomplete *"});k.register("foundation.validation.validator",{selector:"foundation-autocomplete",validate:function(a){if(a.required&&(a.multiple&&0===a.values.length||!a.multiple&&0===a.value.length))return c.I18n.get("Please fill out this field.")}});k.register("foundation.adapters",{type:"foundation-field",selector:"foundation-autocomplete",
adapter:function(b){var c=a(b);return{getName:function(){return b.name},setName:function(a){c.children(".foundation-field-related").each(function(){this.name.startsWith(b.name+"@")&&(this.name=a+this.name.substring(b.name.length))});b.name=a},isDisabled:function(){return b.disabled},setDisabled:function(a){b.disabled=a;c.children(".foundation-field-related:not(.foundation-field-mixed-patchcontrol)").prop("disabled",a)},isInvalid:function(){return b.invalid},setInvalid:function(a){b.invalid=a},isRequired:function(){return b.required},
setRequired:function(a){b.required=a},getValue:function(){return b.value},setValue:function(a){b.value=a},getLabelledBy:function(){return b.labelledBy},setLabelledBy:function(a){b.labelledBy=a},getValues:function(){return b.values},setValues:function(a){b.values=a},clear:function(){b.clear()}}}});k.register("foundation.form.submit",{selector:"*",handler:function(b){var c=[];a(b).find("foundation-autocomplete.foundation-field-mixed").each(function(){var a=this;a._removedValuesWhenMixed.forEach(function(b){var g=
d.createElement("input");g.type="hidden";g.name=a.name;g.value="-"+b;a.appendChild(g);c.push(function(){a.removeChild(g)})});c.push(function(){a._removedValuesWhenMixed=[]})});return{post:function(){c.forEach(function(a){a()});return a.when()}}}})})(window,document,Granite.$,Coral,Granite,Granite.URITemplate);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection",selector:".foundation-collection",adapter:function(a){var e=d(a);return{append:function(a){e.append(a);e.trigger("foundation-contentloaded")},clear:function(){e.find(".foundation-collection-item").remove()}}}})})(window,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-selections",selector:".foundation-collection",adapter:function(a){var e=d(a);return{count:function(){return e.find(".foundation-selections-item").length},selectAll:function(a){var b=e.find(".foundation-collection-item:not(.foundation-selections-item)").addClass("foundation-selections-item").length;!a&&b&&e.trigger("foundation-selections-change")},clear:function(a){var b=e.find(".foundation-selections-item").removeClass("foundation-selections-item").length;
!a&&b&&e.trigger("foundation-selections-change")},select:function(a){a=d(a);a.is(".foundation-collection-item")&&(a.toggleClass("foundation-selections-item",!0),e.trigger("foundation-selections-change"))},deselect:function(a){a=d(a);a.is(".foundation-collection-item")&&(a.toggleClass("foundation-selections-item",!1),e.trigger("foundation-selections-change"))},isAllSelected:function(){var a=e.find(".foundation-collection-item").length;return 0<a?a===this.count():!1}}}})})(window,Granite.$);
(function(f,d,a){a(d).on("foundation-selections-change",".foundation-collection[role\x3dlistbox]",function(d){var c=a(this);c.find(".foundation-collection-item").each(function(){var b=a(this),d=b.is(".foundation-selections-item");b.attr("aria-selected",d);c.hasClass("aria-skiphandling")||(b=b.find("input.aria-value[type\x3dhidden]"),b.prop("disabled",!d),(d=c.data("aria-name"))&&!b.prop("name")&&b.prop("name",d),b.length&&f.console&&console.log("@deprecated .aria-value, [data-aria-name]; please use .foundation-advancedselect instead."))});
if(d=c.adaptTo("foundation-validation"))d.checkValidity(),d.updateUI()})})(window,document,Granite.$);
(function(f,d,a){function e(a,b){b?a.removeClass("foundation-collection-action-hidden"):a.addClass("foundation-collection-action-hidden")}function c(a,b){return 0===b&&0===a||0<b&&"\x3e0"===a?!0:!1}function b(a,b){return 0===b&&"none"===a||1===b&&"single"===a||1<=b&&("multiple"===a||"bulk"===a)?!0:!1}function h(a,b,c,g){if("none"===g)return!0;if("item"===g)return b=c.toArray().map(function(a){a=d(a).find(".foundation-collection-quickactions").data("foundationCollectionQuickactionsRel")||"";a=a.trim();
return a.length?a.split(/\s+/):[]}),b.every(function(a){return 0===a.length})?!0:b.every(function(b){return!b.every(function(b){return!a.hasClass(b)})});b=b.adaptTo("foundation-collection-meta");if(!b)return!0;b=b.getRelationship()||"";b=b.trim();b=b.length?b.split(/\s+/):[];return 0===b.length?!0:b.some(function(b){return a.hasClass(b)})}function g(g,d,e,f,k){var n=!0;"activeCount"in d&&(n=c(d.activeCount,f.length));n&&"activeSelectionCount"in d&&(n=b(d.activeSelectionCount,k.length));n&&"activeCondition"in
d&&a.UI.Foundation.Utils.everyReverse(l.get("foundation.collection.action.activecondition"),function(a){if(a.name!==d.activeCondition)return!0;a=a.handler.call(g[0],a.name,g[0],d,e[0],k.toArray());return!1===a||!0===a?(n=a,!1):!0});n&&(n=h(g,e,k,d.ignoreRel?"none":d.relScope||"item"));return n}function k(a,b){b=b.target;b||(a=a.closest(".foundation-collection-actionbar"),a.length&&(b=a[0].dataset.foundationCollectionActionbarTarget));return b}var l=d(window).adaptTo("foundation-registry");d(f).on("foundation-contentloaded",
function(a){var b=new Map;d(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)",a.target).each(function(){var a=d(this),c=a.data("foundationCollectionAction")||{},h=k(a,c);if(h){if(b.has(h)){h=b.get(h);var f=h.collection;var n=h.items;var l=h.selections}else f=d(h),n=f.find(".foundation-collection-item"),l=n.filter(".foundation-selections-item"),b.set(h,{collection:f,items:n,selections:l});f.length&&e(a,g(a,c,f,n,l))}})});d(f).on("foundation-selections-change",
".foundation-collection",function(a){var b=d(this),c,h;d(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)").each(function(){var a=d(this),f=a.data("foundationCollectionAction")||{},n=k(a,f);n&&b.is(n)&&(c||(c=b.find(".foundation-collection-item"),h=c.filter(".foundation-selections-item")),e(a,g(a,f,b,c,h)))})});var m=new WeakMap;f.addEventListener("click",function(b){var c=d(b.target).closest(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)");
if(0!==c.length){var g=c.data("foundationCollectionAction")||{},e=k(c,g);if(e){e=d(e);var h=e.adaptTo("foundation-collection").getPagination();m.has(c[0])&&m.get(c[0])||"true"!==e[0].dataset.foundationSelectionsSelectallMode||"bulk"===g.activeSelectionCount||!h||!h.hasNext||(g=d(window).adaptTo("foundation-ui"),b.stopImmediatePropagation(),g.prompt(a.I18n.get("Bulk Action Not Supported"),a.I18n.get("The selected action \x3cb\x3e{0}\x3c/b\x3e will only have effect on the \x3cb\x3e{1}\x3c/b\x3e selected items currently loaded.\x3cbr/\x3eIf you wish to apply it to non-loaded items, please make sure they are explicitly selected.",
[c.text(),e.adaptTo("foundation-selections").count()]),"warning",[{id:"cancel",text:a.I18n.get("Cancel")},{id:"continue",text:a.I18n.get("Continue"),primary:!0,handler:function(){m.set(c[0],!0);c[0].click()}}]))}}},!0);d(f).on("click",".foundation-collection-action",function(b){m.delete(this);var c=d(this),g=c.data("foundationCollectionAction");if(g&&g.action){var e=d(),h=[],f=c.data("foundationCollectionItem");f?(e=d(f).closest(".foundation-collection"),h=[f]):g.target?(e=d(g.target),h=e.find(".foundation-selections-item").toArray()):
(f=c.closest(".foundation-collection-item, .foundation-collection-actionbar"),f.hasClass("foundation-collection-actionbar")?(e=d(f[0].dataset.foundationCollectionActionbarTarget),h=e.find(".foundation-selections-item").toArray()):f.hasClass("foundation-collection-item")&&(e=f.closest(".foundation-collection"),h=f.toArray()));a.UI.Foundation.Utils.everyReverse(l.get("foundation.collection.action.action"),function(a){if(a.name!==g.action)return!0;(a=!1===a.handler.call(c[0],a.name,c[0],g,e[0],h))||
b.preventDefault();return a})}})})(document,Granite.$,Granite);(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.link",handler:function(d,c,b,h,g){d=a.expand(b.data.href,{id:h.dataset.foundationCollectionId,item:g.map(function(a){return a.dataset.foundationCollectionItemId})});b.data.target?f.open(d,b.data.target):f.location=d}})})(window,Granite.$,Granite.URITemplate);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.pushstate",handler:function(e,c,b,h,g){if(e=d(".foundation-content").adaptTo("foundation-content"))g=g.map(function(a){return d(a).data("foundation-collection-item-id")}),g=a.expand(b.data.href,{item:g}),e.pushState(b.data.data,b.data.title,g)}})})(window,Granite.$,Granite.URITemplate);
(function(f,d,a,e){function c(c,e,h){if(e)return(b.has(e)?a.Deferred().resolve(b.get(e)).promise():a.ajax({url:e,cache:!1})).then(function(c){var g=a(c).on("foundation-toggleable-hide",function(b){var c=a(b.target);requestAnimationFrame(function(){c.detach()})}).appendTo(d.body).trigger("foundation-contentloaded");b.set(e,c);return g});c=h?a(h):c.closest(".foundation-toggleable");return a.Deferred().resolve(c).promise()}var b=new Map,h="."+Date.now();a(f).adaptTo("foundation-registry").register("foundation.collection.action.action",
{name:"foundation.dialog",handler:function(b,d,f,m,p){var g=a(d);b=f.data.target;var k=f.data.nesting,l;f.data.src&&(l=e.expand(f.data.src,{id:m.dataset.foundationCollectionId,item:p.map(function(a){return a.dataset.foundationCollectionItemId})}));c(g,l,b).then(function(b){var c=b.adaptTo("foundation-toggleable");b.off(h).one("foundation-form-submitted"+h,function(b,g,d){g&&(c.hide(),b=a(m).adaptTo("foundation-collection"),"reload"in b&&b.reload())});requestAnimationFrame(function(){if("hide"===k){var a=
g.closest(".foundation-toggleable").adaptTo("foundation-toggleable");a&&a.hide()}c.show(d)})})}})})(window,document,Granite.$,Granite.URITemplate);(function(f,d){d(f).on("click",".foundation-collection-item-activator",function(a){a=d(this).closest(".foundation-collection-item");a.closest(".foundation-collection").adaptTo("foundation-selections").select(a[0])})})(document,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection-item-action",selector:".foundation-collection",adapter:function(a){var e=d(a);return{execute:function(a){var b;if(b=d(a).hasClass("foundation-collection-navigator")?a:a.querySelector(".foundation-collection-navigator")){var c=b.dataset.foundationCollectionNavigatorHref;b=b.dataset.foundationCollectionNavigatorTarget||"_self";c?f.open(c,b):e.adaptTo("foundation-collection").load(a.dataset.foundationCollectionItemId)}}}}})})(window,
Granite.$);(function(f,d){d(f).on("foundation-selections-change",".foundation-collection-masterdetail",function(a){var e=d(this);a=d(this.dataset.foundationCollectionMasterdetailTarget);a.length&&(e=e.find(".foundation-selections-item").first(),e.length&&a.adaptTo("foundation-collection").load(e[0].dataset.foundationCollectionItemId))})})(document,Granite.$);
(function(f,d,a,e){d(f).on("foundation-selections-change",".foundation-collection-previewsupport",function(c){var b=this.dataset.foundationCollectionPreviewsupportTarget,h=this.dataset.foundationCollectionPreviewsupportSrc;c="child"===this.dataset.foundationCollectionPreviewsupportCollection?d(this).children(".foundation-collection"):d(c.target);var g=d(b);if(g.length){var f=c.find(".foundation-selections-item");b=a.expand(h,{item:f.toArray().map(function(a){return a.dataset.foundationCollectionItemId})});
var l=d(window).adaptTo("foundation-ui");l.wait(g[0]);d.ajax({url:b,cache:!1}).then(function(a){return d(window).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){l.clearWait();g.empty().append(a).trigger("foundation-contentloaded")})},function(a,b,c){l.clearWait();if(f.length||"error"!==b||"Not Found"!==c)a=e.I18n.get("Error"),b=e.I18n.get("Fail to load data."),l.alert(a,b,"error")})}})})(document,Granite.$,Granite.URITemplate,Granite);
(function(f,d){d(f).on("click",".foundation-collection-selectall",function(a){a=d(this.dataset.foundationCollectionSelectallTarget);var e=a.adaptTo("foundation-selections");a[0].dataset.foundationSelectionsSelectallMode=!0;e.selectAll()});d(f).on("foundation-selections-change",".foundation-collection",function(a){var e=d(this),c="single"===this.dataset.foundationSelectionsMode;d(".foundation-collection-selectall").each(function(a,d){e.is(d.dataset.foundationCollectionSelectallTarget)&&(a=e[0].tagName,
c?d.hidden=!0:e.find(".foundation-collection-item").length?"CORAL-MASONRY"!==a&&"TABLE"!==a||0!==e.find(".foundation-collection-item [coral-table-rowselect],.foundation-collection-item .foundation-collection-item-activator").length?(a=e.adaptTo("foundation-selections"),d.hidden=a.isAllSelected(),0===a.count()&&delete e[0].dataset.foundationSelectionsSelectallMode):d.hidden=!0:d.hidden=!0,e.find("[coral-table-select]").prop("hidden",d.hidden))})})})(document,Granite.$);
(function(f,d,a,e,c){function b(a,b,c,g,d,e,h){for(var f=c,k=null,l=null;0<=c&&c<b.length;c+=g){var q=b[c],n=a,m=q,t=e;if(!n._isItemAbove(n,m,d)&&!n._isItemBelow(n,m,t))f=c;else if(Math.abs(c-f)>h)break;q.classList.contains("is-lazyLoaded")&&(l=c,k=k||c)}return{first:k,last:l}}function h(a,b){var c=m(b).filter(".is-lazyLoaded,.is-pending").each(function(){this.classList.contains("is-lazyLoaded")&&(this.classList.add("is-pending"),this.classList.remove("is-lazyLoaded"))}).toArray(),d=Infinity,e=-1,
h=[];c.forEach(function(b){b=parseInt(b.dataset.datasourceIndex,10);-1!==e&&60<b-d&&(h.push(g(a,c,d,e)),d=Infinity,e=-1);e=e>b?e:b;d=d<b?d:b});-1!==e&&h.push(g(a,c,d,e));return m.when.apply(null,h).then(function(){var a=[];Array.prototype.forEach.call(arguments,function(b){b.forEach(function(b){a.push(b)})});return m.uniqueSort(a)})}function g(a,b,c,g){return a._load(a,{offset:c,limit:g-c+1}).then(function(a){var c=[];a.forEach(function(a){if(!a.classList.contains("is-lazyLoaded")){var g=a.dataset.graniteCollectionItemId,
d=b.find(function(a){return a.dataset.graniteCollectionItemId===g});d&&(m(d).removeClass("is-pending").replaceWith(a),c.push(a))}});return c})}function k(a,b,c,d){for(var e=Infinity,h=-1,f=[];c<=d;c++){var k=b[c];k.classList.contains("is-lazyLoaded")&&(k.classList.add("is-pending"),k.classList.remove("is-lazyLoaded"),f.push(k),k=parseInt(k.dataset.datasourceIndex,10),h=h>k?h:k,e=e<k?e:k)}g(a,f,e,h).then(function(){a._onReplace(a)})}function l(a){this.scrollSrc=a.scrollSrc;this._getItems=a.getItems;
this._load=a.load;this._onReplace=a.onReplace||m.noop;this._isItemAbove=a.isItemAbove||function(a,b,c){return b.offsetTop+b.offsetHeight<c};this._isItemBelow=a.isItemBelow||function(a,b,c){return b.offsetTop>c};this._setupListeners=a.setupListeners||m.noop;this._stack=[]}var m=e;l.prototype.start=function(){if(this._destroyed)throw Error("Illegal state: this class is already destroyed");var c=this,g=a.UI.Foundation.Utils.debounce(function(){if(d.body.contains(c.scrollSrc)){var a=c._getItems(c);if(0!==
m(a).filter(".is-lazyLoaded").length){var g=c.scrollSrc.scrollTop,e=g+c.scrollSrc.clientHeight;b:{var h=0;var f=a.length-1;for(var l=Math.floor((h+f)/2);h<f;l=Math.floor((h+f)/2)){var n=a[l],B=c,q=n,z=e;if(!B._isItemAbove(B,q,g)&&!B._isItemBelow(B,q,z)){f=l;break b}c._isItemAbove(c,n,g)?h=l:f=l}}h=b(c,a,f,-1,g,e,10);e=b(c,a,f,1,g,e,10);g=null!==h.last?h.last:e.first;e=null!==e.last?e.last:h.first;null!==g&&null!==e&&k(c,a,g,e)}}},200);this.scrollSrc.addEventListener("scroll",g);this._stack.push(function(){c.scrollSrc.removeEventListener("scroll",
g)});f.addEventListener("resize",g);this._stack.push(function(){f.removeEventListener("resize",g)});this._stack.push(this._setupListeners(this,g));g()};l.prototype.destroy=function(){this._destroyed=!0;a.UI.Foundation.Utils.everyReverse(this._stack,function(a){a();return!0})};l.prototype.loadItems=function(a){return h(this,a)};m(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection-lazyloader",selector:m(f),adapter:function(){return l}})})(window,document,Granite,
Granite.$,Granite.URITemplate);(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-toggleable",adapter:function(a){var e=d(a);return{isOpen:function(){return void 0===e.attr("hidden")},show:function(a){e.removeAttr("hidden");e.trigger("foundation-toggleable-show")},hide:function(){e.attr("hidden","");e.trigger("foundation-toggleable-hide")}}}})})(window,Granite.$);
(function(f,d){function a(a){var b=a.data("foundationToggleableControlSrc"),c=a.data("foundationToggleableControlTarget"),g="false"!==a.attr("data-foundation-toggleable-control-cache");if(b)return g&&e.has(b)?(a=e.get(b),a.appendTo(f.body),d.Deferred().resolve(a).promise()):d.ajax({url:b,cache:!1}).then(function(a){a=d(a).on("foundation-toggleable-hide",function(a){var b=d(a.target);requestAnimationFrame(function(){b.detach()})}).appendTo(f.body).trigger("foundation-contentloaded");e.set(b,a);return a});
a=c?d(c):a.closest(".foundation-toggleable");return d.Deferred().resolve(a).promise()}var e=new Map;d(f).on("click",".foundation-toggleable-control",function(c){c.preventDefault();var b=d(this);a(b).then(function(a){var c=a.adaptTo("foundation-toggleable"),e=b.data("foundationToggleableControlAction");requestAnimationFrame(function(){void 0===e&&(e=c.isOpen()?"hide":"show");var a=e,g=b.attr("data-foundation-tracking-event");g&&(g=JSON.parse(g),g.feature=g.feature||"",g.type="toggleable",g.action=
a,g.widget={name:g.element,type:"toggleable"},d(window).adaptTo("foundation-tracker").trackEvent(g));"show"===e?("hide"===b.data("foundationToggleableControlNesting")&&(a=b.closest(".foundation-toggleable").adaptTo("foundation-toggleable"))&&a.hide(),c.show(b[0])):"hide"===e&&c.hide()})})});d(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:".foundation-toggleable-control[data-foundation-tracking-event]",adapter:function(a){return{track:function(a){}}}})})(document,
Granite.$);(function(f,d){d(f).on("click",".foundation-mode-change",function(a){a.preventDefault();a=d(this);var e=a.data("foundationModeValue"),c=a.data("foundationModeGroup");a.trigger("foundation-mode-change",[e,c])})})(document,Granite.$);
(function(f,d){d(f).on("foundation-mode-change",function(a,e,c){d(".foundation-mode-switcher").each(function(){var a=d(this);a.data("foundationModeSwitcherGroup")===c&&a.children(".foundation-mode-switcher-item").each(function(){var a=d(this),b=a.data("foundationModeSwitcherItemMode");a.toggleClass("foundation-mode-switcher-item-active",b===e)})})})})(document,Granite.$);
(function(f,d,a){function e(b){b=h.normalize(b.toLowerCase());var c=k.get(b);if(c){var g;c=c.reduce(function(b,c){(g=a(c).adaptTo("foundation-command"))&&g.isActive()&&b.push(g);return b},[]);1===c.length?c[0].execute():1<c.length&&console.warn("Multiple shortcuts detected and ignored: "+b)}}function c(a){e(a.keys)}function b(b){a("[data-foundation-command]",b).each(function(b,d){if(b=a(d).adaptTo("foundation-command")){var e=h.normalize(b.getShortcut());if(e)if(-1!==g.indexOf(e))console.warn("Shortcut is a reserved and ignored: "+
b.getShortcut());else{var f=k.get(e),l=!0;"undefined"===typeof f?(k.set(e,[d]),Coral.keys.on(e,c)):-1===f.indexOf(d)?f.push(d):l=!1;l&&b.enhanceUI()}}})}f=a(f);var h=f.adaptTo("foundation-util-keyboard");f=f.adaptTo("foundation-preference");var g=["/","esc"],k=new Map;if(f.getBoolean("shortcutsEnabled",!0))a(d).on("foundation-contentloaded",function(a){k.forEach(function(a,b){for(var g=a.length-1;-1<g;g--)d.contains(a[g])||a.splice(g,1);0===a.length&&(k.delete(b),Coral.keys.off(b,c))});b(a.target)})})(window,
document,Granite.$);
(function(f,d,a){function e(a){c.prompt(Granite.I18n.get("Unsaved changes"),Granite.I18n.get("You have unsaved changes! Are you are sure you want to close the page?"),"warning",[{text:Granite.I18n.get("Cancel")},{text:Granite.I18n.get("Yes"),primary:!0,handler:function(){f.location=a.getAttribute("href")}}])}var c=a(f).adaptTo("foundation-ui");a(d).on("click",".foundation-anchor",function(a){a.preventDefault();a=this.dataset.foundationAnchorHref;var b=this.dataset.foundationAnchorTarget;b?f.open(a,
b):f.location=a});a(d).on("click",".foundation-backanchor",function(b){var c=this,g=c.dataset.foundationBackanchorForm;g?(g=a("#"+g).adaptTo("foundation-form"))&&g.isDirty()&&(b.preventDefault(),e(c)):a("form.foundation-form").each(function(){if(a(this).adaptTo("foundation-form").isDirty())return b.preventDefault(),e(c),!1})})})(window,document,Granite.$);
(function(f,d,a){function e(){if(!b&&(b=new Map,f===f.parent))try{for(var a=[],d=0,e=sessionStorage.length;d<e;d++){var h=sessionStorage.key(d);if(h&&h.startsWith("foundation-fixedanchor::")){var p=JSON.parse(sessionStorage.getItem(h));p.url===c&&b.set(p.id,p);a.push(h)}}a.forEach(function(a){sessionStorage.removeItem(a)})}catch(n){f.console&&console.warn("Error occur restoring foundation-fixedanchor state",n)}}var c=f.location.href,b,h=new WeakMap;a(d).on("foundation-contentloaded",function(g){e();
a(".foundation-fixedanchor",g.target).each(function(){var g=a(this);if(!h.has(this)){h.set(this,!0);var d=g.prop("id");if(d){var e=g[0].dataset.foundationFixedanchorAttr||"href";if(b.has(d)){var p=b.get(d);g.attr(e,p.href)}try{sessionStorage.setItem("foundation-fixedanchor::"+d,JSON.stringify({url:c,id:d,href:g.attr(e)}))}catch(n){f.console&&console.warn("Error occur saving foundation-fixedanchor state",n)}}}})})})(window,document,Granite.$);
(function(f,d){var a=d(f).adaptTo("foundation-registry");a.register("foundation.adapters",{type:"foundation-editable",selector:".foundation-editable",adapter:function(e){var c=d(e);return{edit:function(){var b;Granite.UI.Foundation.Utils.everyReverse(a.get("foundation.editable.editor"),function(a){if(!c.is(a.selector))return!0;b=a.handler.call(c[0],c[0]);return!1});if(b){var e=c.position(),g=d(document.createElement("div")).css({position:"absolute",top:e.top,left:e.left,width:c.css("width")});g.append(b.el);
g.insertAfter(c);b.renderCallback();c.on("foundation-editable-commit foundation-editable-cancel",function(a){g.remove()})}}}}})})(window,Granite.$);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.editable.editor",{selector:".foundation-editable[data-foundation-editable-editor\x3d'foundation.text']",handler:function(e){var c=d(e),b=d(new a.Textfield).css({display:"block",width:"100%"}),h=function(){c.text(b.val());c.trigger("foundation-editable-commit")};b.on("blur",function(a){h()}).on("keydown",function(a){13===a.which?(a.preventDefault(),h()):27===a.which&&(a.preventDefault(),c.trigger("foundation-editable-cancel"))});
b.val(c.text());return{el:b[0],renderCallback:function(){b.focus()}}}})})(window,Granite.$,Coral);(function(f,d){function a(a){a.adaptTo("foundation-editable").edit()}d(f).on("click",".foundation-editable-control",function(e){e.preventDefault();a(d(this))});d(f).on("keydown",".foundation-editable-control",function(e){13===e.which&&(e.preventDefault(),a(d(this)))})})(document,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-wizard",adapter:function(a){var e=d(a);return{toggleNext:function(a){this.toggle("next",a)},togglePrev:function(a){this.toggle("prev",a)},toggleCancel:function(a){this.toggle("cancel",a)},toggle:function(a,b){var c=e.adaptTo("foundation-layout");c&&"function"===typeof c.toggle?c.toggle(a,b):e.children(".foundation-wizard-step.foundation-wizard-step-active").find(".foundation-wizard-control[data-foundation-wizard-control-action\x3d"+
a+"]").each(function(){d(this).is("button")?d(this).prop("disabled",!b):d(this).toggleClass("disabled",!b)})},next:function(){var a=e.adaptTo("foundation-layout");if(a&&"function"===typeof a.next)a.next();else{a=e.children(".foundation-wizard-step-active");var b=a.nextAll(".foundation-wizard-step").first();b.length&&(a.removeClass("foundation-wizard-step-active"),b.addClass("foundation-wizard-step-active"),e.trigger("foundation-wizard-stepchange",[b[0],a[0]]))}},prev:function(){var a=e.adaptTo("foundation-layout");
if(a&&"function"===typeof a.prev)a.prev();else{a=e.children(".foundation-wizard-step-active");var b=a.prevAll(".foundation-wizard-step").first();b.length&&(a.removeClass("foundation-wizard-step-active"),b.addClass("foundation-wizard-step-active"),e.trigger("foundation-wizard-stepchange",[b[0],a[0]]))}},append:function(a,b){var c=e.adaptTo("foundation-layout");c&&"function"===typeof c.append?c.append(a,b):void 0===b?e.append(a):(e.children(".foundation-wizard-step").eq(b).after(a),e.trigger("foundation-contentloaded"))},
appendAfter:function(a,b){var c=e.adaptTo("foundation-layout");c&&"function"===typeof c.appendAfter?c.appendAfter(a,b):(d(b).after(a),e.trigger("foundation-contentloaded"))},remove:function(a){var b=e.adaptTo("foundation-layout");b&&"function"===typeof b.remove?b.remove(a):d(a).remove()},getPrevSteps:function(a){var b=e.adaptTo("foundation-layout");return b&&"function"===typeof b.getPrevSteps?b.getPrevSteps(a):d(a).prevAll(".foundation-wizard-step").toArray()}}}})})(window,Granite.$);
(function(f,d){function a(a,b){a.closest(".foundation-wizard").adaptTo("foundation-wizard").toggleNext(b)}function e(c){var b=c.adaptTo("foundation-validation-helper").isValid();c.data("foundation-wizard-step.internal.valid",b);a(c,b)}d(f).on("foundation-validation-invalid",".foundation-wizard-step",function(c){var b=d(this);if(!1!==b.data("foundationWizardStepValidation")){a(b,!1);c=c.target;var e=b.data("foundation-wizard.internal.invalids");void 0===e&&(e=[],b.data("foundation-wizard.internal.invalids",
e));0>e.indexOf(c)&&e.push(c)}});d(f).on("foundation-validation-valid",".foundation-wizard-step",function(a){var b=d(this);if(!1!==b.data("foundationWizardStepValidation")){var c=b.data("foundation-wizard.internal.invalids");if(c)if(a=c.indexOf(a.target),0<=a&&c.splice(a,1),0===c.length)e(b);else{a=!1;for(var g=c.length;g--;){if(b.has(c[g]).length){a=!0;break}c.splice(g,1)}a||e(b)}else e(b)}})})(document,Granite.$);
(function(f,d,a){function e(a){var b={};a.find(":input").each(function(){var a=d(this);a.serializeArray().forEach(function(c){var g=c.name;c=c.value;if(b.hasOwnProperty(g)){var d=b[g];Array.isArray(d)||(d=[d]);d.push(c);c=d}b[g]=c;(c=a[0].dataset.foundationUritemplateParent)&&((b[c]=b[c]||{})[g]=b[g])})});return b}d(f).on("foundation-wizard-stepchange",function(c,b,f){var g=d(b);if(g.hasClass("foundation-wizard-lazycontainer")){var h=b.dataset.foundationWizardLazycontainerSrc;if(h&&(c=d(c.target).adaptTo("foundation-wizard"),
b=d(c.getPrevSteps(b)),!b.length||!f||b.is(f))&&(f=e(b),h=a.expand(h,f),g.data("foundation-wizard-lazycontainer.internal.lastURL")!==h)){g.data("foundation-wizard-lazycontainer.internal.lastURL",h);var l=d(window).adaptTo("foundation-ui");l.wait();d.ajax({url:h,cache:!1}).done(function(a){d(window).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){l.clearWait();g.html("").append(a);g.trigger("foundation-contentloaded");g.adaptTo("foundation-validation-helper").getSubmittables().every(function(a){a=
d(a).adaptTo("foundation-validation");return a.getValidity().isValidated()?!0:a.checkValidity()})})}).fail(function(){l.clearWait();var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Something went wrong.");l.alert(a,b,"error")})}}})})(document,Granite.$,Granite.URITemplate);
(function(f,d,a,e){function c(a,b){return b.done(function(){t.delete(a[0])}).done(h(a)).fail(g(a)).done(function(){a.trigger("foundation-form-submitted",[!0,b])}).fail(function(){a.trigger("foundation-form-submitted",[!1,b])})}function b(b,c){a.when.apply(null,c).done(function(){t.delete(b[0])}).done(function(){var a=b.data("foundationFormResponseUiSuccess")||b.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");if(!a){var c=b.data("foundationFormOutputReplace"),
g=!1;c?g=!0:c=b.data("foundationFormOutputPush");if(!c)return;a={name:"foundation.content",redirect:b.data("foundationFormRedirect"),history:b.data("foundationFormHistory"),target:c,replace:g}}v(u.get("foundation.form.response.ui.success"),function(c){return c.name!==a.name?!0:!1===c.handler.call(b[0],b[0],a)})}).fail(g(b)).done(function(){}).fail(function(){})}function h(b){return function(c,g,e){var f=b.data("foundationFormResponseUiSuccess")||b.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");
if(!f){var h=b.data("foundationFormOutputReplace"),q=!1;h?q=!0:h=b.data("foundationFormOutputPush");if(!h)return;f={name:"foundation.content",redirect:b.data("foundationFormRedirect"),history:b.data("foundationFormHistory"),target:h,replace:q}}var l=a(d).adaptTo("foundation-response-parser").parse(e),n=k(b,e,l)||c;v(u.get("foundation.form.response.ui.success"),function(a){return a.name!==f.name?!0:!1===a.handler.call(b[0],b[0],f,n,g,e,l)})}}function g(b){return function(c,g,e){if("none"!==b.data("foundationFormUi")){var f=
a(d).adaptTo("foundation-response-parser").parse(c),h=k(b,c,f);v(u.get("foundation.form.response.ui.error"),function(a){return!1===a.handler.call(b[0],b[0],h,c,g,e)})}}}function k(a,b,c){var g=b.getResponseHeader("content-type");if(!g)return b.responseText;var d;v(u.get("foundation.form.response.parser"),function(e){if(!a.is(e.selector)||!g.match(e.contentType))return!0;e=e.handler.call(a[0],a[0],b,c);if(!1===e)return!0;d=e;return!1});return d}function l(b){if(!0===b.data("foundationFormLoadingmask")){var c=
a(),g=b.data("foundationFormOutputReplace")||b.data("foundationFormOutputPush");g&&(c=a(g));g=w;g.show(b[0],c[0]);b.data("foundation-form.internal.currentLoadingMask",{target:c[0],impl:g})}}function m(b,c){b.each(function(){var b=a(this).adaptTo("foundation-field");b&&b.setDisabled(c)})}function p(a){return a.reduce(function(a,b){return b.post?a.concat(b.post()):a},[])}function n(a){if(a.data("foundationFormActions")){var g=a.attr("action"),d=[];a.data("foundationFormActions").split(" ").forEach(function(b){a.prop("action",
b);b=a.adaptTo("foundation-form").submitAsync();b.always(function(){a.attr("action",g)});d.push(b)});return function(){b(a,d)}}var e=a.adaptTo("foundation-form").submitAsync();return function(){return c(a,e)}}function x(b){l(b);var c=[];u.get("foundation.form.submit").forEach(function(a){b.is(a.selector)&&c.push(a.handler.call(b[0],b[0]))});var g=c.reduce(function(a,b){return b.preResult?a.concat(b.preResult):a},[]);return a.when.apply(null,g).then(function(){var g=n(b);return a.when.apply(null,p(c)).then(g,
g)}).always(function(){var a=b.data("foundation-form.internal.currentLoadingMask");a&&(a.impl.hide(b[0],a.target),b.removeData("foundation-form.internal.currentLoadingMask"))})}var v=e.UI.Foundation.Utils.everyReverse,u=a(d).adaptTo("foundation-registry"),y=a(d).adaptTo("foundation-ui"),t=new WeakMap,w={show:function(a,b){y.wait(b)},hide:function(a,b){y.clearWait()}};a(f).on("foundation-form-submit-callback","form.foundation-form",function(b,g){c(a(this),g)});a(f).on("reset","form.foundation-form",
function(b){a(this).adaptTo("foundation-form").reset(!0)});a(f).on("foundation-field-change","form.foundation-form",function(a){t.set(this,!0)});var r=new WeakMap;a(f).on("submit","form.foundation-form",function(b){var c=a(this);if(c.data("foundationFormAjax")&&(b.preventDefault(),!c.data("foundationFormDisable"))){r.has(c[0])||r.set(c[0],[]);var g=r.get(c[0]);g.push(function(){x(c).always(function(){g.shift();if(g.length)g[0]()})});if(1===g.length)g[0]()}});u.register("foundation.adapters",{type:"foundation-form",
selector:"form.foundation-form",adapter:function(b){var c=a(b),g=function(a){(a=a.adaptTo("foundation-field"))&&a.reset&&a.reset()};return{submitAsync:function(){var b=c.attr("enctype"),g=c.attr("method")||"get",d=c.attr("action");if("post"===g.toLowerCase()&&"multipart/form-data"===b){var e=new FormData(c[0]);return a.ajax({method:g,url:d,contentType:!1,mimeType:b,processData:!1,data:e})}return a.ajax({method:g,url:d,contentType:b,data:c.serialize(),cache:!1})},reset:function(d){d||b.reset();c.find(".foundation-field-editable").each(function(){var b=
a(this);g(b.find(".foundation-field-readonly"));g(b.find(".foundation-field-edit"))})},isDirty:function(){return!0===t.get(b)}}}});u.register("foundation.form.submit",{selector:"*",handler:function(b){var c=a(b).find(".foundation-field-mixed");m(c,!0);return{post:function(){m(c,!1)}}}})})(document,window,Granite.$,Granite);
(function(f,d,a){a(d).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.sling",selector:"*",contentType:/text\/html/,handler:function(d,c,b){d=a(b);return d.find("#Status").length?Array.prototype.reduce.call(d.find("[id]"),function(a,b){a[b.id]=b.href?b.href:b.textContent;return a},{}):!1}})})(document,window,Granite.$);
(function(f,d,a){a(d).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.form",selector:"*",contentType:/text\/html/,handler:function(d,c,b){d=a(b);return(c=d.find(".foundation-form-response-status-code").next().text())?{statusCode:c,message:d.find(".foundation-form-response-status-message").next().text(),redirect:d.find(".foundation-form-response-redirect").attr("href"),path:d.find(".foundation-form-response-path").next().text(),title:d.find(".foundation-form-response-title").next().text(),
description:d.find(".foundation-form-response-description").next().html()}:!1}})})(document,window,Granite.$);(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.default",handler:function(a,e,c,b,h){a=b||Granite.I18n.get("Error");h=h||Granite.I18n.get("Fail to submit the form.");d(f).adaptTo("foundation-ui").alert(a,h,"error")}})})(window,Granite.$);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.sling",handler:function(e,c,b,h,g){if(!c||!c.Status)return!1;e=a.I18n.get("Error");c=c.Message;d(f).adaptTo("foundation-ui").alert(e,c,"error")}})})(window,Granite.$,Granite);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.html",handler:function(a,e,c,b,h){if(!e||!e.statusCode)return!1;a=e.title||Granite.I18n.get("Error");e=e.description||e.message;d(f).adaptTo("foundation-ui").alert(a,e,"error")}})})(window,Granite.$);
(function(f,d){function a(a,c,b){var e=d(c.target),g=e.adaptTo("foundation-content");if(g){if(c.history){if(c.history.url||c.history.useFormUrl){e=a.attr("action");a=a.serialize();var f=0<=e.lastIndexOf("?")?"\x26":"?";a=e+f+a}else a=void 0;f={data:c.history.data,title:c.history.title,url:a}}c.replace?g.replace(b,f):g.push(b,f)}else e.html(b)}d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.content",handler:function(e,c,b,f,g){if(c.target){var h=
d(e);c.redirect?d.ajax({url:c.redirect,cache:!1}).done(function(b){a(h,c,b)}):a(h,c,b)}}})})(window,Granite.$);
(function(f,d,a){function e(a,b){a&&"/"===a[0]&&(b?f.open(a):f.location=a)}d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.prompt.open",handler:function(c,b,h,g,k){d(f).adaptTo("foundation-ui").prompt(b.title,b.message,"success",[{text:Granite.I18n.get("Done"),handler:function(){e(a.expand(b.redirect,h))}},{text:Granite.I18n.get("Open"),primary:!0,handler:function(){e(a.expand(b.open,h),!0);e(a.expand(b.redirect,h))}}])}})})(window,Granite.$,Granite.URITemplate);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.redirect",handler:function(d,c,b,h,g){d=a.expand(c.href,b);c="//"+document.location.host;b=document.location.protocol+c;d!==b&&d.slice(0,b.length+1)!==b+"/"&&d!==c&&d.slice(0,c.length+1)!==c+"/"&&/^(\/\/|http:|https:).*/.test(d)||(f.location=d)}})})(window,Granite.$,Granite.URITemplate);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.reload",handler:function(e,c,b,h,g){d(f).adaptTo("foundation-util-messenger").put(null,c.message||a.I18n.get("The form has been submitted successfully"),"success");f.location.reload()}})})(window,Granite.$,Granite);
(function(f,d,a){d(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.collection.reload",handler:function(e,c,b,h,g){d(f).adaptTo("foundation-util-messenger").put(null,c.message||a.I18n.get("The form has been submitted successfully"),"success");d(c.target).adaptTo("foundation-collection").reload()}})})(window,Granite.$,Granite);
(function(f,d){d(f).on("foundation-field-change",".foundation-field-autosubmit",function(a){a=d(this).closest("form");if(a.length){var e=f.createEvent("Event");e.initEvent("submit",!0,!0);a[0].dispatchEvent(e)}})})(document,Granite.$);
(function(f,d,a,e,c){function b(a){var b=[a],c=0;return{current:function(){return this.peek(0)},peek:function(a){return b[c+a]},pointToToken:function(a){for(var g=0,d=b.length;g<d;g++){var e=b[g];if(e.token===a)return c=g,e}},forward:function(){if(c<b.length-1)return b[++c]},back:function(){if(0<c)return b[--c]},push:function(a){b.splice(++c,b.length-c,a)}}}function h(a){return(a=a.querySelector("title"))?a.textContent:null}var g=Date.now().toString();e(function(a){e(".foundation-content").length&&
(a=c.getState(),a.data.foundationContent={token:g},c.replaceState(a.data),e(f).on("statechange",function(a){if(a=c.getState().data.foundationContent){var b=e(".foundation-content");b.length&&b.adaptTo("foundation-content").goToToken(a.token)}}))});e(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-content",selector:".foundation-content",adapter:function(a){var k=e(a),m=b({token:g,el:k.children(".foundation-content-current")}),p=function(a){return a.children(".foundation-content-current").removeClass("foundation-content-current").detach()},
n;return{pushState:function(a,b,c){return this.go(c,!1,{data:a,title:b,url:c})},replaceState:function(a,b,c){return this.go(c,!0,{data:a,title:b,url:c})},go:function(a,b,c){var g=this;n&&"pending"===n.state()&&n.abort();var d=e.ajax(a,{cache:!1});n=d;return d.then(function(a){return b?g.replace(a,c):g.push(a,c)}).fail(function(){k.trigger("foundation-content-loaded",[!1,b,d])})},goToToken:function(a){(a=m.pointToToken(a))&&!a.el.is(".foundation-content-current")&&(e(f).adaptTo("foundation-util-htmlparser").parse(a.el[0]),
p(k),a.el.addClass("foundation-content-current").appendTo(k))},refresh:function(){return this.go(d.location.toString(),!0)},push:function(a,b){var g=Date.now().toString(),n=e(".foundation-content-path").attr("data-foundation-content-path"),l=e(f).adaptTo("foundation-util-htmlparser"),w=l.createFragment(a);a=l.parse(w);var r=e(w.querySelector(".foundation-content-current"));r.length||(r=e(d.createElement("div")).addClass("foundation-content-current").append(w));m.push({token:g,el:r});a.then(function(){p(k);
k.append(r);0===e(".foundation-content-path").length&&e(d.createElement("div")).prop("hidden",!0).attr("data-foundation-content-path",n).prependTo(r);r.trigger("foundation-contentloaded");if(b){var a=b.data||{};a.foundationContent={token:g};c.pushState(a,b.title||h(w),b.url)}k.trigger("foundation-content-loaded",[!0,!1])});return g},replace:function(a,b){var g=m.current(),d=e(f).adaptTo("foundation-util-htmlparser");a=d.createFragment(a);d.parse(a).then(function(a){var d=e(a.querySelector(".foundation-content-current"));
d.length||(d=e(a).children());d.is(".foundation-content-current")?(k.children(".foundation-content-current").remove(),d.appendTo(k).trigger("foundation-contentloaded")):k.children(".foundation-content-current").empty().append(d).trigger("foundation-contentloaded");b&&(d=b.data||{},d.foundationContent={token:g.token},c.replaceState(d,b.title||h(a),b.url));k.trigger("foundation-content-loaded",[!0,!0])});return g.token},back:function(a){if(c.getState().data.foundationContent){if(a){var b=this;e(f).one("statechange",
function(){b.refresh()})}var g=m.peek(-1);c.back();return g?g.token:void 0}if(g=m.back())return e(f).adaptTo("foundation-util-htmlparser").parse(g.el[0]),p(k),g.el.addClass("foundation-content-current").appendTo(k),a&&this.refresh(),(a=e(".foundation-collection",k).data("cardView"))&&a.layout&&a.layout(),g.token},forward:function(a){if(c.getState().data.foundationContent){if(a){var b=this;e(f).one("statechange",function(){b.refresh()})}a=m.peek(1);c.forward();return a?a.token:void 0}var g=m.forward();
if(g)return e(f).adaptTo("foundation-util-htmlparser").parse(g.el[0]),p(k),g.el.addClass("foundation-content-current").appendTo(k),a&&this.refresh(),g.token}}}})})(window,document,Granite,Granite.$,History);
(function(f,d){d(f).on("click",".foundation-content-control",function(a){a.preventDefault();var e=d(this);a=e.data("foundationContentControlAction");var c=e.data("foundationContentControlRefresh");e=e.closest(".foundation-content").adaptTo("foundation-content");"back"===a?e.back(c):"forward"===a&&e.forward(c)})})(document,Granite.$);
(function(f,d){function a(a,c,b,d){var g;(g=a.data(c+"-"+b))||(g=(a=a.data(c))?d&&"object"!==typeof a?a:a[b]:void 0);return g}d(f).on("click","a[data-foundation-content-history]",function(e){e.preventDefault();var c=d(this);var b=d(".foundation-content");if(b.length){var f=a(c,"foundation-content-history","action",!0);e=a(c,"foundation-content-history","title");var g=c.prop("href");f=void 0!==f?"replace"===f:!!a(c,"foundation-content-history","replace");c=a(c,"foundation-content-history","data");
b=b.adaptTo("foundation-content");f?b.replaceState(c,e,g):b.pushState(c,e,g)}})})(document,Granite.$);(function(f,d,a){a(d).on("click",".foundation-history-control",function(d){d.preventDefault();d=a(this).data("foundationHistoryControlAction");"back"===d?f.history.back():"forward"===d&&f.history.forward()})})(window,document,Granite.$);
(function(f,d,a,e){function c(a,b){a.id||(a.id=b+":"+Date.now());return a.id}function b(a,b){return a.substring(0,b.length)===b}a(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-overlay.foundation-picker-buttonlist",adapter:function(h){var g=a(h),k=null,l=null,m=null,p=null,n=!1,x=a(d.createElement("div")).addClass("foundation-picker-buttonlist-loader").attr("role","progressbar").append((new Coral.Wait).set({centered:!0})),v=new (a(f).adaptTo("foundation-util-paginator"))({el:h,
limit:h.dataset.foundationPickerButtonlistLimit||10,resolveURL:function(a){return e.expand(h.dataset.foundationPickerButtonlistSrc,{offset:a.offset,limit:a.limit,query:p})},wait:function(a){g.append(x);return{clear:function(){x.remove()}}},processResponse:function(c,d){var e=a.Deferred();a(f).adaptTo("foundation-util-htmlparser").parse(d).then(function(d){d=a(d).children();if(d.is("coral-buttonlist")){var f=d.children("button");f.attr("tabindex",-1);var h=g.children("coral-buttonlist");h.append(f);
if(0===c.offset&&(h=h.children("button").first(),h.length)){var k=h.val();0<p.length&&!n&&b(k,p)&&(a(l).is("foundation-autocomplete")&&(l.field.value=k,l.field.setSelectionRange(p.length,k.length)),h.siblings(".is-focused").removeClass("is-focused"),h.addClass("is-focused"))}var m=d[0].dataset.foundationPickerButtonlistHasnext;m="true"===m?!0:"false"===m?!1:f.length>=c.limit;requestAnimationFrame(function(){e.resolve({length:f.length,hasNext:m})})}});return e.promise()}}),u=function(a,b){var c={},
g;for(g in a.dataset)if(a.dataset.hasOwnProperty(g)&&!(g.length<=b.length)&&g.startsWith(b)){var d=g.charAt(b.length);d===d.toUpperCase()&&(d=g.substr(b.length),c[d.toLowerCase()]=a.dataset[g])}return c};v.start();h.tabIndex=-1;h.placement="bottom";h.collision="flip";g.on("coral-overlay:open",function(a){if(a.target===h&&l){h.scrollTop=0;"combobox"===l.getAttribute("role")&&l.setAttribute("aria-expanded","true");var b=l;a=h.getBoundingClientRect();b=b.getBoundingClientRect();a.top<b.top?g.addClass("is-above"):
g.removeClass("is-above")}});g.on("coral-overlay:close",function(a){a.target===h&&(g.find("\x3e coral-buttonlist \x3e button.is-focused").removeClass("is-focused"),"combobox"===l.getAttribute("role")&&(l.removeAttribute("aria-activedescendant"),l.setAttribute("aria-expanded","false")),m=l=k=null)});g.on("mouseover","coral-buttonlist \x3e button",function(b){b=a(this);b.siblings(".is-focused").removeClass("is-focused");b.addClass("is-focused")});g.on("click","coral-buttonlist \x3e button",function(a){a=
[{value:this.value,text:this.getAttribute("foundation-picker-buttonlist-text")||this.content.textContent,data:u(this,"foundationPickerButtonlistCustom")}];k.resolve(a);h.open=!1});a(d).on("click",function(a){h.open&&l&&!l.contains(a.target)&&(m&&m(p),k.reject(),h.open=!1)});return{attach:function(a){g.appendTo(a);g.trigger("foundation-contentloaded")},detach:function(){g.detach()},pick:function(d,e,f,r){e=f===p;n=p&&f.length<p.length&&b(p,f);k=a.Deferred();l=d;p=f;m=r;(f="combobox"===l.getAttribute("role"))&&
l.field.setAttribute("aria-autocomplete","both");e||(r=g.children("coral-buttonlist"),r.length?r.children("button").remove():(r=(new Coral.ButtonList).set({interaction:"off"}),g.append(r),f&&l.setAttribute("aria-owns",c(r,"foundation-picker-buttonlist"))),v.restart(void 0,void 0,!0));h.open||(d=(f=a(d).adaptTo("foundation-overlay-anchor"))?f.getElement():d,g.outerWidth(a(d).outerWidth()),h.target=d,h.focusOnShow="off",h.open=!0);return k.promise()},cancel:function(){m&&m(p);h.open=!1},resolve:function(b){var c=
a.Deferred();b=b.map(function(a){var b=g.find("\x3e coral-buttonlist \x3e button").filter(function(){return this.value===a}).first();return b.length?{value:b[0].value,text:b[0].getAttribute("foundation-picker-buttonlist-text")||b[0].content.textContent,data:u(b[0],"foundationPickerButtonlistCustom")}:null});c.resolve(b);return c.promise()},focus:function(a){if(m){var b=g.children("coral-buttonlist"),d=b.children(".is-focused"),e=function(a){if(a){a.classList.add("is-focused");var b=a.getBoundingClientRect(),
g=h.getBoundingClientRect();b.top<g.top?a.scrollIntoView():b.top+b.height>g.bottom&&a.scrollIntoView(!1);c(a,"foundation-picker-buttonlist");l.setAttribute("aria-activedescendant",a.id);m(a.value)}};a?d.length?(d.removeClass("is-focused"),a=d.prev("button"),a.length?e(a[0]):m&&m(p)):e(b.children("button:last-of-type")[0]):d.length?(d.removeClass("is-focused"),a=d.next("button"),a.length?e(a[0]):m&&m(p)):e(b.children("button:first-of-type")[0])}}}}})})(window,document,Granite.$,Granite.URITemplate);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-collection, coral-dialog.foundation-picker-collection",adapter:function(a){var e=d(a),c=null;e.on("coral-overlay:open",function(b){b.target===a&&(b.target.target=null)});e.on("coral-overlay:close",function(b){b.target===a&&c&&c.reject()});e.on("click",".granite-pickerdialog-submit",function(b){b.preventDefault();b=e.find(".foundation-collection .foundation-selections-item").toArray().map(function(a){return{value:a.dataset.foundationPickerCollectionItemValue||
a.dataset.foundationCollectionItemId,text:a.dataset.foundationPickerCollectionItemText||d(a).find(".foundation-collection-item-title").text()}});var f=c;c=null;a.open=!1;f.resolve(b)});e.on("foundation-selections-change",".foundation-collection",function(a){a=d(this).adaptTo("foundation-selections");e.find(".granite-pickerdialog-submit").prop("disabled",0===a.count())});return{attach:function(a){e.is("coral-dialog")?e.appendTo(document.body):e.appendTo(a);e.trigger("foundation-contentloaded")},detach:function(){e.detach()},
pick:function(b){c=d.Deferred();requestAnimationFrame(function(){var c=e.find(".foundation-collection").adaptTo("foundation-selections");c&&c.clear();a.target=b;a.open=!0});return c.promise()},cancel:function(){c=null;a.open=!1}}}})})(window,Granite.$);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-form, coral-dialog.foundation-picker-form",adapter:function(a){var e=d(a),c=e.adaptTo("foundation-picker-form"),b=null;e.on("coral-overlay:open",function(b){b.target===a&&(b.target.target=null)});e.on("coral-overlay:close",function(c){c.target===a&&b&&b.reject()});e.on("submit",a.dataset.foundationPickerFormTarget||"form",function(d){d.preventDefault();
d=b;b=null;a.open=!1;d.resolve(c.getSelections())});return{attach:function(a){e.is("coral-dialog")?e.appendTo(document.body):e.appendTo(a);e.trigger("foundation-contentloaded")},detach:function(){e.detach()},pick:function(e,g,f){b=d.Deferred();requestAnimationFrame(function(){c.setup(e,g,f).then(function(){a.target=e;a.open=!0})});return b.promise()},cancel:function(){b=null;a.open=!1}}}})})(window,Granite.$);
(function(f,d,a,e){function c(a,b,c){var g=a.data("foundationPickerControlAction");e.UI.Foundation.Utils.everyReverse(k.get("foundation.picker.control.action"),function(b){return b.name!==g.name?!0:!1===b.handler.call(a[0],b.name,a[0],g,c)})}function b(a,b){b.api.attach(this);b.api.pick(a[0],[]).then(function(g){b.api.detach();b.open=!1;c(a,b,g)},function(){h(a,b)});"focus"in b.api?b.api.focus():b.el.focus();b.open=!0}function h(a,b){b.api.detach();b.open=!1}function g(a){var b=a.data("foundation-picker-control.internal.state");
b||(b={el:null,open:!1,loading:!1},a.data("foundation-picker-control.internal.state",b));return b}var k=a(f).adaptTo("foundation-registry");a(d).on("click",".foundation-picker-control",function(c){c.preventDefault();var d=a(this),e=g(d);if(!e.loading)if(e.el)e.open?(e.api.cancel(),h(d,e)):b(d,e);else if(c=d[0].dataset.foundationPickerControlSrc)e.loading=!0,a.ajax({url:c,cache:!1}).then(function(b){return a(f).adaptTo("foundation-util-htmlparser").parse(b)}).then(function(b){return a(b).children()[0]}).then(function(c){e.loading=
!1;e.el=c;e.api=a(c).adaptTo("foundation-picker");b(d,e)},function(){e.loading=!1})})})(window,document,Granite.$,Granite);
(function(f,d,a){d.UI.Foundation.Layouts=d.UI.Foundation.Layouts||function(){var d=a(window).adaptTo("foundation-registry"),c=function(a){return d.get("foundation.layouts").find(function(b){return b.name===a})};return{register:function(a,c,g){d.register("foundation.layouts",{name:a,doLayout:c,clean:g})},layout:function(b){var d=a(b),g=d.data("foundationLayout"),e=c(g.name);e&&(g.stateId&&a.cookie(g.stateId+".layoutId",g.layoutId,{expires:7,path:"/"}),e.doLayout(b,g),d.trigger("foundation-layout-perform"))},
switchLayout:function(b,d){var g=a(b),e=g.data("foundationLayout");e&&e.name===d.name||(e&&(c(e.name).clean||this.clean)(b,e),g.addClass(d.name),g.data("foundationLayout",d),this.layout(b))},clean:function(b){b=a(b);var c=b.data("foundationLayout");b.removeClass(c.name);b.data("foundationLayout",null);c.stateId&&a.removeCookie(c.stateId+".layoutId",{path:"/"})},cleanAll:function(b){var d=a(b).data("foundationLayout");d&&(c(d.name).clean||this.clean)(b,d)}}}();a(f).on("foundation-contentloaded",function(e){a(e.target).filter("[data-foundation-layout]").add(a("[data-foundation-layout]",
e.target)).each(function(){d.UI.Foundation.Layouts.layout(this)})})})(document,Granite,Granite.$);
(function(f,d,a){a(f).on("click",".foundation-layout-control",function(e){var c=a(this),b=c.data("foundationLayoutControl");if("switch"===b.action){var f=b.target?a(b.target):c.closest("[data-foundation-layout]");d.UI.Foundation.Layouts.switchLayout(f[0],b.config);a(".foundation-layout-control").each(function(){var g=a(this);if(!g.is(c)){var d=g.data("foundationLayoutControl");"switch"===d.action&&b.config.name===d.config.name&&(d.target?f.is(d.target):f.is(g.closest("[data-foundation-layout]")))&&
(g.parent(".coral-CycleButton").length?(g.addClass("is-active"),g.siblings(".foundation-layout-control").removeClass("is-active")):g.parent("coral-cyclebutton").length&&g.prop("selected",!0))}})}})})(document,Granite,Granite.$);
(function(f,d,a){function e(a){var b=a?f.localStorage:f.sessionStorage;return{get:function(a){return JSON.parse(b.getItem(a))},set:function(a,c){b.setItem(a,JSON.stringify(c))},remove:function(a){b.removeItem(a)}}}d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-clipboard",selector:d(f),adapter:function(a){var b=d(a),c=e();return{get:function(a){return c.get(a)},set:function(a,d){c.set(a,d);b.trigger("foundation-clipboard-change",{key:a,data:d,timestamp:(new Date).getTime()})},
remove:function(a){c.remove(a);b.trigger("foundation-clipboard-change",{key:a,data:null,timestamp:(new Date).getTime()})}}}})})(window,Granite.$);
(function(f,d,a,e){var c=function(){var a=[];return{register:function(b,c){a.push({varname:b,provider:c})},expandURITemplate:function(b){if(!b)return b;var c=a.reduce(function(a,b){a[b.varname]=b.provider(b.varname);return a},{});return e.expand(b,c)},resolveVar:function(b){var c=a.find(function(a){return a.varname===b});return c?c.provider(b):void 0}}}();c.register("window.location",function(){return f.location.href});a(d).on("click","a.foundation-setter",function(a){a.preventDefault();f.location=
c.expandURITemplate(this.href)});a(d).on("foundation-contentloaded",function(b){a("input.foundation-setter",b.target).each(function(){this.value=c.resolveVar(a(this).data("foundationSetterVar"))})})})(window,document,Granite.$,Granite.URITemplate);
(function(f,d,a){f=a(f);var e=f.adaptTo("foundation-util-keyboard");f.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:"button[data-foundation-command],a[data-foundation-command]",adapter:function(c){var b=a(c),f;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var a=c.textContent.trim();c.dataset.foundationCommandLabel=a}f||(a=e.normalize(this.getShortcut()),f=d.createElement("span"),f.classList.add("granite-command-inline"),f.textContent=
"("+a+")",c.label?c.label.appendChild(f):c.appendChild(f))},execute:function(){b.click()},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return b.is(":visible")}}}})})(window,document,Granite.$);
(function(f,d,a,e){function c(){b||(b=e.I18n.get("Please fill out this field."));return b}var b;d.addEventListener("invalid",function(b){b.isJqueryValidator||(b.preventDefault(),b=a(b.target).closest(":-foundation-submittable").adaptTo("foundation-validation"),b.checkValidity(),b.updateUI())},!0);f=a(f).adaptTo("foundation-registry");f.register("foundation.validation.selector",{submittable:"input, textarea, select, button, object",candidate:"input:not([readonly]):not([disabled]):not([type\x3dhidden]):not([type\x3dreset]):not([type\x3dbutton]), select:not([disabled]), textarea:not([readonly]):not([disabled]), button:not([disabled]):not([type\x3dreset]):not([type\x3dbutton])"});
f.register("foundation.validation.selector",{submittable:"[role\x3dcheckbox], [role\x3dradio], [role\x3dcombobox], [role\x3dlistbox], [role\x3dradiogroup], [role\x3dtree], [role\x3dslider], [role\x3dspinbutton], [role\x3dtextbox]",candidate:"[role\x3dcheckbox]:not([aria-disabled\x3dtrue]), [role\x3dradio]:not([aria-disabled\x3dtrue]), [role\x3dcombobox]:not([aria-disabled\x3dtrue]), [role\x3dlistbox]:not([aria-disabled\x3dtrue]), [role\x3dradiogroup]:not([aria-disabled\x3dtrue]), [role\x3dtree]:not([aria-disabled\x3dtrue]), [role\x3dslider]:not([aria-disabled\x3dtrue]), [role\x3dspinbutton]:not([aria-disabled\x3dtrue]), [role\x3dtextbox]:not([aria-disabled\x3dtrue]):not([aria-readonly\x3dtrue])"});
f.register("foundation.validation.validator",{selector:"input, textarea, select",validate:function(b){var d=a(b);if((!0===b.required||void 0===b.required&&void 0!==d.attr("required")||"true"===d.attr("aria-required"))&&!(d.is("[type\x3dcheckbox], [type\x3dradio]")?b.checked:0<b.value.length))return c()}});var h=function(){var b=a(this).adaptTo("foundation-validation");b&&(b.checkValidity(),b.updateUI())};a(d).on("change","input, textarea",h);a(d).on("input","input, textarea",e.UI.Foundation.Utils.debounce(h,
500));f.register("foundation.validation.validator",{selector:"[role\x3dlistbox]",validate:function(b){b=a(b);if("true"===b.attr("aria-required")){var d=!1;b.find("[role\x3doption]").each(function(){if("true"===a(this).attr("aria-selected"))return d=!0,!1});if(!d)return c()}}})})(window,document,Granite.$,Granite);
(function(f,d){d(f).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field",selector:"input, textarea, select",adapter:function(a){return{getName:function(){return a.name},setName:function(d){a.name=d},isDisabled:function(){return a.disabled},setDisabled:function(d){a.disabled=d},isInvalid:function(){return"true"===a.getAttribute("aria-invalid")},setInvalid:function(d){a.setAttribute("aria-invalid",d?"true":"false")},isRequired:function(){return"true"===a.getAttribute("aria-required")},
setRequired:function(d){a.setAttribute("aria-required",d?"true":"false")},getValue:function(){return"checkbox"===a.type||"radio"===a.type?a.checked?a.value:null:a.value},setValue:function(d){"checkbox"===a.type||"radio"===a.type?a.checked=a.value===d:a.value=d},getLabelledBy:function(){return a.getAttribute("aria-labelledby")},setLabelledBy:function(d){d?a.setAttribute("aria-labelledby",d):a.removeAttribute("aria-labelledby")},getValues:function(){return"SELECT"===a.tagName?Array.prototype.map.call(a.selectedOptions,
function(a){return a.value}):[this.getValue()]},setValues:function(d){"SELECT"===a.tagName?(Array.prototype.forEach.call(a.selectedOptions,function(a){a.selected=!1}),d.forEach(function(c){var b=Array.prototype.find.call(a.options,function(a){return a.value===c});b&&(b.selected=!0)})):"checkbox"===a.type||"radio"===a.type?a.checked=d.some(function(c){return a.value===c}):a.value=d[0]}}}});d(document).on("change","input, textarea, select",function(a){d(this).trigger("foundation-field-change")})})(window,
Granite.$);
(function(f,d,a){function e(){c||(c=a.I18n.get("\x3cMixed entries\x3e"));return c}var c;d(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field-mixed",selector:"input, textarea",adapter:function(a){var b=d(a);return{setMixed:function(a){a?(b.addClass("foundation-field-mixed"),b.attr("placeholder",e())):(b.removeClass("foundation-field-mixed"),b.removeAttr("placeholder"))}}}});d(f).on("change",".foundation-field-mixed",function(){var a=d(this).adaptTo("foundation-field-mixed");a&&
a.setMixed(!1)})})(document,Granite.$,Granite);
(function(f,d,a){d(f).on("foundation-contentloaded",function(e){d("[data-datepicker-format]",e.target).each(function(){var b=d(this),c=b.data("datepicker-format");if(c){var e=b.text();e&&(e=a(e,["YYYY-MM-DD[T]HH:mm:ss.SSSZ","YYYY-MM-DD[T]HH:mm:ssZ",c]))&&b.replaceWith(e.format(c))}});var c=a().locale(f.documentElement.lang),b=c.utcOffset(),h=c.format("Z");d(".granite-datepicker-timezone",e.target).each(function(){var a=d(this);parseInt(a.attr("data-granite-datepicker-timezone-server"),10)===b?a.attr("hidden",
""):a.find(".granite-datepicker-timezone-client").text(h)})})})(document,Granite.$,moment);
(function(f,d,a){d(f).on("cui-contentloaded",function(a,b){b&&b._foundationcontentloaded||d(a.target).trigger("foundation-contentloaded",{_cuicontentloaded:!0})});d(f).on("foundation-contentloaded",function(a,b){b&&b._cuicontentloaded||d(a.target).trigger("cui-contentloaded",{_foundationcontentloaded:!0})});for(var e=["folder","hierarchy","hierarchyNotFile","nosystem"],c=function(a){return{name:"granite.ui.pathBrowser.pages."+a,handler:function(b,c){d.get(b+".pages.json",{predicate:a},function(a){a=
a.pages;for(var b=[],d=0;d<a.length;d++)b.push(a[d].label);c&&c(b)},"json");return!1}}},b=0;b<e.length;b++)CUI.PathBrowser.register("optionLoader",c(e[b]));d(f).on("foundation-contentloaded",function(b){d(".granite-autocomplete.coral-Autocomplete",b.target).each(function(){void 0===d(this).data("autocomplete")&&new CUI.Autocomplete({element:this,selectlistConfig:{loadData:function(b,c){var g=this.$element.attr("data-granite-autocomplete-src");if(g){b=a.expand(g,d.extend({},this.options.dataadditional,
{start:b,end:c}));var e=this,f=d.get(b);b=f.then(function(a){a=d(a);var b=a.filter("li").length;e.$element.append(a);return b<e.options.datapagesize});b.abort=function(){f.abort()};return b}}}})})});e=d(window).adaptTo("foundation-registry");e.register("foundation.adapters",{type:"foundation-field",selector:".coral-PathBrowser",adapter:function(a){a=d(a);var b=a.find(".js-coral-pathbrowser-input").adaptTo("foundation-field"),c=a.data("pathBrowser");return{getName:b.getName,setName:b.setName,isDisabled:function(){return!!c.get("disabled")},
setDisabled:function(a){c.set("disabled",a)},isInvalid:b.isInvalid,setInvalid:b.setInvalid,isRequired:b.isRequired,setRequired:b.setRequired,getValue:b.getValue,setValue:b.setValue,getLabelledBy:b.getLabelledBy,setLabelledBy:b.setLabelledBy,getValues:b.getValues,setValues:b.setValues}}});d(f).on("change",".js-coral-pathbrowser-input",function(a){d(this).closest(".coral-PathBrowser").trigger("foundation-field-change")});e.register("foundation.adapters",{type:"foundation-field",selector:".coral-Autocomplete:not(coral-autocomplete)",
adapter:function(a){var b=d(a),c=b.find(".js-coral-Autocomplete-textfield").adaptTo("foundation-field"),e=b.data("autocomplete");return{getName:c.getName,setName:function(a){var d=c.getName();b.children(".foundation-field-related").each(function(){this.name.startsWith(d+"@")&&(this.name=a+this.name.substring(d.length))});c.setName(a)},isDisabled:function(){return!!e.get("disabled")},setDisabled:function(a){e.set("disabled",a);b.children(".foundation-field-related").prop("disabled",a)},isInvalid:c.isInvalid,
setInvalid:c.setInvalid,getLabelledBy:c.getLabelledBy,setLabelledBy:c.setLabelledBy,isRequired:function(){return"true"===a.getAttribute("aria-required")},setRequired:function(b){a.setAttribute("aria-required",b?"true":"false")},getValue:function(){return e.options.multiple?e.getValue()[0]:e.getValue()},setValue:function(a){e.options.multiple?(e.clear(),e._tagListWidget.addItem({value:a,display:a})):c.setValue(a)},getValues:function(){return e.options.multiple?e.getValue():[e.getValue()]},setValues:function(a){e.options.multiple?
(e.clear(),e._tagListWidget.addItem(a.map(function(a){return{value:a,display:a}}))):c.setValues(a)}}}});d(f).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",function(a){d(this).trigger("foundation-field-change")});d(f).on("change",".js-coral-Autocomplete-textfield",function(a){d(this).closest(".coral-Autocomplete").trigger("foundation-field-change")})})(document,Granite.$,Granite.URITemplate);
(function(f,d,a){f=a(f);var e=f.adaptTo("foundation-util-keyboard");f.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:"coral-cyclebutton-item[data-foundation-command]",adapter:function(c){var b=a(c),f=b.closest("coral-cyclebutton"),g;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var a=c.textContent.trim();c.dataset.foundationCommandLabel=a}g||(a=e.normalize(this.getShortcut()),g=d.createElement("span"),g.classList.add("granite-command-alignRight"),
g.textContent=a,c.content?c.content.insertBefore(g,c.content.firstChild):c.insertBefore(g,c.firstChild))},execute:function(){c.hasAttribute("selected")?f[0].items.first().setAttribute("selected",!0):c.setAttribute("selected",!0)},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return f.is(":visible")&&!b.prop("hidden")&&!b.prop("disabled")}}}})})(window,document,Granite.$);
(function(f,d){f=d(f).adaptTo("foundation-registry");f.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-dialog.foundation-toggleable",adapter:function(a){var e=d(a);e.on("coral-overlay:beforeopen",function(c){c.target===a&&e.trigger("foundation-toggleable-beforeshow")});e.on("coral-overlay:open",function(c){c.target===a&&e.trigger("foundation-toggleable-show")});e.on("coral-overlay:close",function(c){c.target===a&&e.trigger("foundation-toggleable-hide")});return{isOpen:function(){return a.open},
show:function(c){a.show()},hide:function(){a.hide()}}}});f.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-popover.foundation-toggleable, coral-overlay.foundation-toggleable",adapter:function(a){var e=d(a),c="coral-popover"===a.tagName.toLowerCase(),b=function(b){27===(b.which||b.keyCode)&&a.open&&a._isTopOverlay()&&(b.preventDefault(),a.hide())},f=function(b){var c=a._getTarget();!c||c.contains(b.target)||a.contains(b.target)||a.hide()};e.on("coral-overlay:open",function(b){b.target===
a&&e.trigger("foundation-toggleable-show")});e.on("coral-overlay:close",function(d){d.target===a&&(c&&(document.removeEventListener("click",f,!0),a.removeEventListener("keydown",b)),e.trigger("foundation-toggleable-hide"))});return{isOpen:function(){return a.open},show:function(d){d instanceof Element&&(a.target=d,c&&(a.interaction="off",document.addEventListener("click",f,!0),a.addEventListener("keydown",b)),a.show())},hide:function(){a.hide()}}}});f.register("foundation.adapters",{type:"foundation-toggleable",
selector:"coral-panel.foundation-toggleable",adapter:function(a){var e=d(a);return{isOpen:function(){return a.selected},show:function(c){a.selected=!0;e.trigger("foundation-toggleable-show")},hide:function(){a.selected=!1;e.trigger("foundation-toggleable-hide")}}}})})(window,Granite.$);
(function(f,d,a,e){function c(){m||(m=Granite.I18n.get("Please fill out this field."));return m}function b(a){if(a=a.adaptTo("foundation-validation"))a.checkValidity(),a.updateUI()}function h(a){var b=d(a);a=b.closest(".coral-Form-field");(b=b.adaptTo("foundation-field"))&&b.setInvalid&&b.setInvalid(!1);var c=a.data("foundation-validation.internal.error");if(c){var e=d(c).data("foundation-validation.internal.error.tooltip");e.hide();e.remove();c.remove();(c=g(b))&&-1!==c.indexOf(e.id)&&(c=c.split(" ").filter(function(a){return a!==
e.id}).join(" "),b&&b.setLabelledBy&&b.setLabelledBy(c))}a.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")}function g(a){if(a&&a.getLabelledBy)return a.getLabelledBy()}function k(a,b){if(null!==a.valueAsDate&&null!==b.valueAsDate&&a.valueAsDate.getTime()>=b.valueAsDate.getTime())return Granite.I18n.get("The date is not before {0}.",e(b.valueAsDate).format(b.displayFormat))}function l(a,b){if(null!==b.valueAsDate&&null!==a.valueAsDate&&b.valueAsDate.getTime()>=a.valueAsDate.getTime())return Granite.I18n.get("The date is not after {0}.",
e(b.valueAsDate).format(b.displayFormat))}var m,p=Granite.UI.Foundation.Utils.debounce;f=d(f).adaptTo("foundation-registry");f.register("foundation.validation.validator",{selector:".coral-Form-fieldwrapper .coral-Form-field, .coral-Form-fieldwrapper .coral-Form-field.coral-InputGroup .coral-InputGroup-input, .coral-Form-fieldwrapper .coral-Form-field.coral-DecoratedTextfield .coral-DecoratedTextfield-input, .coral-Form-fieldwrapper .coral-Form-field.coral-PathBrowser .js-coral-pathbrowser-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Checkbox .coral-Checkbox-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Switch .coral-Switch-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Select .coral-Select-select, .coral-Form-fieldwrapper .coral-Form-field.coral-FileUpload .coral-FileUpload-input",
show:function(b,c){b=d(b);var e=b.closest(".coral-Form-field");(b=b.adaptTo("foundation-field"))&&b.setInvalid&&b.setInvalid(!0);e.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly");var f=e.data("foundation-validation.internal.error");if(f){var h=d(f).data("foundation-validation.internal.error.tooltip");h.content.innerHTML=c;f.parentNode||(e.after(f,h),c=g(b),h=h.id,b&&b.setLabelledBy&&b.setLabelledBy(c?c+" "+h:h))}else f=new a.Icon,f.icon="alert",f.classList.add("coral-Form-fielderror"),
h=new a.Tooltip,h.variant="error",h.placement=e.closest(".coral-Form").hasClass("coral-Form--vertical")?"left":"bottom",h.target=f,h.content.innerHTML=c,h.id=a.commons.getUID(),d(f).data("foundation-validation.internal.error.tooltip",h),f.setAttribute("aria-labelledby",h.id),f.setAttribute("tabindex",0),e.data("foundation-validation.internal.error",f),e.after(f,h),c=g(b),h=h.id,b&&b.setLabelledBy&&b.setLabelledBy(c?c+" "+h:h)},clear:function(a){h(a)}});f.register("foundation.validation.validator",
{selector:"input[type\x3dpassword]",validate:function(a){var c=d(a);if(a.value){var g=a.getAttribute("data-granite-password-retype");if(g)c=c.closest("form").find("input[type\x3dpassword]").filter(function(){return this.name===g}),c.val()&&b(c);else{var e=!0;c.closest("form").find("input[type\x3dpassword][data-granite-password-retype]").each(function(){if((g=this.getAttribute("data-granite-password-retype"))&&g===a.name&&this.value&&this.value!==a.value)return e=!1});if(!e)return Granite.I18n.get("Passwords do not match!")}}}});
f.register("foundation.validation.selector",{submittable:"coral-checkbox, coral-radio, coral-switch",candidate:"coral-checkbox:not([readonly]):not([disabled]), coral-radio:not([readonly]):not([disabled]), coral-switch:not([readonly]):not([disabled])",exclusion:"coral-checkbox *, coral-radio *, coral-switch *"});f.register("foundation.validation.validator",{selector:"coral-checkbox, coral-radio, coral-switch",validate:function(a){if(a.required&&!a.checked)return c()}});f.register("foundation.validation.selector",
{submittable:"coral-datepicker, coral-numberinput, coral-slider, coral-colorinput",candidate:"coral-datepicker:not([readonly]):not([disabled]), coral-numberinput:not([readonly]):not([disabled]), coral-slider:not([readonly]):not([disabled]), coral-colorinput:not([readonly]):not([disabled])",exclusion:"coral-datepicker *, coral-numberinput *, coral-slider *, coral-colorinput *"});f.register("foundation.validation.validator",{selector:"coral-slider, coral-colorinput",validate:function(a){if(a.required&&
0===a.value.length)return c()}});f.register("foundation.validation.validator",{selector:"coral-numberinput",validate:function(a){if(a.required&&!a.value)return c();if(null!==a.max&&a.valueAsNumber>a.max)return Granite.I18n.get("Please enter a value that is no more than {0}.",[a.max],"{0}\x3dmax number");if(null!==a.min&&a.valueAsNumber<a.min)return Granite.I18n.get("Please enter a value that is no less than {0}.",[a.min],"{0}\x3dmin number");var b;if(b=!isNaN(a.step)&&!isNaN(a.valueAsNumber)){b=a.valueAsNumber;
var d=a.step;if(d){var g=b.toString().split("."),e=d.toString().split(".");g=g[1]&&g[1].length||0;e=e[1]&&e[1].length||0;0===g&&0===e?b=0===b%d:(e=g>e?g+1:e+1,b=0===b*Math.pow(10,e+1)%(d*Math.pow(10,e+1)))}else b=!0;b=!b}if(b)return Granite.I18n.get("Please enter a value that is a multiple of {0}.",[a.step],"{0}\x3dstep")}});f.register("foundation.validation.validator",{selector:"coral-datepicker",validate:function(a){if(a.required&&0===a.value.length)return c();var g=d(a),e,f=a.getAttribute("data-granite-datepicker-before");
if(f&&(d(f).each(function(){if(e=l(a,this))return!1}),e))return e;if(f=a.getAttribute("data-granite-datepicker-after"))if(d(f).each(function(){if(e=k(a,this))return!1}),e)return e;d("coral-datepicker[data-granite-datepicker-before]").each(function(){g.is(this.getAttribute("data-granite-datepicker-before"))&&(e=k(a,this))&&b(d(this))});d("coral-datepicker[data-granite-datepicker-after]").each(function(){g.is(this.getAttribute("data-granite-datepicker-after"))&&(e=l(a,this))&&b(d(this))})}});f.register("foundation.validation.selector",
{submittable:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",candidate:"coral-autocomplete:not([readonly]):not([disabled]), coral-select:not([readonly]):not([disabled]), coral-taglist:not([readonly]):not([disabled]), coral-fileupload:not([readonly]):not([disabled]), coral-buttongroup:not([readonly]):not([disabled])",exclusion:"coral-autocomplete *, coral-select *, coral-taglist *, coral-fileupload *, coral-buttongroup *"});f.register("foundation.validation.validator",
{selector:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",validate:function(a){if(a.required&&(0===a.values.length||1===a.values.length&&""===a.value))return c()}});f.register("foundation.validation.selector",{submittable:"coral-multifield",candidate:"coral-multifield",exclusion:"[coral-multifield-template], [coral-multifield-template] *"});f.register("foundation.validation.validator",{selector:"coral-multifield",validate:function(a){if("true"===a.getAttribute("aria-required")&&
0===a.items.getAll().length)return c()}});d(document).on("change","coral-autocomplete, coral-checkbox, coral-switch, coral-datepicker, coral-numberinput, coral-colorinput, coral-radio, coral-select, coral-slider, coral-taglist, coral-multifield, coral-fileupload, coral-buttongroup",function(a){b(d(this))});d(document).on("input","coral-datepicker input[handle], coral-numberinput input[handle], coral-colorinput input[handle]",p(function(a){b(d(this).closest("coral-datepicker, coral-numberinput, coral-colorinput"))},
500));f.register("foundation.validation.selector",{submittable:".coral-RadioGroup",candidate:".coral-RadioGroup",exclusion:".coral-RadioGroup *"});f.register("foundation.validation.validator",{selector:".coral-RadioGroup",validate:function(a){a=d(a);if("true"===a.attr("aria-required")){var b=a.find("coral-radio");if(b.length){if(0===b.filter("[checked]").length)return c()}else if(0===a.find("\x3e * \x3e :checked").length)return c()}}});d(document).on("change",".coral-RadioGroup",function(a){b(d(this))});
f.register("foundation.validation.selector",{submittable:".coral-Autocomplete:not(coral-autocomplete)",candidate:".coral-Autocomplete:not(coral-autocomplete)",exclusion:".coral-Autocomplete:not(coral-autocomplete) *"});f.register("foundation.validation.validator",{selector:".coral-Autocomplete:not(coral-autocomplete)",validate:function(a){a=d(a);if("true"===a.attr("aria-required")&&0===a.data("autocomplete").getValue().length)return c()}});d(document).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",
function(a){b(d(this))});f=function(a){a=d(this).closest(".coral-Autocomplete");a.data("autocomplete").options.multiple||b(a)};d(document).on("change",".js-coral-Autocomplete-textfield",f);d(document).on("input",".js-coral-Autocomplete-textfield",p(f,500));d(document).on("foundation-validation-invalid","coral-panel",function(a){var b=d(this),c=b.parent().parent("coral-tabview")[0];c&&requestAnimationFrame(function(){c.tabList.items.getAll()[b.index()].invalid=!0;var d=a.target,g=b.data("coral-tabview.internal.invalids");
void 0===g&&(g=[],b.data("coral-tabview.internal.invalids",g));0>g.indexOf(d)&&g.push(d)})});d(document).on("foundation-validation-valid","coral-panel",function(a){var b=d(this),c=b.parent().parent("coral-tabview")[0];c&&requestAnimationFrame(function(){var d=c.tabList.items.getAll()[b.index()],g=function(){b.adaptTo("foundation-validation-helper").isValid()&&(d.invalid=!1)},e=b.data("coral-tabview.internal.invalids");if(e){var f=e.indexOf(a.target);0<=f&&e.splice(f,1);if(0===e.length)g();else{f=
!1;for(var h=e.length;h--;){if(b.has(e[h]).length){f=!0;break}e.splice(h,1)}f||g()}}else g()})})})(window,Granite.$,Coral,moment);
(function(f,d,a){var e=a(f).adaptTo("foundation-registry");d=a(d);var c="input[is\x3d'coral-textfield'] textarea[is\x3d'coral-textarea'] coral-checkbox coral-radio coral-switch coral-datepicker coral-numberinput coral-slider coral-colorinput coral-calendar coral-autocomplete coral-select coral-taglist coral-fileupload coral-buttongroup".split(" ");e.register("foundation.adapters",{type:"foundation-field",selector:c.join(","),adapter:function(b){var c=a(b);return{getName:function(){return b.name},
setName:function(a){c.nextAll(".foundation-field-related").add(c.children(".foundation-field-related")).each(function(){var c=b.name;this.name.startsWith(c+"@")&&(this.name=a+this.name.substring(c.length))});b.name=a},isDisabled:function(){return b.disabled},setDisabled:function(a){b.disabled=a;c.nextAll(".foundation-field-related").add(c.children(".foundation-field-related")).prop("disabled",a)},isInvalid:function(){return b.hasAttribute("invalid")},setInvalid:function(a){a?b.setAttribute("invalid",
""):b.removeAttribute("invalid")},isRequired:function(){return a(b).is("input, textarea")?"true"===b.getAttribute("aria-required"):b.required},setRequired:function(c){a(b).is("input, textarea")?b.setAttribute("aria-required",c?"true":"false"):b.required=c},getValue:function(){return a(b).is("coral-checkbox, coral-radio, coral-switch")?b.checked?b.value:null:b.value},setValue:function(c){a(b).is("coral-checkbox, coral-radio, coral-switch")?b.checked=b.value===c:b.value=c},getLabelledBy:function(){return b.labelledBy},
setLabelledBy:function(a){b.labelledBy=a},getValues:function(){return a(b).is("coral-checkbox, coral-radio, coral-switch")?[this.getValue()]:"values"in b?b.values:[b.value]},setValues:function(c){a(b).is("coral-checkbox, coral-radio, coral-switch")?b.checked=c.some(function(a){return b.value===a}):"values"in b?b.values=c:b.value=c[0]}}}});e.register("foundation.adapters",{type:"foundation-field",selector:"coral-multifield",adapter:function(b){var c=a(b);return{getName:function(){return b.getAttribute("data-granite-coral-multifield-name")||
""},setName:function(a){b.setAttribute("data-granite-coral-multifield-name",a)},isDisabled:function(){return c.children("[coral-multifield-add]").prop("disabled")||!1},setDisabled:function(b){c.find("\x3e coral-multifield-item \x3e coral-multifield-item-content").each(function(){a(this.parentNode).children("[handle\x3d'remove'], [handle\x3d'move']").prop("disabled",b);var c=a(this.firstElementChild).adaptTo("foundation-field");c&&"setDisabled"in c&&c.setDisabled(b)});c.children("[coral-multifield-add], .foundation-field-related").prop("disabled",
b)},isInvalid:function(){return"true"===b.getAttribute("aria-invalid")},setInvalid:function(a){b.setAttribute("aria-invalid",a?"true":"false")},isRequired:function(){return"true"===b.getAttribute("aria-required")},setRequired:function(a){b.setAttribute("aria-required",a?"true":"false")},getValue:function(){var a=c.find("\x3e coral-multifield-item \x3e coral-multifield-item-content \x3e :first-child").first().adaptTo("foundation-field");return a&&"getValue"in a?a.getValue():null},setValue:function(a){this.setValues([a])},
getLabelledBy:function(){return b.getAttribute("aria-labelledby")},setLabelledBy:function(a){a?b.setAttribute("aria-labelledby",a):b.removeAttribute("aria-labelledby")},getValues:function(){return Array.prototype.map.call(c.find("\x3e coral-multifield-item \x3e coral-multifield-item-content"),function(b){return(b=a(b.firstElementChild).adaptTo("foundation-field"))&&"getValue"in b?b.getValue():null})},setValues:function(c){for(var d,e=b.items.getAll(),g=e.length,h=c.length,n=0;n<h;n++)d=e[n],"undefined"===
typeof d&&(d=b.items.add(new Coral.Multifield.Item)),f.CustomElements.upgrade(d),d.content.firstChild||b._renderTemplate(d),(d=a(d.content.firstElementChild).adaptTo("foundation-field"))&&"setValue"in d&&d.setValue(c[n]);for(c=h;c<g;c++)b.items.remove(e[c])}}}});d.on("change",c.concat("coral-multifield").join(","),function(b){a(this).trigger("foundation-field-change")});e.register("foundation.adapters",{type:"foundation-field",selector:".coral-RadioGroup",adapter:function(b){var c=a(b);return{getName:function(){return c.children("coral-radio").first().prop("name")||
""},setName:function(a){var b=c.children("coral-radio"),d=b.first().prop("name");b.prop("name",a);"undefined"!==typeof d&&c.children(".foundation-field-related").each(function(){this.name.startsWith(d+"@")&&(this.name=a+this.name.substring(d.length))})},isDisabled:function(){var a=c.children("coral-radio");return 0===a.length?!1:Array.prototype.every.call(a,function(a){return a.disabled})},setDisabled:function(a){c.children("coral-radio, .foundation-field-related").prop("disabled",a)},isInvalid:function(){return"true"===
b.getAttribute("aria-invalid")},setInvalid:function(a){b.setAttribute("aria-invalid",a?"true":"false")},isRequired:function(){return"true"===b.getAttribute("aria-required")},setRequired:function(a){b.setAttribute("aria-required",a?"true":"false")},getValue:function(){var a=Array.prototype.reduce.call(c.children("coral-radio"),function(a,b){b.checked&&a.push(b.value);return a},[]);return a.length?a[0]:null},setValue:function(a){c.children("coral-radio").each(function(){return this.value===a?this.checked=
!0:!1})},getLabelledBy:function(){var a=c.children("coral-radio");return 0<a.length?a[0].labelledBy:null},setLabelledBy:function(a){c.children("coral-radio").each(function(){this.labelledBy=a})},getValues:function(){return Array.prototype.reduce.call(c.children("coral-radio"),function(a,b){b.checked&&a.push(b.value);return a},[])},setValues:function(a){var b=c.children("coral-radio");a.forEach(function(a){b.each(function(){if(this.value===a)return b=b.not(this),this.checked=!0,!1})})}}}});d.on("change",
"coral-radio",function(b){a(this).parent(".coral-RadioGroup").trigger("foundation-field-change")})})(window,document,Granite.$);
(function(f,d,a){function e(){c||(c=a.I18n.get("\x3cMixed entries\x3e"));return c}var c;f=d(window).adaptTo("foundation-registry");f.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-datepicker",adapter:function(a){return{setMixed:function(b){b?(a.classList.add("foundation-field-mixed"),a.placeholder=e()):(a.classList.remove("foundation-field-mixed"),a.placeholder="")}}}});f.register("foundation.adapters",{type:"foundation-field-mixed",selector:"[data-init\x3d'pathbrowser']",
adapter:function(a){var b=d(a).data("pathBrowser");return{setMixed:function(a){a?(b.$element.addClass("foundation-field-mixed"),b.$element.attr("placeholder",e())):(b.$element.removeClass("foundation-field-mixed"),b.$element.removeAttr("placeholder"))}}}});f.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-checkbox",adapter:function(a){return{setMixed:function(b){b?a.classList.add("foundation-field-mixed"):a.classList.remove("foundation-field-mixed")}}}});f.register("foundation.adapters",
{type:"foundation-field-mixed",selector:".js-cq-TagsPickerField[data-init\x3d'pathbrowser']",adapter:function(a){return{setMixed:function(a){}}}})})(document,Granite.$,Granite);
(function(f,d){function a(c,b){c.children().each(function(){var c=d(this);c.is(":-foundation-submittable")?b(this):a(c,b)})}function e(c,b){var f=d(c),g=f.is("coral-multifield[data-granite-coral-multifield-composite]"),k=f.adaptTo("foundation-field").getName(),l=b||k;l&&c.items.getAll().forEach(function(c,f){l=b||k;g&&(l+="/item"+f+"/");a(d(c),function(a){var b=d(a),c=b.adaptTo("foundation-field");if(c){if(!c.setName)throw Error("The field doesn't support FoundationField#setName");var g=b.data("cachedName");
g||(g=c.getName(),b.data("cachedName",g));g&&(g=l+g,c.setName(g),b.is("coral-multifield")&&(b.is("coral-multifield[data-granite-coral-multifield-composite]")?e(a,g):e(a,l)))}})})}d(document).on("coral-collection:add","coral-multifield",function(a){this===a.target&&Coral.commons.nextFrame(function(){d(this).trigger("foundation-contentloaded")}.bind(this))});d(document).on("coral-collection:add coral-collection:remove coral-multifield:itemorder","coral-multifield[data-granite-coral-multifield-composite]",
function(){Coral.commons.ready(this,function(a){e(a,"")})});d(document).on("foundation-contentloaded",function(a){d("coral-multifield[data-granite-coral-multifield-composite]",a.target).each(function(){Coral.commons.ready(this,function(a){e(a,"")})})})})(window,Granite.$);
(function(f,d,a){a(f).on("foundation-mode-change",function(d,c,b){"default"!==c&&"edit"!==c||a(".foundation-layout-form").each(function(){var d=a(this);if(b===d.data("foundationModeGroup")){var e="edit"===c;d.toggleClass("foundation-layout-form-mode-edit",e).toggleClass("foundation-layout-form-mode-default",!e)}})})})(document,window,Granite.$);
(function(f,d,a,e,c,b){function h(a){var b=function(b,c,d){b._foundationLayoutMasonry||("default"===c||"selection"===c)&&a.collectionEl.dataset.foundationModeGroup===d&&m(a,c)};t(d).on("foundation-mode-change",b);return function(){t(d).off("foundation-mode-change",b)}}function g(c){var d=c.collection,e=function(e){var g=e.originalEvent.detail,h=g.item,q=h.dragAction.dropZone;e=g.before;var k=g.oldBefore;if(g=c.config.itemReorderAction){var z=e?e.dataset.foundationCollectionItemId:void 0;e=z?z.substring(z.lastIndexOf("/")+
1):void 0;g=e=b.expand(g,{item:h.dataset.foundationCollectionItemId,before:z,beforeName:e});var l=e.indexOf("?");if(0<=l){g=e.substring(0,l);var D=e.substring(l+1)}var m=t(f).adaptTo("foundation-ui");m.wait();t.ajax({url:g,method:"POST",data:D}).always(function(){m.clearWait();y("order",d,c.config,h,{before:z})}).fail(function(b,e,g){b=a.I18n.get("Error");e=a.I18n.get("Fail to reorder.");y("order-error",d,c.config,h,{before:z,errorMsg:g});m.alert(b,e,"error");k?t(h).insertBefore(k.nextSibling):t(h).insertBefore(q.firstChild)})}};
d.on("coral-masonry:order",e);return function(){d.off("coral-masonry:order",e)}}function k(a){var b=function(a){a.preventDefault();a.stopImmediatePropagation()};a.collectionEl.addEventListener("coral-dragaction:dragend",b,!0);return function(){a.collectionEl.removeEventListener("coral-dragaction:dragend",b,!0)}}function l(a){var b=a.collection,e=function(c){var d=!c.hasClass("foundation-selections-item"),e=b.adaptTo("foundation-selections");d?("single"===a.collectionEl.dataset.foundationSelectionsMode&&
b.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",!1),e.select(c[0])):e.deselect(c[0])},g=function(b){var c=t(b.target).closest(".foundation-collection, .foundation-collection-item, coral-quickactions");c.hasClass("foundation-collection-item")&&a.isSelectionMode&&(b.preventDefault(),b.stopPropagation(),r.get(c[0])?r.delete(c[0]):e(c))},h=function(a){var b=c.Keys.keyToCode("space");a.keyCode===b&&(b=t(a.target),b.is("coral-masonry-item")&&(a.preventDefault(),
e(b)))},k=function(){(d.activeElement===a.collectionEl||a.collectionEl.contains(d.activeElement))&&b.adaptTo("foundation-selections").clear()};a.collectionEl.addEventListener("click",g,!0);b.on("keydown","coral-masonry-item.foundation-collection-item",h);c.keys.on("escape",k);var l=new (t(f).adaptTo("foundation-util-gesture-longpress"))({el:a.collectionEl,selector:"coral-masonry-item",validate:function(){return!a.isSelectionMode},perform:function(a){b.adaptTo("foundation-selections").select(a);r.set(a,
!0)}});l.start();return function(){a.collectionEl.removeEventListener("click",g,!0);a.collection.off("keydown","coral-masonry-item.foundation-collection-item",h);c.keys.off("escape",k);l.destroy()}}function m(a,b,c){var d=a.collection,e="selection"===b;a.isSelectionMode!==e&&(c||e||d.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",!1),a.isSelectionMode=e,"selection"===b?d.addClass("is-selectable"):d.removeClass("is-selectable"),c&&(a=a.collectionEl.dataset.foundationModeGroup))&&
(c=t.Event("foundation-mode-change"),c._foundationLayoutMasonry=!0,d.trigger(c,[b,a]))}function p(a){var c=a.collectionEl,d=a.collection,e=c.dataset.foundationCollectionSrc;if(e){var g=a.config.scrollSrc?d.closest(a.config.scrollSrc):d.parent(),h=t(f).adaptTo("foundation-util-paginator"),k;a.paginator=new h({el:g[0],limit:a.config.limit||20,wait:function(){c.dataset.graniteCollectionIsLoading="true";return{clear:function(){c.dataset.graniteCollectionIsLoading="false"}}},resolveURL:function(a){return b.expand(e,
{offset:a.offset,limit:a.limit,id:c.dataset.foundationCollectionId})},processResponse:function(b,d){var e=t.Deferred();c.dataset.graniteCollectionIsLoading="true";t(f).adaptTo("foundation-util-htmlparser").parse(d).then(function(d){var g=t(d).children();g.hasClass("foundation-collection")&&(d=g.children(".foundation-collection-item").toArray(),k=t.Deferred(),n(a,d,k.promise()),g=g[0].dataset.foundationLayoutMasonryHasmore,g="true"===g?!0:"false"===g?!1:d.length>=b.limit,c.dataset.graniteCollectionIsLoading=
"false",e.resolve({length:d.length,hasNext:g}))});return e.promise()},onNewPage:function(){d.trigger("foundation-collection-newpage");y("newpage",d,a.config);k.resolve()}});h=d.children(".foundation-collection-item").length;a.paginator.start(h,"false"!==c.dataset.foundationLayoutMasonryHasmore,!1,500);h=t(f).adaptTo("foundation-collection-lazyloader");a.lazyLoader=new h({scrollSrc:g[0],getItems:function(){return d.children(".foundation-collection-item").toArray()},load:function(a,d){a=b.expand(e,
{offset:d.offset,limit:d.limit,id:c.dataset.foundationCollectionId});return t.ajax(a).then(function(a){return t(f).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){a=t(a).children();if(a.hasClass("foundation-collection"))return a.children(".foundation-collection-item").toArray()})})},onReplace:function(){u(d);d.trigger("foundation-contentloaded")},isItemAbove:function(a,b,c){return b._layoutData?b._layoutData.top+b._layoutData.height<c:!1},isItemBelow:function(a,b,c){return b._layoutData?
b._layoutData.top>c:!0},setupListeners:function(a,b){var e=function(a){t(a.target).is(".foundation-collection-item.is-lazyLoaded")&&b()};c.addEventListener("transitionend",e);d.on("foundation-collection-navigate",b);return function(){c.removeEventListener("transitionend",e);d.off("foundation-collection-navigate",b)}}});a.lazyLoader.start();return function(){a.paginator.destroy();a.lazyLoader.destroy()}}}function n(a,b,c){var d=a.collection;d.append(b);if(b.length&&"true"===d[0].dataset.foundationSelectionsSelectallMode){b.forEach(function(a){a.classList.contains("is-lazyLoaded")||
a.classList.contains("is-pending")||(a.selected=!0,a.classList.add("foundation-selections-item"))});var e=t.when();a.lazyLoader&&(e=a.lazyLoader.loadItems(b).then(function(a){u(d);a.forEach(function(a){a.selected=!0;a.classList.add("foundation-selections-item")})}));t.when(e,c).then(function(){d.trigger("foundation-selections-change");y("change",d,a.config,null,{method:"append"})})}u(d);d.trigger("foundation-contentloaded")}function x(a){var b=a.collection,d=function(a){b.adaptTo("foundation-collection-item-action").execute(a)},
e=function(a){var b=t(a.target).closest("button, a, coral-quickactions-item, .foundation-collection-item");b.hasClass("foundation-layout-masonry-cardwrapper")?1!==a.which||a.metaKey||a.shiftKey||a.altKey||(a.preventDefault(),d(b.closest(".foundation-collection-item")[0])):b.hasClass("foundation-collection-item")&&(a.preventDefault(),d(b[0]))},g=function(b){var e=c.Keys.keyToCode("enter");b.keyCode===e&&t(b.target).is("coral-masonry-item")&&(a.isSelectionMode||d(b.target))};b.on("click",".foundation-collection-item",
e);b.on("keydown","coral-masonry-item",g);return function(){b.off("click",".foundation-collection-item",e);b.off("keydown","coral-masonry-item",g)}}function v(a){var b=a.collectionEl,c=a.collection,d=function(b){a.isSelectionMode&&b.preventDefault()},e=function(a){var b=a.explicitOriginalTarget;"CORAL-QUICKACTIONS"===b.parentNode.nodeName&&(b.matches("button[is\x3d'coral-button']")||b.matches("a[is\x3d'coral-anchorbutton']"))&&(a.preventDefault(),a.stopImmediatePropagation());a=t(a.target).closest(".foundation-collection-item").find("coral-quickactions");
a.length&&(a[0].open=!a[0].open)};c.on("coral-overlay:beforeopen","coral-quickactions",d);b.addEventListener("coral-dragaction:dragstart",e,!0);b.addEventListener("coral-dragaction:dragend",e,!0);return function(){c.off("coral-overlay:beforeopen","coral-quickactions",d);b.removeEventListener("coral-dragaction:dragstart",e,!0);b.removeEventListener("coral-dragaction:dragend",e,!0)}}function u(a){var c=d.querySelector(".granite-collection-pagetitle");a.find("coral-card.foundation-collection-navigator").wrap(function(){var e=
t(this);if(!e.parent("a").length){var g=d.createElement("a");g.className="foundation-layout-masonry-cardwrapper";g.tabIndex=-1;var f=e[0].dataset.foundationCollectionNavigatorHref;if(f)g.target=e[0].dataset.foundationCollectionNavigatorTarget;else{if(!c||!a.is(c.dataset.graniteCollectionPagetitleTarget))return;f=b.expand(c.dataset.graniteCollectionPagetitleSrc,{id:e.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})}g.href=f;return t(g)}})}function y(a,b,c,d,e){b=b[0].dataset.foundationCollectionId||
c.trackingElement||"";d&&d.dataset.foundationCollectionItemId?b=d.dataset.foundationCollectionItemId:d||"change"!==a||(b="");a={element:b,type:"change"===a?"masonry-item":"masonry",action:a,widget:{name:c.trackingElement||"",type:"masonry"},feature:c.trackingFeature||""};e&&(a.attributes=e);t(f).adaptTo("foundation-tracker").trackEvent(a)}var t=e;e=t(f).adaptTo("foundation-registry");var w=new WeakMap,r=new WeakMap;e.register("foundation.layouts",{name:"foundation-layout-masonry",doLayout:function(a,
b){var c=t(a);if(c.hasClass("foundation-collection")&&!w.has(a)){var d={collectionEl:a,collection:c,config:b,stack:[]};w.set(a,d);y("init",c,b);d.stack.push(h(d));d.stack.push(l(d));d.stack.push(p(d));d.stack.push(x(d));d.stack.push(v(d));d.stack.push(k(d));d.stack.push(g(d));u(c);var e=c.data("foundation-layout-collection-switcher.internal.selectionIds");a=t();e&&(a=c.children(".foundation-collection-item").filter(function(){return 0<=e.indexOf(this.dataset.foundationCollectionItemId)}),a.each(function(){t(this).attr("selected",
"").addClass("foundation-selections-item")}));var f=b.selectionMode||a.length?"selection":"default";requestAnimationFrame(function(){m(d,f,!0);c.trigger("foundation-collection-newpage");y("newpage",c,b);c.trigger("foundation-selections-change");y("change",c,b,null,{method:"init"})})}},clean:function(b,c){t(b).siblings(".granite-collection-loading-title-wrapper").remove();if(c=w.get(b))w.delete(b),a.UI.Foundation.Utils.everyReverse(c.stack,function(a){a&&a();return!0});a.UI.Foundation.Layouts.clean(b)}});
e.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-masonry.foundation-collection",adapter:function(c){var d=w.get(c),e=d.collection,g=d.config,h=function(d,h,k){var l=c.dataset.foundationCollectionSrc;h||(h=g.limit||20);d=b.expand(l,{offset:0,limit:h,id:d});return t.ajax({url:d,cache:!1}).then(function(b){var d=t.Deferred();t(f).adaptTo("foundation-util-htmlparser").parse(b).then(function(b){var f=t(b).children();f.hasClass("foundation-collection")?(k&&(b=
e.children(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId}).toArray(),f.data("foundation-layout-collection-switcher.internal.selectionIds",b)),e.trigger("foundation-collection-reload"),y("reload",e,g),a.UI.Foundation.Layouts.cleanAll(c),f.replaceAll(e),requestAnimationFrame(function(){f.trigger("foundation-collection-navigate");y("navigate",e,g)}),f.trigger("foundation-contentloaded"),k&&f.removeData("foundation-layout-collection-switcher.internal.selectionIds"),
d.resolve(f)):d.reject(Error("Invalid content"))});return d.promise()},function(){var b=a.I18n.get("Error"),c=a.I18n.get("Fail to load data.");t(f).adaptTo("foundation-ui").alert(b,c,"error")})};return{append:function(a){n(d,a)},clear:function(){e.children(".foundation-collection-item").remove()},getPagination:function(){var a=d.paginator;if(!a)return null;var b=parseInt(e.attr("data-foundation-layout-masonry-guesstotal")||"-1",10);return{offset:a.offset,limit:a.limit,guessTotal:-1===b?b:Math.max(a.offset,
b),hasNext:-1===b?a.hasNext:a.offset>=b?a.hasNext:null}},load:function(a){return h(a)},reload:function(){var a=this.getPagination();if(a)var b=a.offset;return h(c.dataset.foundationCollectionId,b,!0)}}}});e.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-masonry.foundation-collection",adapter:function(a){var b=t(a).children(".foundation-collection-meta"),c=b[0];return c?{getElement:function(){return c},getTitle:function(){return c.dataset.foundationCollectionMetaTitle},
getThumbnail:function(){return b.children(".foundation-collection-meta-thumbnail")[0]},isFolder:function(){return"true"===c.dataset.foundationCollectionMetaFolder},getRelationship:function(){return c.dataset.foundationCollectionMetaRel}}:null}});e.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-masonry.foundation-collection",adapter:function(a){var b=w.get(a),c=b.collection,e=b.config;return{count:function(){if("true"===a.dataset.foundationSelectionsSelectallMode){var b=
c.adaptTo("foundation-collection").getPagination();if(b&&-1!==b.guessTotal){var d=c.children(".foundation-collection-item:not(.foundation-selections-item)");return b.guessTotal-d.length}}return c.children(".foundation-selections-item").length},selectAll:function(a){c.children(".foundation-collection-item:not(.is-lazyLoaded):not(.is-pending)").prop("selected",!0).addClass("foundation-selections-item");var g=c.children(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending");
if(g.length){var f=t(d.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered /\x3e');f.appendTo(d.body);b.lazyLoader&&b.lazyLoader.loadItems(g.toArray()).then(function(b){b.forEach(function(a){a.selected=!0;a.classList.add("foundation-selections-item")});a||(c.trigger("foundation-selections-change"),y("change",c,e,null,{method:"selectAll"}));f.remove()})}else a||(c.trigger("foundation-selections-change"),y("change",c,e,null,{method:"selectAll"}));m(b,"selection",
!0)},clear:function(a){c.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",!1);a||(c.trigger("foundation-selections-change"),y("change",c,e,null,{method:"clear"}));e.autoDefaultMode&&m(b,"default",!0)},select:function(a){var d=t(a);d.is(".foundation-collection-item")&&(m(b,"selection",!0),a.selected=!0,d.addClass("foundation-selections-item"),c.trigger("foundation-selections-change"),y("change",c,e,a,{method:"select"}))},deselect:function(a){var d=t(a);
d.is(".foundation-collection-item")&&(a.selected=!1,d.removeClass("foundation-selections-item"),c.trigger("foundation-selections-change"),y("change",c,e,a,{method:"deselect"}),e.autoDefaultMode&&!c.children(".foundation-selections-item").length&&m(b,"default",!0))},isAllSelected:function(){var b="true"===a.dataset.foundationSelectionsSelectallMode,d=c.adaptTo("foundation-collection").getPagination();d=d?d.hasNext:!1;var e=c.children(".foundation-collection-item:not(.is-removing)").length,g=c.children(".foundation-selections-item").length;
return 0<e&&e===g?b?!0:!d:!1}}}})})(window,document,Granite,Granite.$,Coral,Granite.URITemplate);
(function(f,d,a,e,c){function b(b){var c={};b.find(":input").each(function(){var b=a(this);b.serializeArray().forEach(function(d){var e=d.name;d=d.value;if(c.hasOwnProperty(e)){var g=c[e];Array.isArray(g)||(g=[g]);g.push(d);d=g}c[e]=d;(d=a(b).attr("data-foundation-uritemplate-parent"))&&((c[d]=c[d]||{})[e]=c[e])})});return c}function h(b){if(!1===b.data("foundationWizardStepValidation"))return!0;var c=b.data("foundation-wizard-step.internal.valid");if(void 0!==c)return c;var d=!0;b.adaptTo("foundation-validation-helper").getSubmittables().forEach(function(b){b=
a(b).adaptTo("foundation-validation");b.checkValidity()||(d=!1);b.updateUI()});return d}function g(b){var c=[];(b=b.data("foundation-wizard-step.internal.children"))&&b.each(function(){var b=a(this),d=b.data("foundation-layout-wizard2.internal.actualStep");d||(d=b);c.push(d);a.merge(c,g(b))});return c}function k(c,k,l){if(h(k)){var m=c.adaptTo("foundation-wizard");if(c=l.data("foundationWizardControlSrc")){var q=a(m.getPrevSteps(k[0])).add(k);q=b(q);c=e.expand(c,q);if(l.data("foundation-wizard-control.internal.lastURL")===
c)m.next();else{l.data("foundation-wizard-control.internal.lastURL",c);var n=a(f).adaptTo("foundation-ui");n.wait();a.ajax({url:c,cache:!1}).done(function(b){a(f).adaptTo("foundation-util-htmlparser").parse(b).then(function(b){b=a(b.querySelectorAll(".foundation-wizard-step"));m.remove(g(k));k.data("foundation-wizard-step.internal.children",b);m.appendAfter(b.toArray(),k[0]);m.next();n.clearWait()})}).fail(function(){n.clearWait();var a=d.I18n.get("Error"),b=d.I18n.get("Something went wrong.");n.alert(a,
b,"error")})}}else m.next()}}function l(b){var c=function(c){var d=a(this),e=d.data("foundationWizardControlAction");if(d.closest("coral-panel").prop("selected")){var g=b.find(".foundation-wizard-step-active");"next"===e?("button"===d.prop("type")&&c.preventDefault(),k(b,g,d)):"prev"===e&&(c.preventDefault(),b.adaptTo("foundation-wizard").prev())}else c.preventDefault()};b.on("click",".foundation-wizard-control",c);return function(){b.off("click",".foundation-wizard-control",c)}}function m(b){var d=
a(b),e=d.data("foundation-layout-wizard2.internal.resizeController");if(!e){var g=d.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-steplist"),f=d.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-title"),h=d.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-controls");e=new v({elements:[new x({element:g[0],states:[new n({fn:function(a){(a||this.element).setAttribute("size","L")}}),new n({fn:function(a){(a||this.element).setAttribute("size",
"S")}})]}),new x({element:f[0]}),new x({element:h[0]})],container:g[0].parentElement});e.measureElements().then(function(){var a=function(a){requestAnimationFrame(function(){e.checkResize()})};c.commons.addResizeListener(b,a);u.set(b,a);e.checkResize()});d.data("foundation-layout-wizard2.internal.resizeController",e)}}function p(b){u.get(b)&&(c.commons.removeResizeListener(b,u.get(b)),u.delete(b));b=a(b);var d=b.data("foundation-layout-wizard2.internal.resizeController");d&&(d.clean(),a.removeData(b,
"foundation-layout-wizard2.internal.resizeController"))}function n(a){this.fn=a.fn}function x(a){this.element=a.element;this.currentState=0;this.measuredWidth=-1;this.states=a.states}function v(a){this.config=a;this.totalWidth=0;this.elementsMap=new WeakMap;for(a=0;a<this.config.elements.length;++a)this.elementsMap.set(this.config.elements[a].element,this.config.elements[a])}var u=new WeakMap,y=a(f).adaptTo("foundation-registry");y.register("foundation.layouts",{name:"foundation-layout-wizard2",doLayout:function(b,
c){m(b);var d=a(b);if(d.hasClass("foundation-wizard")&&!0!==d.data("foundation-layout-wizard2.internal.init")){var e=[];e.push(function(){d.data("foundation-layout-wizard2.internal.stack",e);return function(){d.removeData("foundation-layout-wizard2.internal.stack")}}());e.push(function(){d.data("foundation-layout-wizard2.internal.init",!0);return function(){d.removeData("foundation-layout-wizard2.internal.init")}}());e.push(l(d));var g=d.find(".foundation-wizard-step").first();g.length&&requestAnimationFrame(function(){g.addClass("foundation-wizard-step-active");
d.trigger("foundation-wizard-stepchange",[g[0]])})}},clean:function(b,c){p(b);(c=a(b).data("foundation-layout-wizard2.internal.stack"))&&d.UI.Foundation.Utils.everyReverse(c,function(a){a&&a();return!0});d.UI.Foundation.Layouts.clean(b)}});y.register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-layout-wizard2.foundation-wizard",adapter:function(b){var d=a(b);return{toggleNext:function(a){this.toggle("next",a)},togglePrev:function(a){this.toggle("prev",a)},toggleCancel:function(a){this.toggle("cancel",
a)},toggle:function(a,b){d.find(".foundation-layout-wizard2-controls \x3e coral-panel[selected] .foundation-wizard-control[data-foundation-wizard-control-action\x3d"+a+"]").prop("disabled",!b)},next:function(){var a=d.find(".foundation-layout-wizard2-contents \x3e coral-panel[selected]"),b=a.next("coral-panel");if(b.length){var c=b.index();d.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(c).attr("selected","");b.attr("selected","");d.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(c).attr("selected",
"");a=a.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");b=b.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");d.trigger("foundation-wizard-stepchange",[b[0],a[0]])}},prev:function(){var a=d.find(".foundation-layout-wizard2-contents \x3e coral-panel[selected]"),b=a.prev("coral-panel");if(b.length){var c=b.index();d.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(c).attr("selected","");b.attr("selected","");d.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(c).attr("selected",
"");a=a.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");b=b.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");d.trigger("foundation-wizard-stepchange",[b[0],a[0]])}},append:function(a,b){var c=d.find(".foundation-layout-wizard2-contents \x3e coral-panel");this.appendAfter(a,(void 0===b?c[c.length-1]:c[b]).querySelector(".foundation-wizard-step"))},appendAfter:function(b,e){var g=[],f=[],h=[];b.forEach(function(b){var d=a(b);b=d.attr("data-foundation-wizard-step-title");
var e=d.children(".foundation-wizard-control").detach().addClass("foundation-layout-inline2-item"),k=d.children(".foundation-wizard-step-content").removeClass("foundation-wizard-step-content").addClass("foundation-wizard-step");0===k.length?k=d:d.data("foundation-layout-wizard2.internal.actualStep",k);d=new c.Panel;k.appendTo(d.content);var l=document.createElement("div");l.className="foundation-layout-inline2 foundation-layout-inline2-gap";k=new c.Panel;k.content.appendChild(l);e.appendTo(l);b=(new c.Step).set({label:{textContent:b}});
g.push(b);f.push(d);h.push(k)});b=a(e).closest("coral-panel");e=b.index();d.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(e).after(g);b.after(f);d.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(e).after(h);d.trigger("foundation-contentloaded");(b=d.data("foundation-layout-wizard2.internal.resizeController"))&&b.updateElement(d.find(".foundation-layout-wizard2-steplist")[0])},remove:function(b){var c=d.find(".foundation-layout-wizard2-steplist \x3e coral-step"),e=
d.find(".foundation-layout-wizard2-controls \x3e coral-panel"),g=[];a(b).each(function(){var b=a(this).closest("coral-panel"),d=b.index();g.push(b[0],c[d],e[d])});a(g).detach();(b=d.data("foundation-layout-wizard2.internal.resizeController"))&&b.updateElement(d.find(".foundation-layout-wizard2-steplist")[0])},getPrevSteps:function(b){return a(b).closest("coral-panel").prevAll("coral-panel").find(".foundation-wizard-step").toArray()}}}});n.prototype.clean=function(){this.fn=null};x.prototype.measure=
function(b){var d=a.Deferred(),e=a(this.element).clone().css({display:"inline-block",width:"auto",visibility:"hidden"}).appendTo("body");b&&this.states&&this.states.length&&this.states[0].fn.call(this,e[0]);var g=this;c.commons.ready(this.element,function(){g.previousMeasuredWidth=g.measuredWidth;g.measuredWidth=e.outerWidth(!0);d.resolve(g.measuredWidth);e.remove()});return d.promise()};x.prototype.goToNextState=function(){return this.states&&this.states.length&&this.currentState<this.states.length-
1?(this.states[++this.currentState].fn.call(this),!0):!1};x.prototype.goToPreviousState=function(){return this.states&&this.states.length&&0<this.currentState?(this.states[--this.currentState].fn.call(this),!0):!1};x.prototype.overflows=function(){return this.element.offsetWidth<this.measuredWidth};x.prototype.clean=function(){this.config=this.element=null;this.states.forEach(function(a){a.clean()});this.states=null};v.prototype.measureElements=function(){var b=a.Deferred(),c=this,d=this.config.elements.map(function(a){return a.measure()});
a.when.apply(a,d).then(function(){for(var a=0;a<arguments.length;++a)c.totalWidth+=arguments[a]||0;b.resolve(c.totalWidth)});return b.promise()};v.prototype.elementsOverflow=function(){return a(this.config.container).width()<this.totalWidth};v.prototype.checkResize=function(){var a;if(this.elementsOverflow()){if(!this.hasOverflow)for(a=0;a<this.config.elements.length;++a){var b=this.config.elements[a];if(b.goToNextState()){this.hasOverflow=!0;break}}}else if(this.hasOverflow)for(a=0;a<this.config.elements.length;++a)if(b=
this.config.elements[a],b.goToPreviousState()){this.hasOverflow=!1;break}};v.prototype.updateElement=function(a){a=this.elementsMap.get(a);var b=this;if(a){var c=a.measuredWidth;a.measure(!0).then(function(a){b.totalWidth-=c;b.totalWidth+=a;b.checkResize()})}};v.prototype.clean=function(){this.config.elements.forEach(function(a){a.clean()});this.elementsMap=this.config=null}})(window,Granite,Granite.$,Granite.URITemplate,Coral);
(function(f,d,a){function e(a,b){a.bulkSelection=!0;b=b();a.bulkSelection=!1;return b}function c(a,b){a[0].dataset.foundationCollectionId=b;a.removeData("foundationCollectionId")}function b(a){var b=a.collection,c=function(c,d,g){c._foundationLayoutColumnview||"default"!==d||a.collectionEl.dataset.foundationModeGroup!==g||(e(a,function(){q(b[0].selectedItems).prop("selected",!1)}),b.children("coral-columnview-preview").remove(),b.trigger("foundation-selections-change"),u("change",b,a.config,{method:"modeChange"}))};
q(document).on("foundation-mode-change",c);return function(){q(document).off("foundation-mode-change",c)}}function h(a){var b=a.collection,c=a.collectionEl,d=function(d){var e=q(d.originalEvent.detail.selection);d=q(d.originalEvent.detail.oldSelection);d.removeClass("foundation-selections-item");e.addClass("foundation-selections-item");if(!a.bulkSelection){if(e.length){var g=c.dataset.foundationCollectionId;(c.activeItem?c.activeItem.dataset.foundationCollectionItemId:b.children("coral-columnview-column")[0].dataset.foundationLayoutColumnviewColumnid)!==
g?a.delaySelectionEvent={selections:e,prevSelections:d}:(l(b,!1,e,d),b.trigger("foundation-selections-change"),u("change",b,a.config,{method:"handleSelection"}))}else l(b,!1,e,d),b.trigger("foundation-selections-change"),u("change",b,a.config,{method:"handleSelection"});1===e.length&&"single"!==c.dataset.foundationSelectionsMode?k(a,e[0]):b.children("coral-columnview-preview").remove()}},e=function(){(document.activeElement===c||c.contains(document.activeElement))&&b.adaptTo("foundation-selections").clear()};
b.on("coral-columnview:change",d);Coral.keys.on("escape",e);return function(){b.off("coral-columnview:change",d);Coral.keys.off("escape",e)}}function g(a){var b=a.collection,d=function(d){c(b,d.originalEvent.detail.column.dataset.foundationLayoutColumnviewColumnid);b.trigger("foundation-collection-navigate");u("navigate",b,a.config);b.trigger("foundation-selections-change");u("change",b,a.config,{method:"handleNavigation"});if(d=a.delaySelectionEvent)a.delaySelectionEvent=null,l(b,!1,d.selections,
d.prevSelections)};b.on("coral-columnview:navigate",d);return function(){b.off("coral-columnview:navigate",d)}}function k(b,c,d){var e=b.config;if(!e.previewSrc)return q.Deferred().reject(Error("previewSrc not available")).promise();var g=c.dataset.foundationCollectionItemId,h=a.expand(e.previewSrc,{id:g});return q.ajax({url:h,cache:!1}).then(function(a){return v(a,"coral-columnview-preview").then(function(a){a.dataset.foundationLayoutColumnviewColumnid=g;e.previewMaximized&&a.classList.add("foundation-layout-columnview-preview-maximized");
if(d)b.collection.children("coral-columnview-preview").replaceWith(a);else{var f=q(c).closest("coral-columnview-column")[0];b.collectionEl.setNextColumn(a,f)}return a})},function(){var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Fail to load data.");q(f).adaptTo("foundation-ui").alert(a,b,"error")})}function l(a,b,c,d){var e=a[0].dataset.foundationModeGroup;if(e){c=c?c.length:a.adaptTo("foundation-selections").count();d=d?d.length:0;var g=function(b){var c=q.Event("foundation-mode-change");c._foundationLayoutColumnview=
!0;a.trigger(c,[b,e])};(0===d||b)&&0<c?g("selection"):(0<d||b)&&0===c&&g("default")}}function m(a){return 0===a.children("coral-columnview-column[data-foundation-layout-columnview-lazy\x3d'true']").length}function p(b){var c=b.collection,d=b.collectionEl,e=b.config,g=function(b){var g=d.dataset.foundationCollectionSrc;if(g){var h=b.originalEvent.detail,k=b.target,l=h.column;b=h.item;var A=e.limit||20;if(b){var p=b.dataset.foundationCollectionItemId;if("drilldown"===b.variant){var G=a.expand(g,{offset:h.start,
limit:A,id:p});var C=d;var z=function(a){return v(a,"coral-columnview-column").then(function(a){var b=q(a).find(".foundation-collection-item"),d=a.dataset.foundationLayoutColumnviewHasmore;D.set(a,{offset:b.length,limit:A,hasNext:"true"===d?!0:"false"===d?!1:b.length>=A});b=n(a,g);E.set(a,b);k.setNextColumn(a,l);b.start();F.get(k)&&m(c)&&requestAnimationFrame(function(){c.trigger("foundation-collection-navigate");u("navigate",c,e)})})}}else if(e.previewSrc)G=a.expand(e.previewSrc,{id:p}),C=d,z=function(a){return v(a,
"coral-columnview-preview").then(function(a){var b=q(a);a.dataset.foundationLayoutColumnviewColumnid=p;e.previewMaximized&&b.addClass("foundation-layout-columnview-preview-maximized");k.setNextColumn(a,l);F.get(k)&&m(c)&&requestAnimationFrame(function(){c.trigger("foundation-collection-navigate");u("navigate",c,e)})})};else{h=k.columns.getAll();b=h.indexOf(l);for(var H=h.length-1;0<=b&&H>b;H--)k.columns.remove(h[H])}}else{if("false"===l.dataset.foundationLayoutColumnviewHasmore)return;G=a.expand(g,
{offset:h.start,limit:A,id:l.dataset.foundationLayoutColumnviewColumnid});C=l;z=function(a){return x(a).then(function(a){var b=a.items,f=null;l.dataset.foundationLayoutColumnviewLazy&&(q(l.content).empty(),delete l.dataset.foundationLayoutColumnviewLazy,a.meta&&l.content.appendChild(a.meta),b.some(function(a){return l.dataset.foundationLayoutColumnviewActiveitem===a.dataset.foundationCollectionItemId?(delete l.dataset.foundationLayoutColumnviewActiveitem,f=a,!0):!1}));b.forEach(function(a){l.items.add(a)});
a=a.hasMore;null===a&&(a=b.length>=A);l.dataset.foundationLayoutColumnviewHasmore=""+a;D.set(l,{offset:l.items.getAll().length,limit:A,hasNext:a});a=E.get(l);a||(a=n(l,g),E.set(l,a),a.start());if(f){var h=function(a){CustomElements.upgrade(a);"drilldown"===a.variant?(a.set("active",!0,!0),l._oldActiveItem=a):a.active=!0;a.scrollIntoView()};q(f).is(".is-lazyLoaded, .is-pending")?a.loadItems([f]).then(function(a){h(a[0])}):h(f)}"true"===d.dataset.foundationSelectionsSelectallMode&&t(d)===l&&(B(q(b).filter(":not(.is-lazyLoaded):not(.is-pending)").toArray()),
a.loadItems(b).then(function(a){B(a);c.trigger("foundation-selections-change");u("change",c,e,{method:"handlePagination"})}));F.get(k)&&m(c)&&requestAnimationFrame(function(){c.trigger("foundation-collection-navigate");u("navigate",c,e)})})}}G&&(C&&C.classList.add("foundation-layout-columnview-isloading"),q.ajax({url:G,cache:!1}).always(function(){C&&C.classList.remove("foundation-layout-columnview-isloading")}).then(z,function(){var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Fail to load data.");
q(f).adaptTo("foundation-ui").alert(a,b,"error")}))}},h=d.dataset.foundationCollectionSrc;h&&(b=t(d),D.set(b,{offset:b.querySelectorAll("coral-columnview-item").length,limit:e.limit||20,hasNext:"false"!==b.dataset.foundationLayoutColumnviewHasmore}),h=n(b,h),E.set(b,h),h.start());c.on("coral-columnview:loaditems",g);return function(){c.off("coral-columnview:loaditems",g)}}function n(b,c){return new (q(f).adaptTo("foundation-collection-lazyloader"))({scrollSrc:b.querySelector("coral-columnview-column-content"),
getItems:function(){return b.items.getAll()},load:function(d,e){d=a.expand(c,{offset:e.offset,limit:e.limit,id:b.dataset.foundationLayoutColumnviewColumnid});return q.ajax(d).then(function(a){return x(a)}).then(function(a){return a.items})},onReplace:function(){q(b).trigger("foundation-contentloaded")}})}function x(a){return q(f).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){a=q(a).children();a=a.is("coral-columnview-column")?a:a.find("coral-columnview-column").last();var b=a[0].dataset.foundationLayoutColumnviewHasmore,
c=null;"true"===b?c=!0:"false"===b&&(c=!1);return{items:a.find(".foundation-collection-item").toArray(),hasMore:c,meta:a.find(".foundation-collection-meta")[0]}})}function v(a,b){return q(f).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){a=q(a).children();return(a.is(b)?a:a.find(b).last())[0]})}function u(a,b,c,d){var e=b[0].dataset.foundationCollectionId||c.trackingElement||"";"navigate"===a&&d&&d.columnId?e=d.columnId:"change"===a&&(e=d&&d.parentColumnId?d.parentColumnId:"");b=
{};d&&d.method&&(b.method=d.method);a={element:e,type:"columnview",action:a,widget:{name:c.trackingElement||"",type:"columnview"},feature:c.trackingFeature||""};0<Object.keys(b).length&&(a.attributes=b);q(f).adaptTo("foundation-tracker").trackEvent(a)}function y(a,b,c){var d="coral-columnview-column";b&&(d+=", coral-columnview-preview");var e;q(a).children(d).each(function(){if(this.dataset.foundationLayoutColumnviewColumnid===c)return e=this,!1});return e}function t(a,b){return y(a,b,a.dataset.foundationCollectionId)}
function w(b,c){c=a.expand(b.collectionEl.dataset.foundationCollectionSrc,{offset:0,limit:b.config.limit||20,id:c});return q.ajax({url:c,cache:!1}).then(function(a){Granite.UI.Foundation.Layouts.cleanAll(b.collectionEl);return q(f).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){a=q(a).children();a.data("foundation-layout-collection.internal.columnviewLoaded",b.collection.data("foundation-layout-collection.internal.columnviewLoaded"));F.set(a[0],!0);a.replaceAll(b.collection);a.trigger("foundation-contentloaded");
return a[0]})},function(){var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Fail to load data.");q(f).adaptTo("foundation-ui").alert(a,b,"error")})}function r(b,c,d){var e=b.collection,g=b.config,h=y(b.collectionEl,!0,d),m=null,p=null;if(h&&h.previousElementSibling){var A=h.previousElementSibling;m=A.dataset.foundationLayoutColumnviewColumnid;A.activeItem&&(p=A.activeItem.dataset.foundationCollectionItemId)}A=D.get(h);var z=b.collectionEl.dataset.foundationCollectionSrc;A=a.expand(z,{offset:0,limit:A?
A.offset:g.limit||20,id:d});d=[];var C=q(e[0].selectedItems);1===C.length&&"single"!==b.collectionEl.dataset.foundationSelectionsMode&&d.push(k(b,C[0],!0));A=q.ajax({url:A,cache:!1}).then(function(a){return v(a,"coral-columnview-column").then(function(a){var d=q(a),f=q(e[0].selectedItems),k=f.map(function(){return this.dataset.foundationCollectionItemId}).toArray(),A=q(a).find(".foundation-collection-item").filter(function(){var a=0<=k.indexOf(this.dataset.foundationCollectionItemId);a&&q(this).attr("selected",
"").addClass("foundation-selections-item");return a});if(null===m||null===p||h.nodeName===a.nodeName&&a.querySelector("coral-columnview-item"))q(h).replaceWith(a);else return r(b,c,m).then(function(){e.data("foundation-layout-collection.internal.columnviewLoaded",!1);c.load(p);e.trigger("foundation-collection-reload");u("reload",e,g);e.trigger("foundation-selections-change");u("change",e,g,{method:"reloadParentColumn",parentColumnId:m})});D.set(a,{offset:d.find(".foundation-collection-item").length,
limit:g.limit||20,hasNext:"false"!==a.dataset.foundationLayoutColumnviewHasmore});d=n(a,z);E.set(a,d);d.start();e.trigger("foundation-collection-reload");u("reload",e,g);e.trigger("foundation-selections-change");u("change",e,g,{method:"reloadColumn",parentColumnId:p});l(e,!1,A,f)})},function(){var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Fail to load data.");q(f).adaptTo("foundation-ui").alert(a,b,"error")});d.push(A);return q.when.apply(null,d).then(function(){return b.collectionEl})}function B(a){a.forEach(function(a){a.set("selected",
!0,!0);a.classList.add("foundation-selections-item")})}var q=d;d=q(f).adaptTo("foundation-registry");var z=new WeakMap,D=new WeakMap,E=new WeakMap,F=new WeakMap;d.register("foundation.layouts",{name:"foundation-layout-columnview",doLayout:function(a,c){var d=q(a);if(d.hasClass("foundation-collection")&&!z.has(a)){var e={collectionEl:a,collection:d,config:c,bulkSelection:!1,stack:[]};z.set(a,e);u("init",d,c);var f=d.data("foundation-layout-collection-switcher.internal.selectionIds");f&&d.find(".foundation-collection-item").filter(function(){return 0<=
f.indexOf(this.dataset.foundationCollectionItemId)}).each(function(){q(this).attr("selected","").addClass("foundation-selections-item")});e.stack.push(b(e));e.stack.push(g(e));e.stack.push(h(e));e.stack.push(p(e));requestAnimationFrame(function(){l(d,!0);d.trigger("foundation-selections-change");u("change",d,c,{method:"init"})})}},clean:function(a,b){q(a).siblings(".granite-collection-loading-title-wrapper").remove();if(b=z.get(a))z.delete(a),Granite.UI.Foundation.Utils.everyReverse(b.stack,function(a){a&&
a();return!0});Granite.UI.Foundation.Layouts.clean(a)}});d.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-columnview.foundation-collection",adapter:function(a){var b=z.get(a),d=b.collection,g=b.config;d.data("foundation-layout-collection.internal.columnviewLoaded",!0);return{append:function(b){var c=t(a);if(c&&(q(c).children("coral-columnview-column-content").append(b).trigger("foundation-contentloaded"),b.length&&"true"===a.dataset.foundationSelectionsSelectallMode)){B(b.filter(":not(.is-lazyLoaded):not(.is-pending)").toArray());
var e=q.when();(c=E.get(c))&&(e=c.loadItems(b).then(function(a){B(a)}));e.then(function(){d.trigger("foundation-selections-change");u("change",d,g,{method:"append"})})}},clear:function(){var b=t(a);b&&b.items.clear()},getPagination:function(){var b=D.get(t(a));return b?{offset:b.offset,limit:b.limit,hasNext:b.hasNext,guessTotal:-1}:null},load:function(f){var h=d.find(".foundation-collection-item").filter(function(){return this.dataset.foundationCollectionItemId===f})[0];if(h)d.data("foundation-layout-collection.internal.columnviewLoaded")?
(d.trigger("foundation-collection-reload"),u("reload",d,g)):d.data("foundation-layout-collection.internal.columnviewLoaded",!0),h.click();else{var k=a.columns.getAll().find(function(a){return a.dataset.foundationLayoutColumnviewColumnid===f});if(!k)return w(b,f);h=e(b,function(){var a=q(d[0].selectedItems),b=q();k.items.getAll().forEach(function(a){a.selected=!1;a.active=!1});return{prevSelections:a,selections:b}});d.data("foundation-layout-collection.internal.columnviewLoaded")?(d.trigger("foundation-collection-reload"),
u("reload",d,g)):d.data("foundation-layout-collection.internal.columnviewLoaded",!0);c(d,f);d.trigger("foundation-collection-navigate");u("navigate",d,g,{columnId:f});d.trigger("foundation-selections-change");u("change",d,g,{method:"load"});l(d,!1,h.selections,h.prevSelections)}return q.when(a)},reload:function(){d.data("foundation-layout-collection.internal.columnviewLoaded",!0);return r(b,this,a.dataset.foundationCollectionId)}}}});d.register("foundation.adapters",{type:"foundation-collection-meta",
selector:".foundation-layout-columnview.foundation-collection",adapter:function(a){var b=function(){return q(t(a,!0)).find(".foundation-collection-meta")};return{getElement:function(){return b()[0]},getTitle:function(){var a=b();return a.length?a[0].dataset.foundationCollectionMetaTitle:null},getThumbnail:function(){var a=b();return a.length?a.children(".foundation-collection-meta-thumbnail")[0]:null},isFolder:function(){var a=b();return a.length?"true"===a[0].dataset.foundationCollectionMetaFolder:
!1},getRelationship:function(){var a=b();return a.length?a[0].dataset.foundationCollectionMetaRel:null}}}});d.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-columnview.foundation-collection",adapter:function(a){var b=z.get(a),c=b.collection,d=b.config;return{count:function(){if("true"===a.dataset.foundationSelectionsSelectallMode){var b=c.adaptTo("foundation-collection").getPagination();if(b&&-1!==b.guessTotal){var d=0,e=t(a);e&&(d=e.items.length-a.selectedItems.length);
return b.guessTotal-d}}return a.selectedItems.length},selectAll:function(g){var f=t(a),h=q(f),m=e(b,function(){var b=q(a.selectedItems),c=h.find(".foundation-collection-item:not(.foundation-selections-item):not(.is-lazyLoaded):not(.is-pending)");B(c.toArray());c=b.add(c);return{prevSelections:b,selections:c}});1===m.selections.length&&"single"!==a.dataset.foundationSelectionsMode?k(b,m.selections[0]):c.children("coral-columnview-preview").remove();var n=h.find(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending");
if(n.length){var p=q(document.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered /\x3e');p.appendTo(document.body);E.get(f).loadItems(n.toArray()).then(function(a){B(a);l(c,!1,c.find(".foundation-selections-item"),m.prevSelections);g||(c.trigger("foundation-selections-change"),u("change",c,d,{method:"selectAll"}));p.remove()})}else l(c,!1,m.selections,m.prevSelections),g||(c.trigger("foundation-selections-change"),u("change",c,d,{method:"selectAll"}))},
isAllSelected:function(){var b=t(a);if(b){var c=b.items.getAll().length;if(0<c&&(b="false"!==b.dataset.foundationLayoutColumnviewHasmore,c===a.selectedItems.length))return"true"===a.dataset.foundationSelectionsSelectallMode?!0:!b}return!1},clear:function(g){c.find(".foundation-selections-item").removeClass("foundation-selections-item");var f=e(b,function(){var b=q(a.selectedItems).prop("selected",!1),c=q();return{prevSelections:b,selections:c}});c.children("coral-columnview-preview").remove();l(c,
!1,f.selections,f.prevSelections);g||(c.trigger("foundation-selections-change"),u("change",c,d,{method:"clear"}))},select:function(a){q(a).hasClass("foundation-collection-item")&&(a.selected=!0)},deselect:function(a){q(a).hasClass("foundation-collection-item")&&(a.selected=!1)}}}})})(window,Granite.$,Granite.URITemplate);
(function(f,d,a,e,c){function b(a){var b=a.collection,c=function(c,d,e){c._foundationLayoutTable||"default"!==d||a.collectionEl.dataset.foundationModeGroup!==e||(a.bulkSelection=!0,b.find(".foundation-selections-item").each(function(a,b){b.selected=!1}),a.bulkSelection=!1,b.trigger("foundation-selections-change"),w("change",b,a.config,{method:"modeChange"}))};r(d).on("foundation-mode-change",c);return function(){r(d).off("foundation-mode-change",c)}}function h(a){var b=a.collection,c=a.collectionEl,
e=r(d.createElement("div")).addClass("foundation-ui-mask"),f=function(f){if(!a.bulkLoading){f=f.originalEvent.detail;var h=c.dataset.foundationSelectionsMode,l=r(),m=r();"single"===h?(f.oldSelection&&(m=r(f.oldSelection)),f.selection&&(l=r(f.selection))):(m=r(f.oldSelection),l=r(f.selection));m.removeClass("foundation-selections-item");l.addClass("foundation-selections-item");f="true"===c.dataset.foundationSelectionsSelectallMode;a.bulkSelection||f||(a.lazyLoader&&k(b)?(a.bulkLoading=!0,e.appendTo(d.body),
a.lazyLoader.loadItems(l.toArray()).then(function(c){var d=c.length-1;c.forEach(function(a,b){a.set("selected",!0,b!==d);a.classList.add("foundation-selections-item")});u(b);a.bulkLoading=!1;g(b,!1,l,m);b.trigger("foundation-selections-change");w("change",b,a.config,{method:"handleSelection"});e.detach()})):(g(b,!1,l,m),b.trigger("foundation-selections-change"),w("change",b,a.config,{method:"handleSelection"})))}},h=function(){(d.activeElement===c||c.contains(d.activeElement))&&b.adaptTo("foundation-selections").clear()};
b.on("coral-table:change",f);Coral.keys.on("escape",h);var l=b.find("[coral-table-select]").on("change.foundation-layout-table",function(a){a.stopPropagation();a=b.adaptTo("foundation-selections");this.checked?(c.dataset.foundationSelectionsSelectallMode="true",a.selectAll()):a.clear()});return function(){b.off("coral-table:change",f);Coral.keys.off("escape",h);l.off("change.foundation-layout-table")}}function g(a,b,c,d){var e=a[0].dataset.foundationModeGroup;if(e){c=c?c.length:a.adaptTo("foundation-selections").count();
d=d?d.length:0;var g=function(b){var c=r.Event("foundation-mode-change");c._foundationLayoutTable=!0;a.trigger(c,[b,e])};(0===d||b)&&0<c?g("selection"):(0<d||b)&&0===c&&g("default")}}function k(a){return 0<a.has(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending").length}function l(b){var d=b.collection,e=b.collectionEl,g=function(g){if("remote"===b.config.sortMode){var h=b.paginator;if(h&&(h.hasNext||k(d))){var l=g.originalEvent.detail,m=l.column,n=m.sortableType;m.sortableType=
"custom";var q=e.dataset.foundationCollectionSrc;g=m.dataset.foundationLayoutTableColumnName;a:{switch(l.direction||l.sortableDirection){case "ascending":l="asc";break a;case "descending":l="desc";break a;case "default":l=null;break a}l=void 0}b.paginatorSort={name:g,direction:l,originalSortType:n};q=c.expand(q,{offset:0,limit:h.limit,id:d[0].dataset.foundationCollectionId,sortName:g,sortDir:l});w("columnorder",d,b.config,{dir:l,column:g});r.ajax({url:q,cache:!1}).then(function(a){p(a).then(function(a){var b=
a.items,c=d.adaptTo("foundation-collection");c.clear();c.append(b);a=a.hasMore;void 0===a&&(a=b.length>=h.limit);h.restart(b.length,a);m.sortableType=n})},function(){var b=a.I18n.get("Error"),c=a.I18n.get("Fail to load data.");r(f).adaptTo("foundation-ui").alert(b,c,"error")})}}};d.on("coral-table:beforecolumnsort",g);return function(){d.off("coral-table:beforecolumnsort",g)}}function m(a){var b=a.collection,d=a.collectionEl,e=d.dataset.foundationCollectionSrc;if(e){var g=function(g){var h=r(f).adaptTo("foundation-util-paginator"),
k;a.paginator=new h({el:g[0],limit:a.config.limit||20,wait:function(){d.dataset.graniteCollectionIsLoading="true";return{clear:function(){d.dataset.graniteCollectionIsLoading="false"}}},resolveURL:function(b){var g=a.paginatorSort;return c.expand(e,{offset:b.offset,limit:b.limit,id:d.dataset.foundationCollectionId,sortName:g?g.name:void 0,sortDir:g?g.direction:void 0})},processResponse:function(c,e){var g=r.Deferred();d.dataset.graniteCollectionIsLoading="true";p(e).then(function(e){var f=e.items;
k=r.Deferred();n(a,b,a.config,f,k.promise());e=e.hasMore;void 0===e&&(e=f.length>=c.limit);d.dataset.graniteCollectionIsLoading="false";g.resolve({length:f.length,hasNext:e})});return g.promise()},onNewPage:function(){b.trigger("foundation-collection-newpage");w("newpage",b,a.config);k.resolve()}});h=b.find(".foundation-collection-item").length;a.paginator.start(h,"false"!==d.dataset.foundationLayoutTableHasmore,!1,1E3);h=r(f).adaptTo("foundation-collection-lazyloader");a.lazyLoader=new h({scrollSrc:g[0],
getItems:function(){return d.items.getAll()},load:function(b,g){b=a.paginatorSort;g=c.expand(e,{offset:g.offset,limit:g.limit,id:d.dataset.foundationCollectionId,sortName:b?b.name:void 0,sortDir:b?b.direction:void 0});return r.ajax(g).then(function(a){return p(a)}).then(function(a){return a.items})},onReplace:function(){t(b);b.trigger("foundation-contentloaded")},setupListeners:function(a,c){b.on("foundation-collection-navigate",c);b.on("coral-table:columnsort",c);return function(){b.off("foundation-collection-navigate",
c);b.off("coral-table:columnsort",c)}}});a.lazyLoader.start()},h=b.children("[coral-table-scroll]");h.length?g(h):requestAnimationFrame(function(){g(b.children("[coral-table-scroll]"))});return function(){a.paginator&&a.paginator.destroy();a.lazyLoader&&a.lazyLoader.destroy()}}}function p(a){return r(f).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){var b=r(a).children();if(b.hasClass("foundation-collection"))return a=b.find(".foundation-collection-item").toArray(),b=b[0].dataset.foundationLayoutTableHasmore,
"true"===b?b=!0:"false"===b&&(b=!1),{items:a,hasMore:b}})}function n(a,b,c,d,e){b.find("tbody").append(d);if(d.length&&"true"===b[0].dataset.foundationSelectionsSelectallMode){d.forEach(function(a){a.classList.contains("is-lazyLoaded")||a.classList.contains("is-pending")||(a.set("selected",!0,!0),a.classList.add("foundation-selections-item"))});var g=r.when();a.lazyLoader&&(g=a.lazyLoader.loadItems(d).then(function(a){t(b);u(b);y(b);a.forEach(function(a){a.set("selected",!0,!0);a.classList.add("foundation-selections-item")})}));
r.when(g,e).then(function(){b.trigger("foundation-selections-change");w("change",b,c,{method:"append"})})}t(b);u(b);y(b);b.trigger("foundation-contentloaded")}function x(a){var b=a.collection,c=function(a){b.adaptTo("foundation-collection-item-action").execute(a)},d=function(a){var b=r(a.target).closest("[coral-table-rowselect], button, a, .foundation-collection-item");b.hasClass("foundation-layout-table-cellwrapper")?1!==a.which||a.metaKey||a.shiftKey||a.altKey||(a.preventDefault(),c(b.closest(".foundation-collection-item")[0])):
b.hasClass("foundation-collection-item")&&(a.preventDefault(),c(b[0]))};b.on("click",".foundation-collection-item",d);return function(){b.off("click",".foundation-collection-item",d)}}function v(b){var d=b.collection,e=function(e){var g=e.originalEvent.detail,h=g.row;e=g.before;var k=g.oldBefore;if(g=b.config.rowReorderAction){var l=(e=e?e.dataset.foundationCollectionItemId:void 0)?e.substring(e.lastIndexOf("/")+1):void 0;l=g=c.expand(g,{item:h.dataset.foundationCollectionItemId,before:e,beforeName:l});
var m=g.indexOf("?");if(0<=m){l=g.substring(0,m);var n=g.substring(m+1)}w("roworder",d,b.config,{before:e});var p=r(f).adaptTo("foundation-ui");p.wait();r.ajax({url:l,method:"POST",data:n}).always(function(){p.clearWait();d.trigger("foundation-collection-reload");w("reload",d,b.config)}).fail(function(){var b=a.I18n.get("Error"),c=a.I18n.get("Fail to reorder.");p.alert(b,c,"error");k?r(h).insertBefore(k):h.parentElement.appendChild(h)})}};d.on("coral-table:roworder",e);return function(){d.off("coral-table:roworder",
e)}}function u(a){a.find("col[is\x3dcoral-table-column]").each(function(b,c){b+=1;var d=c.getAttribute("alignment");a.find("th[is\x3dcoral-table-headercell]:nth-child("+b+"), td[is\x3dcoral-table-cell]:nth-child("+b+")").each(function(){var a=this.getAttribute("alignment");a&&"column"!==a||this.setAttribute("alignment",d)})})}function y(a){a.find("td[is\x3dcoral-table-cell][coral-table-rowselect]").length&&a.attr("variant","list")}function t(a){var b=d.querySelector(".granite-collection-pagetitle");
a.find("tr.foundation-collection-navigator").each(function(){var e=r(this);e.children("td:not([coral-table-rowselect]):not(:has([coral-table-rowselect]))").first().wrapInner(function(){if(!r(this).find("a").length){var g=d.createElement("a");g.className="foundation-layout-table-cellwrapper";var f=e[0].dataset.foundationCollectionNavigatorHref;if(f)g.target=e[0].dataset.foundationCollectionNavigatorTarget;else{if(!b||!a.is(b.dataset.graniteCollectionPagetitleTarget))return;f=c.expand(b.dataset.graniteCollectionPagetitleSrc,
{id:e.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})}g.href=f;return r(g)}})})}function w(a,b,c,d){var e="table",g=b[0].dataset.foundationCollectionId||c.trackingElement||"";"change"===a?(e="table-row",0===b.find(".foundation-selections-item").length&&(g="")):"roworder"===a?e="table-row":"columnorder"===a&&(e="table-column",g=d.column);a={element:g,type:e,action:a,widget:{name:c.trackingElement||"",type:"table"},feature:c.trackingFeature||""};d&&0<Object.keys(d).length&&
(a.attributes=d);r(f).adaptTo("foundation-tracker").trackEvent(a)}var r=e;e=r(f).adaptTo("foundation-registry");var B=new WeakMap;e.register("foundation.layouts",{name:"foundation-layout-table",doLayout:function(a,c){var d=r(a);if(d.hasClass("foundation-collection")&&!B.has(a)){var e={collectionEl:a,collection:d,config:c,stack:[],bulkSelection:!1,bulkLoading:!1};B.set(a,e);if(e.collectionEl.hasAttribute("selectable")){var f=d.data("foundation-layout-collection-switcher.internal.selectionIds");f&&
d.find(".foundation-collection-item").filter(function(){return 0<=f.indexOf(this.dataset.foundationCollectionItemId)}).each(function(){r(this).attr("selected","").addClass("foundation-selections-item")})}var k=d.find("[data-foundation-layout-table-column-name]").toArray();a=k.map(function(a){return a.dataset.foundationLayoutTableColumnName}).join(",");k=k.filter(function(a){return a.hidden}).map(function(a){return a.dataset.foundationLayoutTableColumnName}).join(",");w("init",d,c,{columns:a,hiddenColumns:k});
e.stack.push(b(e));e.stack.push(h(e));e.stack.push(l(e));e.stack.push(m(e));e.stack.push(x(e));e.stack.push(v(e));t(d);y(d);u(d);requestAnimationFrame(function(){g(d,!0);d.trigger("foundation-collection-newpage");w("newpage",d,c);d.trigger("foundation-selections-change");w("change",d,c,{method:"init"})})}},clean:function(b,c){if(c=B.get(b))B.delete(b),a.UI.Foundation.Utils.everyReverse(c.stack,function(a){a&&a();return!0});a.UI.Foundation.Layouts.clean(b)}});e.register("foundation.adapters",{type:"foundation-collection",
selector:".foundation-layout-table.foundation-collection",adapter:function(b){var d=B.get(b),e=d.collection,g=d.collectionEl,h=d.config,k=function(b,d,k){var l=g.dataset.foundationCollectionSrc;d||(d=h&&h.limit||20);b=c.expand(l,{offset:0,limit:d,id:b});return r.ajax({url:b,cache:!1}).then(function(b){var c=r.Deferred();r(f).adaptTo("foundation-util-htmlparser").parse(b).then(function(b){var d=r(b).children();d.hasClass("foundation-collection")?(k&&(b=e.find(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId}).toArray(),
d.data("foundation-layout-collection-switcher.internal.selectionIds",b)),e.trigger("foundation-collection-reload"),w("reload",e,h),d.data("foundation-layout-collection.internal.columnviewLoaded",!0),a.UI.Foundation.Layouts.cleanAll(g),d.replaceAll(e),requestAnimationFrame(function(){d.trigger("foundation-collection-navigate");w("navigate",e,h)}),d.trigger("foundation-contentloaded"),k&&d.removeData("foundation-layout-collection-switcher.internal.selectionIds"),c.resolve(d[0])):c.reject(Error("Invalid content"))});
return c.promise()},function(){var b=a.I18n.get("Error"),c=a.I18n.get("Fail to load data.");r(f).adaptTo("foundation-ui").alert(b,c,"error")})};return{append:function(a){n(d,e,h,a)},clear:function(){e.find(".foundation-collection-item").remove()},getPagination:function(){var a=d.paginator;if(!a)return null;var b=parseInt(e.attr("data-foundation-layout-table-guesstotal")||"-1",10);return{offset:a.offset,limit:a.limit,guessTotal:-1===b?b:Math.max(a.offset,b),hasNext:-1===b?a.hasNext:a.offset>=b?a.hasNext:
null}},load:function(a){return k(a)},reload:function(){var a=this.getPagination();if(a)var b=a.offset;return k(g.dataset.foundationCollectionId,b,!0)}}}});e.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-table.foundation-collection",adapter:function(a){var b=r(a).find("\x3e caption \x3e .foundation-collection-meta"),c=b[0];return c?{getElement:function(){return c},getTitle:function(){return c.dataset.foundationCollectionMetaTitle},getThumbnail:function(){return b.children(".foundation-collection-meta-thumbnail")[0]},
isFolder:function(){return"true"===c.dataset.foundationCollectionMetaFolder},getRelationship:function(){return c.dataset.foundationCollectionMetaRel}}:null}});e.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-table.foundation-collection",adapter:function(a){var b=B.get(a),c=b.collection,e=b.collectionEl,f=b.config;return{count:function(){if("true"===e.dataset.foundationSelectionsSelectallMode){var a=c.adaptTo("foundation-collection").getPagination();if(a&&
-1!==a.guessTotal){var b=c.find(".foundation-collection-item:not(.foundation-selections-item)").length;return a.guessTotal-b}}return c.find(".foundation-selections-item").length},selectAll:function(a){b.bulkSelection=!0;var e=c.find(".foundation-selections-item"),h=c.find(".foundation-collection-item:not(.foundation-selections-item):not(.is-lazyLoaded):not(.is-pending)").each(function(a){0<a&&this.set("selected",!0,!0)}),k=e.add(h),l=c.find(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending");
if(l.length){var m=r(d.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered /\x3e');m.appendTo(d.body);b.lazyLoader.loadItems(l.toArray()).then(function(d){d.forEach(function(a){a.set("selected",!0,!0);a.classList.add("foundation-selections-item")});h.first().prop("selected",!0);b.bulkSelection=!1;g(c,!1,c.find(".foundation-selections-item"),e);a||(c.trigger("foundation-selections-change"),w("change",c,f,{method:"selectAll"}));m.detach()})}else h.first().prop("selected",
!0),b.bulkSelection=!1,g(c,!1,k,e),a||(c.trigger("foundation-selections-change"),w("change",c,f,{method:"selectAll"}))},isAllSelected:function(){var a="true"===e.dataset.foundationSelectionsSelectallMode,b=c.adaptTo("foundation-collection").getPagination();b=b?b.hasNext:!1;var d=c.find(".foundation-collection-item").length,g=c.find(".foundation-selections-item").length;return 0<d&&d===g?a?!0:!b:!1},clear:function(a){b.bulkSelection=!0;var d=c.find(".foundation-selections-item").each(function(a){0<
a&&this.set("selected",!1,!0)});d.first().prop("selected",!1);b.bulkSelection=!1;g(c,!1,r(),d);a||(c.trigger("foundation-selections-change"),w("change",c,f,{method:"selectAll"}))},select:function(a){r(a).hasClass("foundation-collection-item")&&(a.selected=!0)},deselect:function(a){r(a).hasClass("foundation-collection-item")&&(a.selected=!1)}}}})})(window,document,Granite,Granite.$,Granite.URITemplate);
(function(f,d,a){function e(a){if(a&&a.getLabelledBy)return a.getLabelledBy()}d(f).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:".foundation-layout-actionfield-field",show:function(c,b){var f=d(c),g=f.closest(".coral-Form-field");(c=f.adaptTo("foundation-field"))&&c.setInvalid&&c.setInvalid(!0);g.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly");var k=f.data("foundation-validation.internal.error");if(k){var l=d(k).data("foundation-validation.internal.error.tooltip");
l.content.innerHTML=b;k.parentNode||(f.after(k,l),b=e(c),l=l.id,c&&c.setLabelledBy&&c.setLabelledBy(b?b+" "+l:l))}else k=new a.Icon,k.icon="alert",k.classList.add("coral-Form-fielderror"),l=new a.Tooltip,l.variant="error",l.placement=g.closest("form").hasClass("coral-Form--vertical")?"left":"bottom",l.target=k,l.content.innerHTML=b,l.id=a.commons.getUID(),d(k).data("foundation-validation.internal.error.tooltip",l),k.setAttribute("aria-labelledby",l.id),k.setAttribute("tabindex",0),f.data("foundation-validation.internal.error",
k),f.after(k,l),b=e(c),l=l.id,c&&c.setLabelledBy&&c.setLabelledBy(b?b+" "+l:l)},clear:function(a){var b=d(a);a=b.closest(".coral-Form-field");var c=b.adaptTo("foundation-field");c&&c.setInvalid&&c.setInvalid(!1);if(b=b.data("foundation-validation.internal.error")){var g=d(b).data("foundation-validation.internal.error.tooltip");g.hide();g.remove();b.remove();(b=e(c))&&-1!==b.indexOf(g.id)&&(b=b.split(" ").filter(function(a){return a!==g.id}).join(" "),c&&c.setLabelledBy&&c.setLabelledBy(b))}a.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")}})})(window,
Granite.$,Coral);
(function(f,d,a){var e=a(f).adaptTo("foundation-registry"),c=Granite.UI.Foundation.Utils.debounce;a(d).on("foundation-contentloaded",function(b){a(".foundation-layout-panel-rail-activate-panel").each(function(){a(this).removeClass("foundation-layout-panel-rail-activate-panel").find("coral-panel[selected]").trigger("foundation-toggleable-show")});a(".foundation-container-resizable").each(function(){var b=a(this),d=this.parentElement,e=b.adaptTo("foundation-container-resizable"),f=b.next(".foundation-layout-panel-content"),
m=new Number(f[0].dataset.graniteLayoutContentMinWidth);isNaN(m)||(e.maxWidth=Math.max(e.minWidth,d.offsetWidth-m),e.initialize());e.registerEvent(this,"foundation-toggleable-show",function(){b.css("margin-left",0)},!0);e.registerEvent(this,"foundation-toggleable-hide",function(){b.css("margin-left",-e.width)},!0);var p=this.dataset.graniteLayoutPanelSaveKey;p&&e.registerEvent(this,"foundation-resize-end",function(){a.cookie(p,e.width,{expires:7,path:"/"})});var n=c(function(){a.cookie(p,e.width,
{expires:7,path:"/"})},200),x=function(){requestAnimationFrame(function(){var a=f.width();a<=m&&(e.setWidth(a-m),n());e.maxWidth=Math.max(e.minWidth,d.offsetWidth-m)})};x();Coral.commons.addResizeListener(f[0],x)})});e.register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-layout-panel-rail.foundation-toggleable",adapter:function(b){var c=a(b);return{isOpen:function(){return b.classList.contains("foundation-layout-panel-rail-active")},show:function(a){b.classList.add("foundation-layout-panel-rail-active");
c.trigger("foundation-toggleable-show")},hide:function(){b.classList.remove("foundation-layout-panel-rail-active");c.find("\x3e coral-panelstack \x3e coral-panel.foundation-layout-panel-rail-panel[selected]").prop("selected",!1).trigger("foundation-toggleable-hide");c.trigger("foundation-toggleable-hide")}}}});e.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-panel.foundation-layout-panel-rail-panel.foundation-toggleable",adapter:function(b){var c=a(b);return{isOpen:function(){return b.selected&&
c.closest(".foundation-layout-panel-rail").adaptTo("foundation-toggleable").isOpen()},show:function(d){d=c.parent("coral-panelstack")[0].selectedItem;b.selected=!0;var e=c.closest(".foundation-layout-panel-rail");e.addClass("foundation-layout-panel-rail-active");d&&a(d).trigger("foundation-toggleable-hide");c.trigger("foundation-toggleable-show");e.trigger("foundation-toggleable-show")},hide:function(){b.selected=!1;var a=c.closest(".foundation-layout-panel-rail");a.removeClass("foundation-layout-panel-rail-active");
c.trigger("foundation-toggleable-hide");a.trigger("foundation-toggleable-hide")}}}});a(d).on("foundation-toggleable-show","coral-panel.foundation-layout-panel-rail-panel",function(b){if(b=this.dataset.foundationLayoutPanelRailPanelSrc){var c=a(this);c.data("foundation-layout-panel-rail-panel.internal.loaded")||(c.data("foundation-layout-panel-rail-panel.internal.loaded",!0),a.ajax({url:b,cache:!1}).done(function(b){a(f).adaptTo("foundation-util-htmlparser").parse(b).then(function(b){a(c[0].content).html("").append(b);
c.trigger("foundation-contentloaded")})}).fail(function(){var b=Granite.I18n.get("Error"),c=Granite.I18n.get("Something went wrong.");a(f).adaptTo("foundation-ui").alert(b,c,"error")}))}})})(window,document,Granite.$);
(function(f,d,a){function e(a,c,d,e){this.container=a;this.active=!0;this.width=a.offsetWidth;this.minWidth=d||-1;this.maxWidth=e||Number.MAX_VALUE;this.listeners=[];this.resizeHandle=c;this._dragFn=this.drag.bind(this);this._endDragFn=this.endDrag.bind(this)}var c=a(f).adaptTo("foundation-registry");e.prototype.setWidth=function(a){this.width=Math.min(Math.max(this.minWidth,this.width+a),this.maxWidth);this.container.style.width=this.width+"px"};e.prototype.getEventPageX=function(a){if(a.pageX)return a.pageX;
if(a.touches&&a.touches.length)return a.touches[0].pageX};e.prototype.startDrag=function(a){this.active&&(a.stopPropagation(),this.addMoveListeners(),this.lastX=this.getEventPageX(a),d.body.classList.add("u-coral-closedHand"),this.container.classList.add("is-dragging"))};e.prototype.endDrag=function(a){this.drag(a);this.container.dispatchEvent(new CustomEvent("foundation-resize-end",{bubbles:!0}));this.removeMoveListeners();d.body.classList.remove("u-coral-closedHand");this.container.classList.remove("is-dragging")};
e.prototype.drag=function(a){this.active&&(a.stopPropagation(),requestAnimationFrame(function(){var b=Math.min(this.getEventPageX(a),f.outerWidth);this.setWidth(b-this.lastX);this.lastX=b}.bind(this)))};e.prototype.initialize=function(){this._initialized||(this.resizeHandle&&(this.registerEvent(this.resizeHandle,"mousedown",this.startDrag.bind(this)),this.registerEvent(this.resizeHandle,"touchstart",this.startDrag.bind(this))),this._initialized=!0)};e.prototype.addMoveListeners=function(){f.addEventListener("mouseup",
this._endDragFn);f.addEventListener("mousemove",this._dragFn);f.addEventListener("touchup",this._endDragFn);f.addEventListener("touchmove",this._dragFn)};e.prototype.removeMoveListeners=function(){f.removeEventListener("mousemove",this._dragFn);f.removeEventListener("mouseup",this._endDragFn);f.removeEventListener("touchup",this._endDragFn);f.removeEventListener("touchmove",this._dragFn)};e.prototype.dispose=function(){this.listeners.each(function(b){b.elem&&(b.useJquery?a(b.elem).off(b.eventName,
b.callback):b.elem.removeEventListener(b.eventName,b.callback))});this.container=this.resizeHandle=this.listeners=null};e.prototype.registerEvent=function(b,c,d,e){this.listeners.push({elem:b,eventName:c,callback:d,useJquery:e});e?a(b).on(c,d):b.addEventListener(c,d)};c.register("foundation.adapters",{type:"foundation-container-resizable",selector:".foundation-container-resizable",adapter:function(a){var b=new Number(a.dataset.graniteLayoutPanelMinWidth),c=a.querySelector(".foundation-container-resizable-handle");
isNaN(b)&&(b=-1);if(c&&("ontouchstart"in f||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints)){var k=d.createElement("div");k.classList.add("foundation-container-resizable-handle-drag");c.appendChild(k)}return new e(a,c,b)}})})(window,document,Granite.$);
(function(f,d){function a(a){var b=a.data("foundationAdvancedselectControlSrc");if(b){var c=a.closest(".foundation-advancedselect");if(c.length){var g=d(window).adaptTo("foundation-ui");g.wait();var f=c.find(".foundation-advancedselect-navigator"),h=c.find(".foundation-advancedselect-collection");d.ajax(b).done(function(a){d(window).adaptTo("foundation-util-htmlparser").parse(a).then(function(a){a=d(a.querySelectorAll(".foundation-advancedselect"));var b=a.find(".foundation-advancedselect-navigator");
f.replaceWith(b);var k=h.adaptTo("foundation-collection");c.data("foundation-advancedselect.internal.ignoreselectionevent",!0);k.clear();k.append(a.find(".foundation-collection-item").toArray());c.removeData("foundation-advancedselect.internal.ignoreselectionevent");e(c,b,h);c.trigger("foundation-contentloaded");g.clearWait()})}).fail(function(){g.clearWait();var a=Granite.I18n.get("Error"),b=Granite.I18n.get("Something went wrong.");g.alert(a,b,"error")})}}}function e(a,b,c){b=b.data("foundationAdvancedselectNavigatorPath").toString();
(b=(a.data("foundation-advancedselect.internal.values")||{})[b])&&b.each(function(b,e){a.find(".foundation-collection-item[data-foundation-collection-item-id]").each(function(){d(this).data("foundationCollectionItemId")===e.value&&c.adaptTo("foundation-selections").select(this)})})}function c(a,b){var c=a.find(".foundation-advancedselect-navigator");c=c.length?c.data("foundationAdvancedselectNavigatorPath").toString():"_default";var e=a.data("foundation-advancedselect.internal.values");e||(e={},a.data("foundation-advancedselect.internal.values",
e));e[c]&&e[c].remove();var g=a.data("foundationAdvancedselectName");a=a.find(".foundation-advancedselect-collection .foundation-selections-item").map(function(){var a=d(this),c=a.data("foundationCollectionItemId");c?a=d(f.createElement("input")).prop("type","hidden").prop("name",g).prop("value",c):(a=a.find("input.aria-value[type\x3dhidden]").clone(),a.prop("disabled",!1),g&&!a.prop("name")&&a.prop("name",g));return a.appendTo(b)[0]});e[c]=a}d(f).on("click",".foundation-advancedselect-control",function(b){b.preventDefault();
b=d(this);"foundation.navigate"===b.data("foundationAdvancedselectControlAction")&&a(b)});d(f).on("foundation-selections-change",".foundation-advancedselect",function(a){a=d(this);if(!a.data("foundation-advancedselect.internal.ignoreselectionevent")){var b=a.find(".foundation-advancedselect-values");c(a,b);var e=a.find(".foundation-advancedselect-status");e.length&&(b=e.data("foundationAdvancedselectStatusTemplate").replace("{{count}}",b.children().length),e.html(b));if(a=a.adaptTo("foundation-validation"))a.checkValidity(),
a.updateUI()}});var b=d(window).adaptTo("foundation-registry");b.register("foundation.validation.selector",{submittable:".foundation-advancedselect",candidate:".foundation-advancedselect",exclude:".foundation-advancedselect *"});var h;b.register("foundation.validation.validator",{selector:".foundation-advancedselect",validate:function(a){if("true"===a.getAttribute("aria-required")&&0===d(a).find(".foundation-advancedselect-values \x3e *").length)return h||(h=Granite.I18n.get("Please fill out this field.")),
h}})})(document,Granite.$);
(function(f,d){function a(a){a=a.children(":not(.foundation-nestedcheckboxlist)");return a.is("input:checkbox:not([disabled])")?a:a.find("input:checkbox:not([disabled])")}function e(c,b){var f=c.closest(".foundation-nestedcheckboxlist").closest("li.foundation-nestedcheckboxlist-item");if(f.length){c=Array.prototype.every.call(c.siblings("li.foundation-nestedcheckboxlist-item"),function(c){return a(d(c)).is(":checked")===b});var g=a(f),k=g.prop("indeterminate");c?k&&(g.prop({indeterminate:!1,checked:b}),
e(f,b)):k||(g.prop({indeterminate:!0,checked:!1}),e(f,b))}}d(f).on("change",".foundation-nestedcheckboxlist-item",function(a){a.stopPropagation();var b=d(this);if(!0!==b.closest(".foundation-nestedcheckboxlist").data("foundation-nestedcheckboxlist-disconnected")){a=d(a.target).prop("checked");var c=b.find(".foundation-nestedcheckboxlist");c.length&&!0===c.data("foundation-nestedcheckboxlist-disconnected")||(b.find("ul input:checkbox").prop({indeterminate:!1,checked:a}),e(b,a))}})})(document,Granite.$);
(function(f,d,a){d(f).on("foundation-contentloaded",function(e){d(".betty-ActionBar",e.target).each(function(){var c=d(this);c.data("betty-ActionBar.internal.init")||(c.data("betty-ActionBar.internal.init",!0),a.commons.ready(this,function(){a.commons.addResizeListener(this,function(a){360>=c.width()?c.addClass("betty-ActionBar--collapsed"):c.removeClass("betty-ActionBar--collapsed");this._onLayout()})}.bind(this)))})})})(document,Granite.$,Coral);
(function(f,d,a){var e=d(window).adaptTo("foundation-util-propertybuilder"),c=d(window).adaptTo("foundation-tracker"),b=Object.create(HTMLElement.prototype);b.createdCallback=function(){var b=this;this._icon=(new a.Icon).set({icon:this.icon,size:"S"});this._icon.classList.add("betty-breadcrumbs-button-icon");this._buttonText=f.createElement("span");var e=(new a.Icon).set({icon:"chevronDown",size:"XS"});e.classList.add("betty-breadcrumbs-button-chevron");this._button=new a.Button;this._button.setAttribute("variant",
"quiet");this._button.classList.add("betty-breadcrumbs-button");this._button.type="button";this._button.autocomplete="off";this._button.tracking="off";this._button.setAttribute("aria-haspopup","true");var h=f.createElement("span");h.className="betty-breadcrumbs-button-innerwrapper";this._button.label.appendChild(h);h.appendChild(this._icon);h.appendChild(this._buttonText);h.appendChild(e);this._selectListEl=new a.SelectList;this._selectListEl.tracking="off";var m=!1;this._selectListEl.on("coral-selectlist:change",
function(a){var e=a.detail.selection;if(m)m=!1;else if(a=d(e).data("betty-breadcrumbs.internal.targetItem"),m=!0,requestAnimationFrame(function(){e.selected=!1}),p.open=!1,!a.selected){a.selected=!0;var g=f.createEvent("HTMLEvents");g.initEvent("change",!0,!1);b.dispatchEvent(g);c.trackEvent({element:a.trackingElement||a.textContent.trim(),type:"breadcrumbs-item",action:"change",widget:{name:b.trackingElement,type:"breadcrumbs"},feature:b.trackingFeature})}});var p=(new a.Popover).set({target:this._button,
alignMy:"center top",alignAt:"center top",tracking:"off"});p.classList.add("betty-breadcrumbs-popover");p.content.appendChild(this._selectListEl);p.on("coral-overlay:beforeopen",function(){b._updateSelectList()});p.on("coral-overlay:open",function(){var a=b.selectedItem;a=a?a.trackingElement||a.textContent.trim():"";c.trackEvent({element:a,type:"breadcrumbs-popover",action:"open",widget:{name:b.trackingElement,type:"breadcrumbs"},feature:b.trackingFeature})});p.on("coral-overlay:close",function(){var a=
b.selectedItem;a=a?a.trackingElement||a.textContent.trim():"";c.trackEvent({element:a,type:"breadcrumbs-popover",action:"close",widget:{name:b.trackingElement,type:"breadcrumbs"},feature:b.trackingFeature})});this.insertBefore(p,this.firstChild);this.insertBefore(this._button,this.firstChild);this._isItemDirty=!0};b.attributeChangedCallback=function(a,b,c){"icon"===a&&(this._icon.icon=c)};Object.defineProperties(b,{icon:e.createAttrBasedProperty("icon",""),selectedItem:{get:function(){var a=null;
d(this).children("betty-breadcrumbs-item").each(function(){if(this.selected)return a=this,!1});return a}},trackingFeature:e.createAttrBasedProperty("trackingfeature",""),trackingElement:e.createAttrBasedProperty("trackingelement","")});b._onItemAttached=function(a){this._isItemDirty=!0;a.selected?this._onSelect(a):this.selectedItem||(a.selected=!0);this._updateButtonDisability()};b._onItemDetached=function(a){this._isItemDirty=!0;a.selected&&this._onUnselect(a);this._updateButtonDisability()};b._onSelect=
function(a){d(this).children("betty-breadcrumbs-item").not(a).each(function(){this._selected=!1});this._updateButtonText(a)};b._onUnselect=function(a){d(this).children("betty-breadcrumbs-item").not(a).first().prop("selected",!0)};b._onButtonTextChange=function(a){this._isItemDirty=!0;this.selectedItem===a&&this._updateButtonText(a)};b._updateButtonDisability=function(){this._button.disabled=1>=d(this).children("betty-breadcrumbs-item").length};b._updateButtonText=function(a){this._buttonText.textContent=
a.textContent};b._updateSelectList=function(){if(this._isItemDirty){var b=this._selectListEl;b.items.clear();d(this).children("betty-breadcrumbs-item").each(function(){var c=new a.SelectList.Item;c.classList.add("betty-breadcrumbs-selectlist-item");c.content.textContent=this.textContent;d(c).data("betty-breadcrumbs.internal.targetItem",this);b.items.add(c)});this._isItemDirty=!1}};b=f.registerElement("betty-breadcrumbs",{prototype:b});var h=Object.create(HTMLElement.prototype);h.createdCallback=function(){this._selected=
!1;this._watchDescendants()};h.attachedCallback=function(){d(this.parentElement).is("betty-breadcrumbs")&&(this._parent=this.parentElement,this._parent._onItemAttached(this))};h.detachedCallback=function(){this._parent&&this._parent._onItemDetached(this);this._parent=null};Object.defineProperties(h,{selected:{get:function(){return this._selected},set:function(a){!!a!==this._selected&&(this._selected=!!a,this._parent&&(this._selected?this._parent._onSelect(this):this._parent._onUnselect(this)))}},
trackingElement:e.createAttrBasedProperty("trackingelement","")});h._watchDescendants=function(){var a=this;(new MutationObserver(function(b){a._parent&&a._parent._onButtonTextChange(a)})).observe(this,{childList:!0})};b.Item=f.registerElement("betty-breadcrumbs-item",{prototype:h})})(document,Granite.$,Coral,Granite);
(function(f,d){d(f).on("click",".granite-collection-deselect",function(a){a.preventDefault();(a=this.dataset.graniteCollectionDeselectTarget)&&d(a).adaptTo("foundation-selections").clear()})})(document,Granite.$);
(function(f,d,a){function e(a,c){var b=c[0].dataset.foundationCollectionId;b.startsWith("parentof:")&&(b=b.substring(9));var e=a.children("betty-breadcrumbs-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===b});if(e.length)e.prop("selected",!0),e.prevAll("betty-breadcrumbs-item").remove();else{e=c.find(".foundation-collection-item").filter(function(){return this.dataset.foundationCollectionItemId===b});if(e.length){var h=e.closest("coral-columnview-column")[0].dataset.foundationLayoutColumnviewColumnid;
var m=a.children("betty-breadcrumbs-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===h})}if(h&&m&&0!==m.length){var p=m.prev("betty-breadcrumbs-item");c=function(a,b){a.textContent=d(b).find(".foundation-collection-item-title").text();a.dataset.graniteCollectionNavigatorCollectionid=b.dataset.foundationCollectionItemId;a.selected=!0};if(p.length)c(p[0],e[0]),p.prevAll("betty-breadcrumbs-item").remove();else{p=f.createElement("betty-breadcrumbs-item");var n=d(p);
c(p,e[0]);m.before(p);n.prevAll("betty-breadcrumbs-item").remove()}}else{m=null;e=a.children("betty-breadcrumbs-item").last();var x=e[0].textContent,v=e[0].dataset.graniteCollectionNavigatorCollectionid;e=null;a.children("betty-breadcrumbs-item").remove();var u=c.children("coral-columnview-column");u.each(function(b,c){if(b<u.length-1){var e=u[b+1];b=f.createElement("betty-breadcrumbs-item");var g=d(b);c=d(c).find(".foundation-collection-item[data-foundation-collection-item-id\x3d'"+e.dataset.foundationLayoutColumnviewColumnid+
"']");c.length&&(b.textContent=c.find(".foundation-collection-item-title").text(),b.dataset.graniteCollectionNavigatorCollectionid=c[0].dataset.foundationCollectionItemId);null!==m?m.before(b):a.append(g);m=g}else m&&m.length&&(m[0].selected=!0),b=f.createElement("betty-breadcrumbs-item"),b.textContent=x,b.dataset.graniteCollectionNavigatorCollectionid=v,a.append(b)})}}}function c(a,c){var b=c[0].dataset.foundationCollectionId,e=a.children("betty-breadcrumbs-item"),h=e.filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===
b});if(h.length)h.prop("selected",!0),h.prevAll("betty-breadcrumbs-item").remove();else{h=function(a,b,c){var d=f.createElement("betty-breadcrumbs-item");d.textContent=a;d.dataset.graniteCollectionNavigatorCollectionid=b;d.selected=c;return d};var m=d(".shell-collectionpage-tree");if(m.length&&(m=m[0].getParentIdTree(b))){var p=!1,n=0;m.length-1<e.length&&(p=!0);if(!p){var x=m.slice(0).reverse();x.shift();for(n=0;n<m.length-1;++n)if(x[n].id!==e[n].dataset.graniteCollectionNavigatorCollectionid){p=
!0;break}}if(p){for(n=0;n<e.length-1;++n)d(e[n]).remove();a=e[e.length-1];for(n=1;n<m.length;++n){var v=h(m[n].title,m[n].id);d(a).before(v);a=v}v.selected=!0;return}}if(v=c.adaptTo("foundation-collection-meta"))h=h(v.getTitle(),b,!0),a.children("betty-breadcrumbs-item:first-of-type").before(h)}}d(f).on("change","betty-breadcrumbs.granite-collection-navigator",function(a){var b=this.selectedItem,c=d(this.dataset.graniteCollectionNavigatorTarget);(a=b.dataset.graniteCollectionNavigatorCollectionid)?
(d(b).prevAll("betty-breadcrumbs-item").remove(),b=c.adaptTo("foundation-collection"),"load"in b||console&&console.warn("FoundationCollection#load is not implemented; do nothing."),b.load(a)):window.location=b.dataset.graniteCollectionNavigatorHref});d(function(){var a=f.head.querySelector(".granite-collection-pagetitle");if(a){var c=History.getState();a=a.dataset.graniteCollectionPagetitleTarget;var e=f.querySelector(a).dataset.foundationCollectionId;c.data.shellCollection={id:e,target:a};History.replaceState(c.data);
d(window).on("statechange",function(){var a=History.getState().data.shellCollection;if(a){var b=d(a.target);b[0]&&b[0].dataset.foundationCollectionId!==a.id&&b.adaptTo("foundation-collection").load(a.id)}})}});d(f).on("foundation-collection-navigate",".foundation-collection",function(b){var h=d(this);d(".granite-collection-navigator").each(function(){var a=d(this);h.is(this.dataset.graniteCollectionNavigatorTarget)&&(h.hasClass("foundation-layout-columnview")?e(a,h):c(a,h))});d(".granite-collection-pagetitle").each(function(){var b=
d(this);if(h.is(this.dataset.graniteCollectionPagetitleTarget)){var c=History.getState().data.shellCollection,e=h[0].dataset.foundationCollectionId;if(!c||c.id!==e){var m=b[0].dataset.graniteCollectionPagetitleSrc;m&&(c=b[0].dataset.graniteCollectionPagetitleBase,m=a.expand(m,{id:e}),History.pushState({shellCollection:{id:e,target:b[0].dataset.graniteCollectionPagetitleTarget}},c,m),b=d("meta[name\x3d'foundation.tracking.page']",f.head).attr("content"))&&(b=JSON.parse(b),b.assetId=e,d(window).adaptTo("foundation-tracker").trackPage(b))}}})})})(document,
Granite.$,Granite.URITemplate);
(function(f,d,a,e){a(f).on("coral-cyclebutton:change",".granite-collection-switcher",function(c){var b=this.dataset.graniteCollectionSwitcherTarget;if((c=c.originalEvent.detail.selection.dataset.graniteCollectionSwitcherSrc)&&b){var f=a(b),g="true"===f[0].dataset.foundationSelectionsSelectallMode,k=Array.prototype.map.call(f.find(".foundation-selections-item"),function(a){return a.dataset.foundationCollectionItemId});b={id:f[0].dataset.foundationCollectionId};var l=f.adaptTo("foundation-collection");
(l="getPagination"in l?l.getPagination():null)&&k.length&&(b.offset=0,b.limit=l.offset);c=e.expand(c,b);d.UI.Foundation.Layouts.cleanAll(f[0]);a.ajax({url:c,cache:!1}).then(function(b){a(window).adaptTo("foundation-util-htmlparser").parse(b).then(function(b){b=a(b).children();b.replaceAll(f);g&&(b[0].dataset.foundationSelectionsSelectallMode=!0);k.length&&b.data("foundation-layout-collection-switcher.internal.selectionIds",k);b.trigger("foundation-contentloaded");b.removeData("foundation-layout-collection-switcher.internal.selectionIds")})},
function(){var b=d.I18n.get("Error"),c=d.I18n.get("Fail to load data.");a(window).adaptTo("foundation-ui").alert(b,c,"error")})}})})(document,Granite,Granite.$,Granite.URITemplate);
(function(f,d){d(f).on("foundation-selections-change",".foundation-collection",function(){var a=d(this),e=0<a.adaptTo("foundation-selections").count();d(".granite-collection-create").filter(function(){return a.is(this.dataset.graniteCollectionCreateTarget)}).each(function(){e?this.classList.add("granite-collection-create-hidden"):this.classList.remove("granite-collection-create-hidden")})})})(document,Granite.$);
(function(f,d){d(f).on("foundation-collection-newpage",function(a){var e=d(a.target);a=e.adaptTo("foundation-collection");var c;a.getPagination&&(c=a.getPagination());d("granite-pagingstatus.granite-collection-pagingstatus").each(function(){var a=this.getAttribute("data-granite-collection-pagingstatus-target");a&&e.is(a)&&(c||(a=e.find(".foundation-collection-item").length,c={offset:a,guessTotal:a,hasNext:!1}),this.current=c.offset,this.guessTotal=c.guessTotal,this.hasNext=null===c.hasNext?1E3<c.guessTotal:
c.hasNext)})})})(document,Granite.$);
(function(f,d,a){a(d).on("coral-cyclebutton:change",".granite-toggleable-control",function(d){var c=a(this);d=d.originalEvent.detail.selection;var b=d.dataset.graniteToggleableControlAction;if("navigate"===b)f.location.href=d.dataset.graniteToggleableControlHref;else{var e=d.dataset.graniteToggleableControlTarget;if(e){var g=a(e).adaptTo("foundation-toggleable");(e=this.dataset.graniteToggleableControlSavekey)&&a.cookie(e,d.dataset.graniteToggleableControlName||"",{expires:7,path:"/"});requestAnimationFrame(function(){void 0===
b&&(b=g.isOpen()?"hide":"show");"show"===b?g.show(c[0]):"hide"===b&&g.hide()})}}})})(window,document,Granite.$);
(function(f,d,a,e){f=a(f).adaptTo("foundation-util-propertybuilder");a=Object.create(HTMLElement.prototype);a.createdCallback=function(){this._render();for(var a=this.attributes,b=0;b<a.length;b++)this.attributeChangedCallback(a[b].name,void 0,a[b].value)};a.attributeChangedCallback=function(a,b,d){switch(a){case "current":case "guesstotal":case "hasnext":this._render()}};Object.defineProperties(a,{current:(new f(f.createAttrBasedProperty("current"))).mix(f.integerType(-1)).build(),guessTotal:(new f(f.createAttrBasedProperty("guesstotal"))).mix(f.integerType(-1)).build(),
hasNext:f.createBooleanAttrBasedProperty("hasnext")});a._render=function(){var a=""+this.guessTotal;this.hasNext&&(a+="+");this.textContent=e.I18n.get("{0} of {1}",[this.current,a])};d.registerElement("granite-pagingstatus",{prototype:a})})(window,document,Granite.$,Granite);
(function(f,d,a,e){function c(b){var c=a(b),d=!0;c.find("a[is\x3d'coral-anchorlist-item']").each(function(){"none"!==a(this).css("display")&&(d=!1)});d&&!0===b.open&&(b.open=!1);c.prev().prop("hidden",d)}function b(a){(new MutationObserver(function(b){b.some(function(a){return a.target instanceof Coral.AnchorList.Item})&&c(a)})).observe(a,{attributes:!0,subtree:!0,attributeFilter:["hidden","class"]});c(a)}f=a(f);var h=f.adaptTo("foundation-util-keyboard");f.adaptTo("foundation-registry").register("foundation.adapters",
{type:"foundation-command",selector:".granite-pulldown-overlay [data-foundation-command]",adapter:function(b){var c=a(b),f=c.closest(".granite-pulldown-overlay").prev(),g;return{enhanceUI:function(){if(!b.dataset.foundationCommandLabel){var a=b.textContent.trim();b.dataset.foundationCommandLabel=a}g||(a=h.normalize(this.getShortcut()),g=d.createElement("span"),g.classList.add("granite-command-alignRight"),g.textContent=a,b.content?b.content.insertBefore(g,b.content.firstChild):b.insertBefore(g,b.firstChild))},
execute:function(){c.click()},getLabel:function(){var a=b.dataset.foundationCommandLabel||b.textContent.trim();return e.I18n.get("{0} {1}",[f.text().trim(),a])},getShortcut:function(){return b.dataset.foundationCommand},isActive:function(){return f.is(":visible")&&!c.prop("hidden")&&!c.hasClass("foundation-collection-action-hidden")}}}});var g=new WeakMap;a(d).on("foundation-contentloaded",function(c){a(".granite-pulldown-overlay",c.target).each(function(){g.has(this)||(b(this),g.set(this,!0))})})})(window,
document,Granite.$,Granite);
(function(f,d,a){f=a(f);var e=f.adaptTo("foundation-util-keyboard");f.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:".granite-ActionGroup-item[data-foundation-command]",adapter:function(c){var b=a(c),f=b.closest(".granite-ActionGroup"),g;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var a=c.textContent.trim();c.dataset.foundationCommandLabel=a}g||(a=e.normalize(this.getShortcut()),g=d.createElement("span"),g.classList.add("granite-command-alignRight"),
g.textContent=a,c.content?c.content.insertBefore(g,c.content.firstChild):c.insertBefore(g,c.firstChild))},execute:function(){b.click()},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return f.is(":visible")&&!b.prop("hidden")&&!b.prop("disabled")}}}});a(d).on("click",".granite-ActionGroup-item",function(c){a(c.target).closest("coral-popover").hide()})})(window,document,Granite.$);
(function(f,d,a,e){var c=e.UI.Foundation.Utils.everyReverse,b=a(f).adaptTo("foundation-registry");a(d).on("click",".granite-form-saveactivator",function(b){b=this.dataset.graniteFormSaveactivatorHref;var c=a("#"+this.getAttribute("form"));c.addClass("granite-form-saveactivator-form");b?c.attr("data-granite-form-saveactivator-form-redirect",b):c.removeAttr("data-granite-form-saveactivator-form-redirect")});a(d).on("foundation-form-submitted",".granite-form-saveactivator-form",function(d,g,k){if(g){var h=
a(this),m=h.data("foundationFormResponseUiSuccess")||h.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");m||((d=this.dataset.graniteFormSaveactivatorFormRedirect)?(m={name:"foundation.redirect",href:d},a(f).adaptTo("foundation-util-messenger").put(null,e.I18n.get("The form has been submitted successfully"),"success")):m={name:"foundation.reload"},c(b.get("foundation.form.response.ui.success"),function(a){return a.name!==m.name?!0:!1===a.handler.call(h[0],h[0],
m)}))}})})(window,document,Granite.$,Granite);
(function(f,d,a){function e(b,c){(b=b[0].dataset.granitePickerdialogCollection)&&(b=a(b).adaptTo("foundation-selections"))&&b.clear();return{clean:function(){},replace:function(a){}}}function c(a,b){var c=b.filter("#granite-pickerdialog-search-result-titlebar-center"),d=b.filter("#granite-pickerdialog-search-result-titlebar-right"),e=a.find(".granite-pickerdialog-titlebar"),f=e.children("betty-titlebar-title"),g=e.children("betty-titlebar-secondary");c.length&&(f.prop("hidden",!0).after(c),g.prop("hidden",
!0).after(d));e.trigger("foundation-contentloaded");return{clean:function(){f.prop("hidden",!1);c.remove();g.prop("hidden",!1);d.remove()},replace:function(a){c=a.filter("#granite-pickerdialog-search-result-titlebar-center").replaceAll(c);d=a.filter("#granite-pickerdialog-search-result-titlebar-right").replaceAll(d);e.trigger("foundation-contentloaded")}}}function b(a,b){var c=b.filter("#granite-pickerdialog-search-result-content"),d=a.find(".granite-pickerdialog-content .foundation-layout-panel-content");
d.prop("hidden",!0);c.insertAfter(d).trigger("foundation-contentloaded");return{clean:function(){c.remove();d.prop("hidden",!1)},replace:function(a){c=a.filter("#granite-pickerdialog-search-result-content").replaceAll(c).trigger("foundation-contentloaded")}}}function h(a,b){var c=a.find(".granite-pickerdialog-searchfield"),d=c.children("[foundation-autocomplete-button]"),e=d.prop("icon");b=Granite.I18n.get("Close Search");d.prop("tabIndex",0);d.prop("icon","closeCircle");d.attr("title",b);d.attr("aria-label",
b);d.removeAttr("role");var f=function(b){b.preventDefault();this.blur();g(a)};d.on("click",f);return{clean:function(){var a=c.adaptTo("foundation-field");a&&a.setValue("");d.prop("tabIndex",-1);d.prop("icon",e);d.removeAttr("title");d.removeAttr("aria-label");d.attr("role","presentation");d.off("click",f)},replace:function(a){}}}function g(a){a=a[0];var b=k.get(a);b&&Granite.UI.Foundation.Utils.everyReverse(b,function(a){a.clean();return!0});k.delete(a)}var k=new WeakMap;a(f).adaptTo("foundation-registry").register("foundation.form.response.ui.success",
{name:"granite.pickerdialog.search.result",handler:function(d,g,p,n,x,v){a(f).adaptTo("foundation-util-htmlparser").parse(v).then(function(f){var g=a(f).children();f=a(d).closest(".granite-pickerdialog");var l=f[0],m=k.get(l);m?m.forEach(function(a){a.replace(g)}):(m=[],m.push(e(f,g)),m.push(c(f,g)),m.push(b(f,g)),m.push(h(f,g)),k.set(l,m))})}});a(d).on("click",".granite-pickerdialog-search-close",function(b){b.preventDefault();b=a(this).closest(".granite-pickerdialog");g(b)})})(window,document,Granite.$);
(function(f,d){function a(a){return function(b){return a?a.replace("{{count}}",b.count+(0<b.count&&b.hasNext?"+":"")):""}}function e(a){var b={count:a.adaptTo("foundation-selections").count(),hasNext:!1};if("true"!==a[0].dataset.foundationSelectionsSelectallMode)return b;if(a=a.adaptTo("foundation-collection").getPagination())b.hasNext=null===a.hasNext?1E3<a.guessTotal:a.hasNext;return b}d(f).on("foundation-selections-change",".foundation-collection",function(){var c=d(this);d(".foundation-admin-selectionstatus").filter(function(){return c.is(this.dataset.foundationAdminSelectionstatusTarget)}).each(function(){var b=
d(this),f=a(b[0].dataset.foundationAdminSelectionstatusTemplate);b.html(f(e(c)))})})})(document,Granite.$);(function(f,d,a){a(d).on("foundation-form-submitted","#granite-user-preferences",function(e,c){c&&(e=a(this).serializeArray(),a(f).adaptTo("foundation-preference").setAll(e.reduce(function(a,c){a.set(c.name,c.value);return a},new Map)),a(d).trigger(a.Event("user-preferences-changed",{userPreferences:e})),setTimeout(function(){f.location.reload()},100))})})(window,document,Granite.$);
(function(f,d,a){f.chrome&&/Google/.test(a.vendor)&&!/OPR|Edge/.test(a.userAgent)&&f.addEventListener("unload",function(){d.documentElement.innerHTML=""})})(window,document,navigator);