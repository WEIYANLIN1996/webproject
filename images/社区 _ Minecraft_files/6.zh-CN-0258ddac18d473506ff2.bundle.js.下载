(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1698:function(e,t,s){"use strict";s.d(t,"a",function(){return r});const r=(e,t)=>Intl.NumberFormat(navigator.language,t).format(e)},1785:function(e,t,s){"use strict";s.d(t,"a",function(){return a});var r=s(5),n=s(52),o=s(54);const a=(e,t)=>{return Object(n.connect)(void 0,e=>({listen:(s,r)=>{e(Object(o.c)({userId:r,channelId:s,realtime:t.realtime}))},unlisten:(s,r)=>{e(Object(o.d)({userId:r,channelId:s,realtime:t.realtime}))}}))(class extends r.PureComponent{componentDidMount(){this.props.userId&&this.props.listen(this.props.channelId,this.props.userId)}componentDidUpdate(e){this.props.userId===e.userId&&this.props.channelId===e.channelId||(e.userId&&this.props.unlisten(e.channelId,e.userId),this.props.userId&&this.props.listen(this.props.channelId,this.props.userId))}componentWillUnmount(){this.props.userId&&this.props.unlisten(this.props.channelId,this.props.userId)}render(){return r.createElement(e,this.props)}})}},1873:function(e,t,s){e.exports={badge:"badge_3LFXw"}},1874:function(e,t,s){e.exports={header:"header_3_-sm",bg:"bg_XlG-z",badge:"badge_13TwR",content:"content_2uzO_",tvHeader:"tvHeader_1nVHu"}},1875:function(e,t,s){e.exports={badge:"badge_3nSBh",dramatic:"dramatic_xrelD",rays:"rays_lfVLe",ray:"ray_YwviB","level-entrance":"level-entrance_3w85u"}},1876:function(e,t,s){e.exports={text:"text_1dQeX",xp:"xp_zXzzg",rank:"rank_C68PN",progress:"progress_3LBiV"}},1877:function(e,t,s){e.exports={title:"title_Wp5DV",item:"item_2RESZ",icon:"icon_1ET3C",value:"value_JC3uD"}},1878:function(e,t,s){e.exports={host:"host_1ECkN",tvWrapper:"tvWrapper_5UpLV"}},1879:function(e,t,s){e.exports={tooltip:"tooltip_ScPgY",content:"content_1OTgc"}},1880:function(e,t,s){e.exports={exclamation:"exclamation_1RJbC"}},1881:function(e,t,s){e.exports={loader:"loader_2Ldsu",spin:"spin_1ZdbO"}},1882:function(e,t,s){e.exports={badge:"badge_3_X9a",pulse:"pulse_QFHv9",wrapper:"wrapper_2hlPN",to:"to_1HQo1",particle:"particle_3H7Kf",animated:"animated_2Xc-d",from:"from_aByMA",burstOut:"burstOut_14p9j",burstIn:"burstIn_2A5Yp",static:"static_2HTQY",staticBoop:"staticBoop_2vaT7",glow:"glow_3Zjac"}},1883:function(e,t,s){e.exports={bubble:"bubble_2vHIy",flyup:"flyup_GuJm_",icon:"icon_2jv4i",backdrop:"backdrop_sQL1N",flash:"flash_3U0pb"}},1884:function(e,t,s){e.exports={badge:"badge_3QuKt"}},2032:function(e,t,s){"use strict";s.d(t,"a",function(){return u});var r=s(29),n=s(5),o=s(52),a=s(54),i=s(131),c=s(1873),p=s(1785);class l extends n.PureComponent{componentDidMount(){Object(r.b)(this.props.levels)&&this.throttleAttempt()}render(){const{levels:e,size:t=12}=this.props,s=2===e.state&&e.value.levels.find(e=>e.level===this.props.level);if(!s)return null;const r=Math.round(.8*t);let o=`url(${Object(i.g)(s.assetsUrl)}) 4px / ${r}px no-repeat,`;return s.gradient?o+=`linear-gradient(to right, ${s.color}, ${s.complement})`:o+=s.color,n.createElement("span",{className:c.badge,style:{fontSize:t,paddingLeft:t+6,background:o}},s.level)}throttleAttempt(){l.didAttempt||(l.didAttempt=!0,this.props.getLevels(this.props.channelId),setTimeout(()=>{l.didAttempt=!1}))}}l.didAttempt=!1;const h=Object(o.connect)((e,t)=>({levels:Object(i.j)(t.channelId)(e)}),e=>({getLevels:t=>{e(a.f.request({channelId:t}))}}))(l),u=Object(p.a)(h,{realtime:!1})},2082:function(e,t,s){"use strict";var r=s(5),n=s(52),o=s(131),a=s(154),i=s(392),c=s(1785),p=s(41),l=s(1879);class h extends r.PureComponent{constructor(){super(...arguments),this.close=e=>{e.preventDefault(),this.props.close()}}render(){return r.createElement("div",{className:l.tooltip},r.createElement("div",{className:l.content,role:"tooltip"},r.createElement("span",{style:{flex:1}},"在 " + this.props.channelName + " 的频道中升级! "),r.createElement(p.BuiBtn,{icon:!0,onClick:this.close,"aria-label":"取消"},r.createElement(p.BuiIcon,{icon:"Close"}))))}}var u=s(1884),d=s(1698),m=s(1883);const b=1500;class g extends r.PureComponent{componentDidMount(){this.completeTimeout=setTimeout(()=>this.props.onComplete(this.props.id),b)}componentWillUnmount(){clearTimeout(this.completeTimeout)}render(){const{color:e,complement:t}=this.props.level;return r.createElement("div",{className:m.bubble,style:{left:`${50+this.props.offsetLeft}%`,bottom:`${100-this.props.offsetTop}%`}},r.createElement("span",{"aria-label":"您获得了 " + this.props.amount + " 体验! "},"+",r.createElement(p.BuiIcon,{hostClass:m.icon,set:"mixer",icon:"MixerHeartSolid"}),Object(d.a)(this.props.amount),r.createElement("div",{className:m.backdrop,style:{background:`linear-gradient(${e}, ${t})`}})))}}var v=s(1882);const E=8;class f extends r.PureComponent{constructor(e){super(e),this.state={started:!1},this.particles=[];const t=360/E;for(let e=0;e<E;e++)this.particles.push(r.createElement("div",{key:e,className:v.particle,style:{transform:`rotate(${e*t}deg) translateX(${.6*this.props.size}px)`}}))}componentDidMount(){this.timeout=setTimeout(()=>{this.setState({started:!0}),this.timeout=setTimeout(this.props.onComplete,1e3)},500)}componentWillUnmount(){clearTimeout(this.timeout)}render(){const{color:e,complement:t}=this.state.started?this.props.to:this.props.from;return r.createElement("div",{style:{color:e},className:Object(p.classes)([this.state.started&&v.animated,v.wrapper])},r.createElement("div",{className:v.pulse,style:{background:`linear-gradient(-45deg, ${e}, ${t})`}}),this.particles,this.props.to.level!==this.props.from.level?r.createElement(r.Fragment,null,r.createElement("div",{className:Object(p.classes)([v.badge,v.to])},this.props.toBadge()),r.createElement("div",{className:Object(p.classes)([v.badge,v.from])},this.props.fromBadge())):r.createElement("div",{className:Object(p.classes)([v.badge,v.static])},this.props.toBadge()))}}class C extends r.PureComponent{render(){const{size:e,color:t,lineWidth:s,progress:n,hostClass:o}=this.props,a=e*Math.PI,i=this.props.size/2,c=1===n?0:(1-.95*n)*a;return r.createElement("svg",{width:e,height:e,viewBox:`0 0 ${e} ${e}`,style:{transform:"rotate(-90deg)",display:"block"},className:o},r.createElement("circle",{cx:i,cy:i,r:i-s/2,fill:"none",stroke:t,strokeWidth:s,style:{strokeDasharray:a,strokeDashoffset:c,transition:"500ms"}}))}}const x=.75;class _ extends r.PureComponent{constructor(e){super(e),this.xpEarningIdCounter=0,this.renderTransitionFromBadge=()=>this.renderBadge(this.state.current.assetsUrl),this.renderTransitionToBadge=()=>this.renderBadge(this.state.transitionTo.assetsUrl),this.clearBubble=e=>{this.setState({earnings:this.state.earnings.filter(t=>t.id!==e)})},this.finishTransition=()=>{this.setState({current:this.props.progression,transitionTo:void 0,progress:Object(o.i)(this.props.progression)})},this.state={progress:Object(o.i)(this.props.progression),current:this.props.progression,earnings:[]}}componentDidUpdate(e){if(!this.state.transitionTo&&(this.props.progression===this.state.current||this.state.transitionTo||this.updateStateLevelAndProgress(),e.progression.currentXp<this.props.progression.currentXp)){const t=this.state.earnings.length,s={amount:this.props.progression.currentXp-e.progression.currentXp,id:this.xpEarningIdCounter++,pushX:t*(Math.random()-.5)*10,pushY:t*Math.random()*10};this.setState({earnings:this.state.earnings.concat(s)})}}render(){return r.createElement(r.Fragment,null,r.createElement(C,{progress:this.state.progress,lineWidth:2,size:this.props.size,color:this.state.current.color}),this.state.transitionTo?r.createElement(f,{size:this.props.size,from:this.state.current,to:this.state.transitionTo,fromBadge:this.renderTransitionFromBadge,toBadge:this.renderTransitionToBadge,onComplete:this.finishTransition}):this.renderBadge(this.state.current.assetsUrl),this.state.earnings.map(e=>r.createElement(g,{level:this.state.current,key:e.id,amount:e.amount,id:e.id,offsetLeft:e.pushX,offsetTop:e.pushY,onComplete:this.clearBubble})))}renderBadge(e){let t=Math.floor(this.props.size*x);t%2==1&&t++;const s=this.props.size/2;return r.createElement("img",{className:u.badge,src:Object(o.k)(e),style:{width:t,top:s+t/-2,left:s+t/-2}})}updateStateLevelAndProgress(){const e=Object(o.i)(this.props.progression),t=this.state.current.level,s=this.props.progression.level;s!==t?this.setState({transitionTo:this.props.progression,progress:s>t?1:0}):this.state.progress!==e&&this.setState({progress:e})}}var N=s(1880);class O extends r.PureComponent{render(){return r.createElement(r.Fragment,null,r.createElement(C,{progress:1,lineWidth:2,size:this.props.size,color:"#f00"}),r.createElement("span",{className:N.exclamation},"!"))}}var I=s(1878),S=s(1881);class w extends r.PureComponent{render(){return r.createElement("div",{className:S.loader,style:{fontSize:this.props.size}})}}s.d(t,"a",function(){return T});const T=Object(n.connect)((e,{channelId:t})=>({progression:Object(o.e)(t)(e),tooltip:Object(i.b)(e)}),e=>({closeTooltip(){e(Object(a.a)())}}))(Object(c.a)(class extends r.PureComponent{constructor(){super(...arguments),this.onClick=e=>{!e.defaultPrevented&&this.props.onClick&&(this.props.onClick(),this.props.tooltip&&this.props.closeTooltip())},this.onKeyDown=e=>{"Enter"===e.key&&this.onClick(e)}}componentDidMount(){2===this.props.progression.state&&this.props.onExperienceChange&&this.props.onExperienceChange(this.props.progression.value.currentXp)}componentDidUpdate(e){2===e.progression.state&&2===this.props.progression.state&&this.props.onExperienceChange&&e.progression.value.currentXp!==this.props.progression.value.currentXp&&this.props.onExperienceChange(this.props.progression.value.currentXp)}render(){const e=2===this.props.progression.state;return r.createElement("div",{className:I.host,onKeyDown:this.onKeyDown,onClick:this.onClick,role:"button",tabIndex:e?0:-1,"aria-hidden":!e,"aria-label":2===this.props.progression.state?"您的排名为 " + this.props.progression.value.level + ", 按 Enter 可了解详细信息 ":void 0},this.props.tooltip&&r.createElement(h,{channelName:this.props.tooltip.channelName,close:this.props.closeTooltip}),this.getContents())}getContents(){return 3===this.props.progression.state?r.createElement(O,{size:this.props.size}):2!==this.props.progression.state?r.createElement(w,{size:this.props.size}):r.createElement(_,{progression:this.props.progression.value,size:this.props.size})}},{realtime:!0}))},2084:function(e,t,s){"use strict";var r=s(29),n=s(5),o=s(52),a=s(54),i=s(131),c=s(154),p=s(392),l=s(1785),h=s(41),u=s(1875);const d=(e,t)=>{const s=[],r=360/e;for(let o=0;o<e;o++)s.push(n.createElement("div",{key:o,className:u.ray,style:{height:.1*t+Math.random(),width:.8*t+Math.random()*t*.2,transform:`perspective(100px) rotateZ(${r*o}deg) rotateY(-60deg)`,animationDelay:`-${Math.random()}s`}}));return s};class m extends n.PureComponent{constructor(){super(...arguments),this.rays=d(15,this.props.haloSize||this.props.size)}render(){return n.createElement("div",{className:Object(h.classes)([u.badge,this.props.hostClass,this.props.dramatic&&u.dramatic]),style:{color:this.props.level.color}},n.createElement("div",{className:u.rays},this.rays),n.createElement("img",{src:Object(i.h)(this.props.level.assetsUrl),role:"presentation",style:{width:this.props.size}}))}}var b=s(1698),g=s(1876);class v extends n.PureComponent{render(){const e="排名为 " + this.props.current.level + "， " + this.props.current.currentXp + " ，共 " + this.props.current.nextLevelXp + " 个红心。 ";return n.createElement("div",{"aria-label":e},n.createElement("div",{className:g.text},n.createElement("span",{className:g.rank},"排名为 " + this.props.current.level + "",":"),n.createElement("span",{className:g.xp},n.createElement(h.BuiIcon,{set:"mixer",icon:"MixerHeartSolid"})," ",this.renderXpText())),n.createElement(h.ProgressBar,{progress:Object(i.i)(this.props.current),foreground:this.props.current.color,background:"#171E2A",height:6,className:g.progress}))}renderXpText(){const{next:e,current:t}=this.props;return e?`${Object(b.a)(t.currentXp-t.minXp)} / ${Object(b.a)(e.minXp-t.minXp)}`:`${Object(b.a)(t.currentXp)} / ∞`}}var E=s(1874);class f extends n.PureComponent{render(){const e=this.props.levels.find(e=>e.level===this.props.userLevel.level+1),t=2===this.props.channel.state&&this.props.channel.value.name;return n.createElement("div",{className:Object(h.classes)({[E.header]:!0,[E.tvHeader]:!!this.props.isTv})},n.createElement("h1",null,"获得红心以升级",n.createElement("small",null,t&&"在 " + t + " 的频道中 ")),n.createElement(m,{hostClass:E.badge,size:120,haloSize:100,level:this.props.userLevel}),n.createElement(v,{current:this.props.userLevel,next:e}),n.createElement("div",{className:E.bg,style:{background:`linear-gradient(${this.props.userLevel.color}, ${this.props.userLevel.complement})`}}))}}var C=s(1877);const x=e=>n.createElement("div",{className:C.item},n.createElement(h.BuiIcon,{set:"mixer",icon:e.icon,hostClass:C.icon}),n.createElement("div",null,n.createElement("h3",null,e.title),n.createElement("p",null,e.description)),n.createElement("span",{className:C.value},n.createElement(h.BuiIcon,{set:"mixer",icon:"MixerHeartSolid","aria-label":"红心值"})," ",Object(b.a)(e.value))),_=e=>!(!e||!e.weight),N=e=>Math.round(1/e*10);class O extends n.PureComponent{render(){return n.createElement(n.Fragment,null,n.createElement("h2",{className:C.title},"如何升级"),I(this.props.weights,this.props.channelName))}}const I=(e,t)=>n.createElement(n.Fragment,null,_(e.watch)&&n.createElement(x,{title:"观看",description:"每观看 " + t + " 五分钟便可获得红心 ",icon:e.watch.icon,value:e.watch.weight}),_(e.chat)&&n.createElement(x,{title:"聊天",description:"在 " + t + " 的频道中聊天时获得红心 ",icon:e.chat.icon,value:e.chat.weight}),_(e.applause)&&n.createElement(x,{title:"鼓掌",description:"在 " + t + " 的频道上收到鼓掌时获得红心 ",icon:e.applause.icon,value:e.applause.weight}),_(e.follow)&&n.createElement(x,{title:"关注",description:"关注 " + t + " 时获得红心 ",icon:e.follow.icon,value:e.follow.weight}),_(e.subscribe)&&n.createElement(x,{title:"订阅",description:"订阅 " + t + " 时获得红心 ",icon:e.subscribe.icon,value:e.subscribe.weight}),_(e.sendSubGift)&&n.createElement(x,{title:"礼品订阅",description:"当您为其他观看者订阅礼品时赚取心形",icon:e.sendSubGift.icon,value:e.sendSubGift.weight}),_(e.spark)&&n.createElement(x,{title:"火花",description:`Support broadcasters and earn 10 Hearts for every ${N(e.spark.weight)} Sparks spent`,icon:e.spark.icon,value:10}),_(e.ember)&&n.createElement(x,{title:"Ember",description:"支持广播者，每使用一个 Ember 都可以获得红心",icon:e.ember.icon,value:e.ember.weight}));s.d(t,"a",function(){return S});const S=Object(o.connect)((e,{channelId:t})=>({userLevel:Object(i.e)(t)(e),levels:Object(i.j)(t)(e),channelData:Object(p.a)(t)(e)}),e=>({opened(t){e(Object(c.b)({level:t}))},getChannelData(t){e(c.c.request({channelId:t}))},loadLevels(t){e(a.f.request({channelId:t}))}}))(Object(l.a)(class extends n.PureComponent{componentDidMount(){this.loadDataAndLevelsIfNecessary(),this.sendOpenData()}componentDidUpdate(e){e.channelId!==this.props.channelId?(this.loadDataAndLevelsIfNecessary(),this.sendOpenData()):this.props.userLevel.state!==e.userLevel.state&&this.sendOpenData()}render(){if(2!==this.props.levels.state||2!==this.props.userLevel.state)return null;const e=2===this.props.channelData.state?this.props.channelData.value:void 0;return n.createElement(n.Fragment,null,n.createElement(f,{levels:this.props.levels.value.levels,userLevel:this.props.userLevel.value,channel:this.props.channelData,isTv:!1}),e&&n.createElement(O,{weights:this.props.levels.value.weights,channelName:e.name,isPartner:e.partner}))}loadDataAndLevelsIfNecessary(){Object(r.b)(this.props.levels)&&this.props.loadLevels(this.props.channelId),Object(r.b)(this.props.channelData)&&this.props.getChannelData(this.props.channelId)}sendOpenData(){2===this.props.userLevel.state&&this.props.opened(this.props.userLevel.value.level)}},{realtime:!0}))},2085:function(e,t,s){"use strict";s(1);var r=s(716),n=s(3),o=function(e){return e.chat},a=s(73);var i,c=Object(a.createSelectorCreator)(a.defaultMemoize,function(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0});Object(n.createStandardAction)("@chat/INIT_CHAT")(),Object(n.createStandardAction)("@chat/DESTROY_CHAT")(),Object(n.createAction)("@chat/CHAT_INITIALIZED"),Object(n.createAction)("@chat/CHAT_SWITCH_MODE",function(e){return function(t){return e(t)}}),Object(n.createAsyncAction)("@chat/FETCH_CHANNEL_REQUEST","@chat/FETCH_CHANNEL_SUCCESS","@chat/FETCH_CHANNEL_FAILURE")(),Object(n.createStandardAction)("@chat/SET_IS_LOAD_SHED")(),Object(n.createStandardAction)("@chat/CHAT_SET_ROLES")(),Object(n.createStandardAction)("@chat/CHAT_USER_ROLE_UPDATED")(),Object(n.createStandardAction)("@chat/SIGN_UP_TRAP")();s.d(t,"a",function(){return i}),function(e){e[e.Live=0]="Live",e[e.Replay=1]="Replay"}(i||(i={}));i.Live;var p=function(e){return o(e).current},l=[],h=function(e){return p(e).roles||l};c(h,function(e){return new Set(e.length>0?r.a.getPermissions(e):[])})}}]);
//# sourceMappingURL=6.zh-CN-0258ddac18d473506ff2.bundle.js.map